<!DOCTYPE html>
<!-- Generated by claude-code-log v0.8.0 -->
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>claude-factory: Senior-Level Clean Code &amp; Design Patterns Skill</title>
    
    <style>
/* Global styles shared across all templates */

/* CSS Variables for shared colors and consistent theming */
:root {
    /* Base colors */
    --code-bg-color: #f5f1e8;
    --tool-param-sep-color: #4b494822;

    /* Dimmed/transparent variants (66 = ~40% opacity) */
    --white-dimmed: #ffffff66;
    --highlight-dimmed: #e3f2fd66;
    --assistant-dimmed: #9c27b066;
    --info-dimmed: #2196f366;
    --warning-dimmed: #d9810066;
    --success-dimmed: #4caf5066;
    --error-dimmed: #f4433666;
    --neutral-dimmed: #f8f9fa66;
    --tool-input-dimmed: #fff3cd66;
    --thinking-dimmed: #f0f0f066;
    --tool-result-dimmed: #e8f5e866;
    --session-bg-dimmed: #e8f4fd66;
    --ide-notification-dimmed: #d2d6d966;

    /* Fully transparent variants (88 = ~53% opacity) */
    --highlight-semi: #e3f2fd88;
    --error-semi: #ffebee88;
    --neutral-semi: #f8f9fa88;

    /* Slightly transparent variants (55 = ~33% opacity) */
    --highlight-light: #e3f2fd55;

    /* Solid colors for text and accents */
    --text-muted: #666;
    --text-secondary: #495057;

    /* Font families */
    --font-monospace: 'Fira Code', 'Monaco', 'Consolas', 'SF Mono', 'Inconsolata', 'Droid Sans Mono', 'Source Code Pro', 'Ubuntu Mono', 'Cascadia Code', 'Menlo', monospace;
    --font-ui: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
}

body {
    font-family: var(--font-monospace);
    line-height: 1.5;
    max-width: 1200px;
    margin: 0 auto;
    padding: 10px;
    background: linear-gradient(90deg, #f3d6d2, #f1dcce, #f0e4ca, #eeecc7, #e3ecc3, #d5eac0, #c6e8bd, #b9e6bc, #b6e3c5, #b3e1cf);
    color: #333;
}

h1 {
    text-align: center;
    color: #2c3e50;
    margin-bottom: 20px;
    font-size: 1.8em;
}

/* Common typography */

code {
    background-color: var(--code-bg-color);
    padding: 2px 4px;
    border-radius: 3px;
    font-family: var(--font-monospace);
    line-height: 1.5;
}


pre {
    background-color: #12121212;
    padding: 10px;
    border-radius: 5px;
    white-space: pre-wrap;
    word-wrap: break-word;
    word-break: break-word;
    font-family: var(--font-monospace);
    line-height: 1.5;
}

/* Common card styling */
.card-base {
    background-color: #ffffff66;
    border-radius: 8px;
    padding: 16px;
    box-shadow: -7px -7px 10px #eeeeee44, 7px 7px 10px #00000011;
    border-left: #ffffff66 1px solid;
    border-top: #ffffff66 1px solid;
    border-bottom: #00000017 1px solid;
    border-right: #00000017 1px solid;
}

.card-base:hover {
    box-shadow: -10px -10px 15px #eeeeee66, 10px 10px 15px #00000022;
    transform: translateY(-1px);
    transition: all 0.2s ease;
}

/* Common header styling */
.header {
    font-weight: 600;
    margin-bottom: 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 8px;
}

.header > span:first-child {
    flex: 1;
    min-width: 0;
    overflow: hidden;
}

/* Tool summary in header */
.tool-summary {
    font-weight: normal;
    color: var(--text-muted);
    font-size: 0.95em;
    word-break: break-all;
    overflow-wrap: anywhere;
    display: inline;
}

/* Timestamps */
.timestamp {
    font-size: 0.85em;
    color: #666;
    font-weight: normal;
}

/* Floating action buttons */
.floating-btn {
    position: fixed;
    right: 20px;
    background-color: #e8f4fd66;
    color: #666;
    border: none;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    font-size: 1.2em;
    line-height: 1;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
    transition: background-color 0.3s, transform 0.2s;
    z-index: 1000;
    text-decoration: none;
}

.floating-btn:hover {
    background-color: #e8f4fdcc;
    transform: translateY(-2px);
}

.floating-btn:visited {
    color: #666;
}

/* Floating buttons positioning */
.scroll-top.floating-btn {
    bottom: 20px;
}

.toggle-details.floating-btn {
    bottom: 80px;
}

.filter-messages.floating-btn {
    bottom: 140px;
}

.timeline-toggle.floating-btn {
    bottom: 200px;
}
/* Message and content styles */
.message {
    margin-bottom: 1em;
    margin-left: 1em;
    padding: 1em;
    border-radius: 8px;
    border-left: var(--white-dimmed) 2px solid;
    background-color: var(--highlight-light);
    box-shadow: -7px -7px 10px #eeeeee44, 7px 7px 10px #00000011;
    border-top: var(--white-dimmed) 1px solid;
    border-bottom: #00000017 1px solid;
    border-right: #00000017 1px solid;
}

/* Message header info styling */
.header-info {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 2px;
}

.timestamp-row {
    display: flex;
    flex-direction: row;
    align-items: normal;
    gap: 8px;
}

.pair-duration {
    font-size: 80%;
    color: #666;
    font-style: italic;
}

.token-usage {
    font-size: 0.75em;
    color: #888;
}

/* Paired message styling */
.message.paired-message {
    margin-bottom: 0;
}

.message.paired-message.pair_first {
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    border-bottom: none;
}

.message.paired-message.pair_last {
    margin-top: 0;
    margin-bottom: 1em;
    border-top-left-radius: 0;
    border-top-right-radius: 0;
    border-top: 1px solid #00000011;
}

.message.paired-message.pair_middle {
    margin-top: 0;
    border-radius: 0;
    border-top: 1px solid #00000011;
    border-bottom: none;
}

.session-divider {
    margin: 70px 0;
    border-top: 2px solid #fff;
}

/* Message type styling */
.user {
    border-left-color: #ff9800;
    margin-left: 0;
}

.assistant {
    border-left-color: #9c27b0;
}

/* Dimmed assistant when paired with thinking */
.assistant.paired-message {
    border-left-color: var(--assistant-dimmed);
}

.system {
    border-left-color: #d98100;
    margin-left: 0;
}

.system-warning {
    border-left-color: #2196f3;
    background-color: var(--highlight-semi);
    margin-left: 2em; /* Extra indent - assistant-initiated */
}

.system-error {
    border-left-color: #f44336;
    background-color: var(--error-semi);
    margin-left: 0;
}

.system-info {
    border-left-color: var(--info-dimmed);
    background-color: var(--highlight-dimmed);
    margin-left: 2em; /* Extra indent - assistant-initiated */
    font-size: 80%;
}

/* Command output styling */
.command-output {
    background-color: #1e1e1e11;
    border-left-color: var(--warning-dimmed);
}

.command-output-content {
    background-color: #1e1e1e08;
    padding: 12px;
    border-radius: 4px;
    border: 1px solid #00000011;
    margin-top: 8px;
    font-family: var(--font-monospace);
    font-size: 0.9em;
    line-height: 1.4;
    white-space: pre-wrap;
    word-wrap: break-word;
    color: #333;
    overflow-x: auto;
}

/* Bash command styling */
.bash-input {
    background-color: #1e1e1e08;
    border-left-color: #4caf50;
}

.bash-prompt {
    color: #4caf50;
    font-weight: bold;
    font-size: 1.1em;
    margin-right: 8px;
}

.bash-command {
    font-family: var(--font-monospace);
    font-size: 0.95em;
    color: #2c3e50;
    background-color: #f8f9fa;
    padding: 2px 6px;
    border-radius: 3px;
}

/* Bash output styling */
.bash-output {
    background-color: var(--neutral-dimmed);
    border-left-color: #607d8b;
}

.bash-stdout {
    background-color: #1e1e1e05;
    padding: 12px;
    border-radius: 4px;
    border: 1px solid #00000011;
    margin: 8px 0;
    font-family: var(--font-monospace);
    font-size: 0.9em;
    line-height: 1.4;
    white-space: pre-wrap;
    word-wrap: break-word;
    color: #333;
    overflow-x: auto;
}

.bash-stderr {
    background-color: #ffebee;
    padding: 12px;
    border-radius: 4px;
    border: 1px solid #ffcdd2;
    margin: 8px 0;
    font-family: var(--font-monospace);
    font-size: 0.9em;
    line-height: 1.4;
    white-space: pre-wrap;
    word-wrap: break-word;
    color: #c62828;
    overflow-x: auto;
}

.bash-empty {
    color: #999;
    font-style: italic;
}

/* Bash tool content styling (Tool Use message) */
.bash-tool-content {
    margin: 8px 0;
}

.bash-tool-description {
    color: var(--text-muted);
    font-size: 0.95em;
    margin-bottom: 8px;
    line-height: 1.4;
}

.content pre.bash-tool-command {
    background-color: var(--code-bg-color);
    padding: 8px 12px;
    border-radius: 4px;
    border: 1px solid var(--tool-param-sep-color);
    font-family: var(--font-monospace);
    font-size: 0.9em;
    color: #2c3e50;
    margin: 0;
    overflow-x: auto;
}

.tool_use {
    border-left-color: #4caf50;
    margin-left: 2em; /* Extra indent - assistant-initiated */
}

.tool_result {
    border-left-color: var(--success-dimmed);
    margin-left: 2em; /* Extra indent - assistant-initiated */
}

.tool_result.error {
    border-left-color: var(--error-dimmed);
    background-color: var(--error-semi);
}

.message.tool_use pre, .message.tool_result pre {
    font-size: 80%;
}

/* Sidechain message styling */
.sidechain {
    opacity: 0.85;
    background-color: var(--neutral-semi);
    border-left-width: 2px;
    border-left-style: dashed;
}

/* Sidechain indentation hierarchy */
.sidechain.user {
    margin-left: 3em; /* Sub-assistant Prompt - nested below Task tool use (2em) */
}

.sidechain.assistant {
    margin-left: 4em; /* Sub-assistant - nested below prompt (3em) */
}

.sidechain.tool_use,
.sidechain.tool_result {
    margin-left: 5em; /* Sub-assistant tools - nested below assistant (4em) */
}

.sidechain .sidechain-indicator {
    color: var(--text-muted);
    font-size: 0.9em;
    margin-bottom: 5px;
    padding: 2px 6px;
    background-color: #e9ecef88;
    border-radius: 3px;
    display: inline-block;
}

.thinking {
    border-left-color: var(--assistant-dimmed);
}

/* Full purple when thinking is paired (as pair_first) */
.thinking.paired-message.pair_first {
    border-left-color: #9c27b0;
}

.image {
    border-left-color: #d48a5e;
    margin-left: 0; /* Align with user messages */
}

/* Session header styling */
.session-header {
    background-color: var(--session-bg-dimmed);
    border-radius: 8px;
    padding: 16px;
    margin: 30px 0 20px 0;
    box-shadow: -7px -7px 10px #eeeeee44, 7px 7px 10px #00000011;
    border-left: var(--white-dimmed) 1px solid;
    border-top: var(--white-dimmed) 1px solid;
    border-bottom: #00000017 1px solid;
    border-right: #00000017 1px solid;
}

.session-header .header {
    margin-bottom: 8px;
    font-size: 1.2em;
}

/* IDE notification styling */
.ide-notification {
    background-color: var(--ide-notification-dimmed);
    border-left: #9c27b0 2px solid;
    padding: 8px 12px;
    margin: 8px 0;
    border-radius: 4px;
    font-size: 80%;
    font-style: italic;
}

/* IDE selection styling */
.ide-selection-collapsible {
    margin-top: 4px;
}

.ide-selection-collapsible summary {
    cursor: pointer;
    color: var(--text-muted);
    user-select: none;
}

.ide-selection-collapsible summary:hover {
    color: #333;
}

.ide-selection-content {
    margin-top: 8px;
    padding: 8px;
    background-color: #f8f9fa;
    border-radius: 3px;
    border: 1px solid #dee2e6;
    font-family: var(--font-monospace);
    font-size: 0.85em;
    line-height: 1.4;
    white-space: pre-wrap;
    overflow-x: auto;
}

/* Content styling */
.content {
    word-wrap: break-word;
}

.content>pre {
    background-color: transparent;
    padding: 0;
    border-radius: 0;
}

.header:has(+ .content > details) {
    margin-left: 1em;
}

/* Assistant and Thinking content styling */
.assistant .content,
.thinking-text,
.user.compacted .content {
    font-family: var(--font-ui);
}

/* Code block styling */
pre > code {
    display: block;
}

/* Tool content styling */
.tool-content {
    background-color: var(--neutral-dimmed);
    border-radius: 4px;
    padding: 8px;
    margin: 8px 0;
    overflow-x: auto;
    box-shadow: -4px -4px 10px #eeeeee33, 4px 4px 10px #00000007;
    border-left: var(--white-dimmed) 1px solid;
    border-top: var(--white-dimmed) 1px solid;
    border-bottom: #00000017 1px solid;
    border-right: #00000017 1px solid;
}

/* Tool parameter table styling */
.tool-params-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 80%;
}

.tool-params-table tr {
    border-bottom: 1px solid var(--tool-param-sep-color);
}

.tool-param-key {
    padding: 4px;
    font-weight: 600;
    color: var(--text-secondary);
    vertical-align: top;
    width: 8em;
}

.tool-param-value {
    padding: 4px;
    color: #212529;
    vertical-align: top;
}

.tool-param-structured {
    margin: 0;
    background-color: #f8f9fa;
    padding: 4px;
    border-radius: 3px;
}

.tool-param-collapsible {
    margin: 0;
}

.tool-param-collapsible summary {
    cursor: pointer;
    color: var(--text-muted);
}

.tool-param-collapsible summary:hover {
    color: #333;
}

.tool-param-full {
    margin-top: 4px;
    word-break: break-all;
}

.tool-params-empty {
    color: #999;
    font-style: italic;
}

.tool-result {
    background-color: var(--tool-result-dimmed);
    border-left: #4caf5088 1px solid;
}

.tool-use {
    background-color: var(--highlight-dimmed);
    border-left: #2196f388 1px solid;
}

.thinking-content {
    background-color: var(--thinking-dimmed);
    border-left: #66666688 1px solid;
}

.thinking-text {
    font-family: var(--font-ui);
    font-size: 90%;
    word-wrap: break-word;
    color: #555;
}

.tool-input {
    background-color: var(--tool-input-dimmed);
    border-radius: 4px;
    padding: 6px;
    margin: 4px 0;
    font-size: 0.9em;
    box-shadow: -7px -7px 10px #eeeeee44, 7px 7px 10px #00000011;
    border-left: var(--white-dimmed) 1px solid;
    border-top: var(--white-dimmed) 1px solid;
    border-bottom: #00000017 1px solid;
    border-right: #00000017 1px solid;
}

/* Session summary styling */
.session-summary {
    background-color: var(--white-dimmed);
    border-left: #4caf5088 4px solid;
    padding: 12px;
    margin: 8px 0;
    border-radius: 0 4px 4px 0;
    font-style: italic;
    box-shadow: -7px -7px 10px #eeeeee44, 7px 7px 10px #00000011;
    border-top: var(--white-dimmed) 1px solid;
    border-bottom: #00000017 1px solid;
    border-right: #00000017 1px solid;
}

/* Collapsible details styling */
details summary {
    cursor: pointer;
    color: var(--text-muted);
}

.collapsible-details {
    margin-top: -2em;
}

.collapsible-details summary {
    position: relative;
    cursor: pointer;
}

/* Collapsible code blocks (Read/Edit/Write tools) */
.tool_result .collapsible-code {
    margin-top: -2.5em;
}

.tool_result .collapsible-code summary {
    cursor: pointer;
    padding-top: 0.5em;
    background: var(--color-bg-secondary);
    border-radius: 4px;
}

.tool_result .collapsible-code summary:hover {
    background: var(--color-bg-tertiary);
}

/* Preview content styling - shown when closed */
.collapsible-details:not([open]) .preview-content {
    margin-top: 4px;
}

/* Tool result preview content with gradient fade */
.tool_result .preview-content {
    opacity: 0.7;
    mask-image: linear-gradient(to bottom, black 80%, transparent 100%);
    -webkit-mask-image: linear-gradient(to bottom, black 80%, transparent 100%);
}

/* Hide preview content when details/collapsible is open */
.collapsible-details[open] .preview-content,
.collapsible-code[open] .preview-content {
    display: none;
}

/* Style the full details content */
.details-content {
    margin-top: 4px;
}

/* Hide details content when closed */
.collapsible-details:not([open]) .details-content {
    display: none;
}

/* Style pre and other elements within details content */
.content pre {
    background-color: transparent;
    padding: 0;
    margin: 0;
    color: #555;
    line-height: 1.3;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/* Message filtering */
.message.filtered-hidden {
    display: none;
}

/* ANSI color classes */
/* Standard colors */
.ansi-black { color: #000000; }
.ansi-red { color: #cd3131; }
.ansi-green { color: #0dbc79; }
.ansi-yellow { color: #e5e510; }
.ansi-blue { color: #2472c8; }
.ansi-magenta { color: #bc3fbc; }
.ansi-cyan { color: #11a8cd; }
.ansi-white { color: #e5e5e5; }

/* Bright colors */
.ansi-bright-black { color: #666666; }
.ansi-bright-red { color: #f14c4c; }
.ansi-bright-green { color: #23d18b; }
.ansi-bright-yellow { color: #f5f543; }
.ansi-bright-blue { color: #3b8eea; }
.ansi-bright-magenta { color: #d670d6; }
.ansi-bright-cyan { color: #29b8db; }
.ansi-bright-white { color: #ffffff; }

/* Background colors */
.ansi-bg-black { background-color: #000000; }
.ansi-bg-red { background-color: #cd3131; }
.ansi-bg-green { background-color: #0dbc79; }
.ansi-bg-yellow { background-color: #e5e510; }
.ansi-bg-blue { background-color: #2472c8; }
.ansi-bg-magenta { background-color: #bc3fbc; }
.ansi-bg-cyan { background-color: #11a8cd; }
.ansi-bg-white { background-color: #e5e5e5; }

/* Bright background colors */
.ansi-bg-bright-black { background-color: #666666; }
.ansi-bg-bright-red { background-color: #f14c4c; }
.ansi-bg-bright-green { background-color: #23d18b; }
.ansi-bg-bright-yellow { background-color: #f5f543; }
.ansi-bg-bright-blue { background-color: #3b8eea; }
.ansi-bg-bright-magenta { background-color: #d670d6; }
.ansi-bg-bright-cyan { background-color: #29b8db; }
.ansi-bg-bright-white { background-color: #ffffff; }

/* Text styles */
.ansi-bold { font-weight: bold; }
.ansi-dim { opacity: 0.7; }
.ansi-italic { font-style: italic; }
.ansi-underline { text-decoration: underline; }
/* Session navigation styles */
.navigation {
    background-color: #f8f9fa66;
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 24px;
    box-shadow: -7px -7px 10px #eeeeee44, 7px 7px 10px #00000011;
    border-left: #ffffff66 1px solid;
    border-top: #ffffff66 1px solid;
    border-bottom: #00000017 1px solid;
    border-right: #00000017 1px solid;
}

.navigation h2 {
    margin: 0 0 12px 0;
    font-size: 1.2em;
    color: #495057;
}

.session-nav {
    margin-top: 1em;
    display: grid;
    gap: 8px;
}

.session-link {
    padding: 8px 12px;
    background-color: #ffffff66;
    border: 1px solid #dee2e6;
    border-radius: 4px;
    text-decoration: none;
    color: #495057;
    transition: background-color 0.2s;
}

.session-link:hover {
    background-color: #ffffff99;
}

.session-link-title {
    font-weight: 600;
    font-size: 0.9em;
}

.session-link-meta {
    font-size: 0.8em;
    color: #6c757d;
    margin-top: 2px;
}

/* Project-specific session navigation */
.project-sessions {
    margin-top: 15px;
    border-top: 1px solid #dee2e6;
    padding-top: 15px;
}

.project-sessions h4 {
    margin: 0 0 10px 0;
    font-size: 0.9em;
    color: #495057;
    font-weight: 600;
}

.project-sessions .session-link {
    padding: 6px 8px;
    font-size: 0.8em;
    margin-bottom: 4px;
}

.project-sessions .session-link-title {
    font-size: 0.85em;
}

.project-sessions .session-link-meta {
    font-size: 0.75em;
}

/* Combined transcript link */
.combined-transcript-link {
    display: inline-block;
    padding: 8px 12px;
    background-color: #ffffff66;
    border: 1px solid #dee2e6;
    border-radius: 4px;
    text-decoration: none;
    color: #495057;
    font-weight: 500;
    transition: background-color 0.2s;
}

.combined-transcript-link:hover {
    background-color: #ffffff99;
    text-decoration: none;
}
/* Filter toolbar and controls */
.filter-toolbar {
    background-color: #f8f9fa66;
    border-radius: 8px;
    padding: 12px 16px;
    margin-bottom: 16px;
    box-shadow: -7px -7px 10px #eeeeee44, 7px 7px 10px #00000011;
    border-left: #ffffff66 1px solid;
    border-top: #ffffff66 1px solid;
    border-bottom: #00000017 1px solid;
    border-right: #00000017 1px solid;
    display: none;
    position: sticky;
    top: 0;
    z-index: 100;
    backdrop-filter: blur(8px);
}

.filter-toolbar.visible {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.toolbar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
    padding-bottom: 8px;
    border-bottom: 1px solid #dee2e633;
    gap: 16px;
}

.toolbar-header h3 {
    margin: 0;
    font-size: 1em;
    color: #495057;
    font-weight: 600;
}

.close-toolbar-btn {
    background: none;
    border: none;
    color: #666;
    cursor: pointer;
    font-size: 20px;
    padding: 5px;
    border-radius: 50%;
    transition: all 0.2s;
    line-height: 1;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.close-toolbar-btn:hover {
    background-color: #ffffff66;
    color: #333;
}

.filter-section {
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid #dee2e633;
}


.filter-toggles {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
}


.filter-toggle {
    padding: 6px 12px;
    border: 1px solid #dee2e6;
    border-radius: 20px;
    background-color: transparent;
    color: #495057;
    font-size: 0.85em;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 4px;
    white-space: nowrap;
}

.filter-toggle:hover {
    background-color: #ffffff99;
    transform: translateY(-1px);
}

.filter-toggle.active {
    background-color: #ffffffaa;
}

.filter-toggle.active:hover {
    background-color: #ffffff66;
}

/* Color-coded filter buttons */
.filter-toggle[data-type="user"] {
    border-color: #ff9800;
    border-width: 2px;
}

.filter-toggle[data-type="system"] {
    border-color: #d98100;
    border-width: 2px;
}

.filter-toggle[data-type="tool"] {
    border-color: #4caf50;
    border-width: 2px;
}

.filter-toggle[data-type="assistant"] {
    border-color: #9c27b0;
    border-width: 2px;
}

.filter-toggle[data-type="thinking"] {
    border-color: #9c27b066;
    border-width: 2px;
}

.filter-actions {
    display: flex;
    gap: 6px;
}

.filter-action-btn {
    padding: 4px 8px;
    border: 1px solid #dee2e6;
    border-radius: 4px;
    background-color: #ffffff66;
    color: #6c757d;
    font-size: 0.75em;
    cursor: pointer;
    transition: background-color 0.2s;
}

.filter-action-btn:hover {
    background-color: #ffffff99;
}

.filter-toggle .count {
    opacity: 0.7;
    font-size: 0.9em;
    margin-left: 2px;
}

.filter-toggle.active .count {
    opacity: 1;
}

.filter-messages.active {
    background-color: #fff3cd;
}
/* TodoWrite tool styling */
.todo-write {
    background-color: #f0f8ff66;
    border-left: #4169e188 3px solid;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
}

.tool-header {
    font-weight: 600;
    margin-bottom: 12px;
    color: #2c3e50;
    font-size: 1.1em;
}

.todo-list {
    background-color: #ffffff66;
    border-radius: 6px;
    padding: 8px;
    box-shadow: -7px -7px 10px #eeeeee44, 7px 7px 10px #00000011;
    border-left: #ffffff66 1px solid;
    border-top: #ffffff66 1px solid;
    border-bottom: #00000017 1px solid;
    border-right: #00000017 1px solid;
}

.todo-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 4px;
    border-bottom: 1px solid #f0f3f6;
    transition: background-color 0.2s ease;
}

.todo-item:last-child {
    border-bottom: none;
}

.todo-item:hover {
    background-color: #f8f9fa;
}

.todo-item.completed {
    opacity: 0.7;
}

.todo-item.completed .todo-content {
    text-decoration: line-through;
    color: #6c757d;
}

.todo-item input[type="checkbox"] {
    margin: 0;
    cursor: default;
}

.todo-status {
    font-size: 1.1em;
    line-height: 1;
}

.todo-content {
    flex: 1;
    color: #333;
    font-weight: 500;
    font-size: 90%;
    font-family: var(--font-ui);
}

.todo-id {
    font-size: 0.8em;
    color: #6c757d;
    font-weight: normal;
}

/* Priority-based left border colors */
.todo-item.high {
    border-left: 3px solid #dc3545;
}

.todo-item.medium {
    border-left: 3px solid #ffc107;
}

.todo-item.low {
    border-left: 3px solid #28a745;
}

/* Status-based background tints */
.todo-item.in_progress {
    background-color: #fff3cd;
}

.todo-item.completed {
    background-color: #d4edda;
}
/* Timeline-specific styles for vis-timeline */

/* Timeline toggle button styling */
.timeline-toggle.active {
    background-color: #fff3cd;
}

/* Timeline container positioning and styling */
#timeline-container {
    margin-bottom: 20px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    transition: top 0.3s ease;
    position: relative;
}

/* Timeline resize handle styling */
#timeline-resize-handle {
    transition: background 0.2s ease;
}

#timeline-resize-handle:hover {
    background: linear-gradient(to bottom, transparent, #bbb) !important;
}

#timeline-resize-handle:hover>div {
    background: #777 !important;
}

#timeline-resize-handle:active {
    background: linear-gradient(to bottom, transparent, #999) !important;
}

#timeline-resize-handle:active>div {
    background: #555 !important;
}

/* vis-timeline customizations */
.vis-timeline {
    border: none !important;
}

.vis-labelset .vis-label {
    font-size: 12px !important;
    font-weight: 500 !important;
    color: #495057 !important;
}

/* Timeline items styling */
.vis-item {
    border-radius: 4px !important;
    border: 1px solid #ddd !important;
    font-size: 11px !important;
    /* Stuck item workaround, see: https://github.com/visjs/vis-timeline/issues/494#issuecomment-1638974075 */
    transform: scale(0);
}

.vis-item .vis-item-content {
    padding: 2px 4px !important;
}

.vis-item.vis-selected {
    border-color: #007bff !important;
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25) !important;
}

/* Message type specific styling */
.vis-item.timeline-item-user {
    background-color: #e3f2fd !important;
    border-color: #2196f3 !important;
}

.vis-item.timeline-item-assistant {
    background-color: #f3e5f5 !important;
    border-color: #9c27b0 !important;
}

.vis-item.timeline-item-tool_use {
    background-color: #fff8e1 !important;
    border-color: #ffc107 !important;
}

.vis-item.timeline-item-tool_result {
    background-color: #e8f5e8 !important;
    border-color: #4caf50 !important;
}

.vis-item.timeline-item-thinking {
    background-color: #fce4ec !important;
    border-color: #e91e63 !important;
}

.vis-item.timeline-item-system {
    background-color: #ffeee1 !important;
    border-color: #ff8707 !important;
}

.vis-item.timeline-item-image {
    background-color: #e1f5fe !important;
    border-color: #00bcd4 !important;
}

.vis-item.timeline-item-sidechain {
    background-color: #f5f5f5 !important;
    border-color: #9e9e9e !important;
}

/* Hide filtered timeline items */
.vis-item.timeline-filtered-hidden {
    display: none !important;
}

/* Timeline axis styling */
.vis-time-axis {
    border-top: 1px solid #ddd !important;
}

.vis-time-axis .vis-text {
    font-size: 11px !important;
    color: #666 !important;
}

/* Timeline navigation controls */
.vis-navigation {
    font-size: 12px !important;
}

/* Hide vis-timeline watermark if present */
.vis-timeline .vis-custom-time {
    display: none !important;
}

.vis-tooltip {
    max-width: 700px;
    padding: 1em !important;
    white-space: normal !important;
    font-family: inherit !important;
}

.vis-tooltip pre {
    margin: 0;
    padding: 0;
    background-color: transparent;
}

.vis-tooltip img {
    max-width: 700px;
}

.vis-tooltip div {
    white-space: normal;
}
/* Search Bar Styles */
.search-container {
    position: relative;
    width: 100%;
}

/* Keyboard shortcut hint */
.search-hint {
    position: absolute;
    right: 45px;
    top: 50%;
    transform: translateY(-50%);
    color: #999;
    font-size: 0.75em;
    pointer-events: none;
    transition: opacity 0.2s;
}

.search-hint.hidden {
    opacity: 0;
    visibility: hidden;
}

/* Inline Search for Filter Toolbar */
.search-inline {
    width: 100%;
    margin-bottom: 12px;
}

/* In filter toolbar mode, search is always visible when toolbar is visible */
.filter-toolbar:not(.visible) .search-container {
    display: none;
}

.search-input-wrapper {
    position: relative;
    display: flex;
    align-items: center;
    gap: 10px;
}

.search-input {
    width: 100%;
    padding: 8px 40px 8px 12px;
    background: #ffffff88;
    border: 1px solid #dee2e6;
    border-radius: 20px;
    color: #495057;
    font-size: 0.85em;
    font-family: inherit;
    transition: all 0.2s;
}

.search-input:focus {
    outline: none;
    border-color: #2196f3;
    background: #ffffff99;
    box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.2);
}

.search-input::placeholder {
    color: #666;
}

.search-clear {
    position: absolute;
    right: 15px;
    background: none;
    border: none;
    color: #666;
    cursor: pointer;
    font-size: 18px;
    padding: 5px;
    display: none;
    border-radius: 50%;
    transition: all 0.2s;
}

.search-clear:hover {
    color: #333;
    background: #ffffff66;
}

.search-clear.visible {
    display: block;
}

/* Search Results Counter */
.search-results-info {
    margin-top: 8px;
    font-size: 12px;
    color: #666;
    display: none;
}

.search-results-info.visible {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
}

.search-navigation {
    display: flex;
    gap: 5px;
    align-items: center;
}

.search-options-inline {
    display: flex;
    gap: 12px;
    font-size: 0.75em;
}

.search-option-inline {
    display: flex;
    align-items: center;
    gap: 4px;
    cursor: pointer;
    color: #666;
}

.search-option-inline:hover {
    color: #333;
}

.search-option-inline input[type="checkbox"] {
    cursor: pointer;
    margin: 0;
}

.search-nav-btn {
    background: #ffffff88;
    border: 1px solid #dee2e6;
    border-radius: 4px;
    color: #333;
    padding: 4px 8px;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.2s;
}

.search-nav-btn:hover:not(:disabled) {
    background: #ffffff99;
    border-color: #2196f3;
    transform: translateY(-1px);
}

.search-nav-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* Search Match Highlighting */
.search-highlight {
    background-color: #ffeb3b;
    color: #000;
    padding: 0 2px;
    border-radius: 2px;
}

.search-highlight.current {
    background-color: #ff9800;
    color: #000;
}

/* Search Options */
.search-options {
    margin-top: 8px;
    display: flex;
    gap: 12px;
    font-size: 0.75em;
}

.search-option {
    display: flex;
    align-items: center;
    gap: 5px;
    color: #666;
    transition: color 0.2s;
}

.search-option input[type="checkbox"] {
    cursor: pointer;
    accent-color: #2196f3;
}

.search-option label {
    cursor: pointer;
    user-select: none;
}

.search-option:hover {
    color: #333;
}

/* Index Page Search Results */
.search-results-panel {
    margin: 20px 0;
    padding: 20px;
    background-color: #ffffff66;
    border-radius: 8px;
    box-shadow: -7px -7px 10px #eeeeee44, 7px 7px 10px #00000011;
    border-left: #ffffff66 1px solid;
    border-top: #ffffff66 1px solid;
    border-bottom: #00000017 1px solid;
    border-right: #00000017 1px solid;
    display: none;
}

.search-results-panel.visible {
    display: block;
}

.search-results-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #dee2e6;
}

.search-results-title {
    font-size: 16px;
    font-weight: 600;
    color: #2c3e50;
}

.search-close-btn {
    background: none;
    border: none;
    color: #666;
    cursor: pointer;
    font-size: 20px;
    padding: 5px;
    border-radius: 50%;
    transition: all 0.2s;
}

.search-close-btn:hover {
    color: #333;
    background: #ffffff66;
}

.search-result-group {
    margin-bottom: 20px;
}

.search-result-group-title {
    font-size: 14px;
    font-weight: 600;
    color: #2196f3;
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.search-result-count {
    background: #ffffff88;
    color: #666;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: normal;
    border: 1px solid #dee2e6;
}

.search-result-item {
    padding: 12px;
    margin-bottom: 8px;
    background-color: #ffffff88;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: -3px -3px 5px #eeeeee22, 3px 3px 5px #00000008;
    border-left: #ffffff44 1px solid;
    border-top: #ffffff44 1px solid;
    border-bottom: #00000012 1px solid;
    border-right: #00000012 1px solid;
}

.search-result-item:hover {
    background-color: #ffffff99;
    transform: translateY(-1px);
    box-shadow: -5px -5px 8px #eeeeee33, 5px 5px 8px #00000012;
}

.search-result-item a {
    text-decoration: none;
    color: inherit;
    display: block;
}

.search-result-session {
    font-size: 12px;
    color: #666;
    margin-bottom: 5px;
    font-weight: 500;
}

.search-result-excerpt {
    font-size: 13px;
    color: #495057;
    line-height: 1.4;
}

.search-result-excerpt .search-highlight {
    font-weight: 600;
    background-color: #ffeb3b;
    color: #000;
    padding: 0 2px;
    border-radius: 2px;
}

.search-result-meta {
    margin-top: 8px;
    font-size: 11px;
    color: #666;
    display: flex;
    gap: 15px;
    padding-top: 5px;
    border-top: 1px solid #dee2e611;
}

/* Removed floating search button - now integrated in filter toolbar */

/* No results message */
.search-no-results {
    text-align: center;
    padding: 30px;
    color: #666;
    font-size: 14px;
    background-color: #ffffff44;
    border-radius: 6px;
    margin: 10px 0;
}

/* Loading indicator */
.search-loading {
    text-align: center;
    padding: 20px;
    color: #666;
    background-color: #ffffff44;
    border-radius: 6px;
}

.search-loading::after {
    content: '...';
    animation: dots 1.5s infinite;
}

@keyframes dots {
    0%, 20% { content: '.'; }
    40% { content: '..'; }
    60%, 100% { content: '...'; }
}

/* Keyboard shortcut hint */

/* Responsive adjustments */
@media (max-width: 768px) {
    .search-input {
        font-size: 0.8em;
    }

    .search-options {
        font-size: 0.7em;
    }
}
/* Edit tool diff styling */
.edit-tool-content {
    margin: 8px 0;
}

.edit-file-path {
    font-weight: 600;
    color: var(--text-secondary);
    margin-bottom: 8px;
    font-size: 0.95em;
}

.edit-replace-all {
    color: var(--text-muted);
    font-size: 0.85em;
    font-style: italic;
    margin-bottom: 8px;
}

.edit-diff {
    background-color: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 4px;
    overflow-x: auto;
    font-family: var(--font-monospace);
    font-size: 80%;
    line-height: 2ex;
}

/* Diff line styling */
.diff-line {
    padding: 2px 4px 2px 2px;
    white-space: pre-wrap;
    word-wrap: break-word;
}

.diff-marker {
    display: inline-block;
    width: 1.5em;
    text-align: center;
    user-select: none;
    color: var(--text-muted);
}

/* Line backgrounds */
.diff-removed {
    background-color: #ffebe9;
    border-left: 3px solid #f85149;
}

.diff-added {
    background-color: #dafbe1;
    border-left: 3px solid #3fb950;
}

.diff-context {
    background-color: var(--code-bg-color);
    border-left: 3px solid transparent;
}

/* Character-level highlighting */
.diff-char-removed {
    background-color: #ffcecb;
    border-radius: 2px;
}

.diff-char-added {
    background-color: #abf2bc;
    border-radius: 2px;
}

/* Remove default mark styling */
mark.diff-char-removed,
mark.diff-char-added {
    color: inherit;
}
/* Pygments syntax highlighting styles */

/* Base styles for highlighted code blocks */
.highlight {
    background: var(--color-bg-secondary);
    border-radius: 4px;
    overflow-x: auto;
}

.highlight pre {
    margin: 0;
    padding: 0.5em;
    line-height: 1.5;
    font-family: var(--font-monospace);
    white-space: pre;  /* Prevent line wrapping */
}

/* Smaller font for code blocks in markdown content (assistant messages, thinking, etc.) */
.content.markdown .highlight pre code {
    font-size: 80%;
}

/* Line numbers table styling */
.highlight .highlighttable {
    width: 100%;
    border-spacing: 0;
    background: transparent;
}

.highlight .highlighttable td {
    padding: 0;
    vertical-align: top;
}

.highlight .highlighttable td.linenos {
    width: 1%;
    text-align: right;
    user-select: none;
    border-right: 1px solid var(--color-border-dim);
}

.highlight .linenos pre {
    color: var(--color-text-dim);
    background: var(--color-bg-tertiary);
    padding: 0.65em 0.5em 0.5em 0.8em;
    margin: 0;
    line-height: 1.5;
    white-space: pre;
}

.highlight .linenos .normal {
    color: inherit;
}

.highlight td.code {
    width: 99%;
}

.highlight td.code pre {
    padding-left: 0.8em;
    line-height: 1.5;
}

/* Read tool specific styles */
.read-tool-content {
    font-weight: 600;
    color: var(--color-blue);
    margin: 0.5em 0;
    font-family: var(--font-monospace);
    font-size: 0.9em;
}

.read-tool-result {
    margin: 0.5em 0;
}

/* Unified styling for inline preview text in tool results */
.tool-result .line-count,
.tool-result .preview-text {
    font-size: 0.9em;
    color: var(--color-text-secondary);
    margin-left: 0.5em;
}

.read-tool-result .system-reminder {
    margin-top: 0.5em;
    padding: 0.5em;
    background: var(--color-bg-secondary);
    border-left: 3px solid var(--color-blue);
    border-radius: 4px;
    font-style: italic;
    font-size: 80%;
    color: var(--color-text-secondary);
}

/* Edit tool result specific styles */
.edit-tool-result {
    margin: 0.5em 0;
}

/* Multiedit tool specific styles */
.multiedit-tool-content {
    margin: 0.5em 0;
}

.multiedit-file-path {
    font-weight: 600;
    color: var(--color-purple);
    margin-bottom: 0.5em;
    font-family: var(--font-monospace);
    font-size: 0.9em;
}

.multiedit-count {
    font-size: 0.85em;
    color: var(--color-text-secondary);
    margin-bottom: 0.8em;
}

.multiedit-item {
    margin-bottom: 1em;
    border-left: 2px solid var(--color-border-dim);
    padding-left: 1em;
}

.multiedit-item-header {
    font-weight: 600;
    color: var(--color-text-secondary);
    margin-bottom: 0.5em;
    font-size: 0.9em;
}

/* Write tool specific styles */
.write-tool-content {
    margin: 0.5em 0;
}

.write-file-path {
    font-weight: 600;
    color: var(--color-green);
    margin-bottom: 0.5em;
    font-family: var(--font-monospace);
    font-size: 0.9em;
    padding-left: 1.5em;
}


/* Pygments token styles (based on 'default' theme) */
.highlight { background: var(--color-bg-secondary); }
.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>

<body>
    <h1 id="title">claude-factory: Senior-Level Clean Code &amp; Design Patterns Skill</h1>

    <!-- Timeline Component -->
    <!-- Timeline Component Template -->
<!-- vis-timeline integration for transcript visualization -->

<div id="timeline-container"
    style="display: none; position: sticky; top: 0; z-index: 100; background: white; border-bottom: 1px solid #ddd; width: 100vw; margin-left: calc(-50vw + 50%); overflow: hidden; min-height: 150px; max-height: 80vh;">
    <div id="timeline-visualization" style="height: calc(100% - 8px); width: 100%;"></div>
    <div id="timeline-resize-handle"
        style="position: absolute; bottom: 0; left: 0; right: 0; height: 8px; background: linear-gradient(to bottom, transparent, #ddd); cursor: ns-resize; display: flex; align-items: center; justify-content: center;">
        <div style="width: 40px; height: 3px; background: #999; border-radius: 2px;"></div>
    </div>
</div>

<script id="timeline-script">
    // Timeline functionality - inline for self-contained HTML
    (function () {
        let timeline = null;
        let items = null;
        let groups = null;
        let isTimelineLoaded = false;
        let timelineIdToElement = new Map(); // Map timeline IDs to DOM elements
        let isResizing = false;

        // Message type to group mapping
        const messageTypeGroups = {
            'user': { id: 'user', content: 'ü§∑ User', style: 'background-color: #e3f2fd;' },
            'assistant': { id: 'assistant', content: 'ü§ñ Assistant', style: 'background-color: #f3e5f5;' },
            'tool_use': { id: 'tool_use', content: 'üõ†Ô∏è Tool Use', style: 'background-color: #fff3e0;' },
            'tool_result': { id: 'tool_result', content: 'üß∞ Tool Result', style: 'background-color: #e8f5e8;' },
            'thinking': { id: 'thinking', content: 'üí≠ Thinking', style: 'background-color: #fce4ec;' },
            'system': { id: 'system', content: '‚öôÔ∏è System', style: 'background-color: #ffeee1;' },
            'image': { id: 'image', content: 'üñºÔ∏è Image', style: 'background-color: #e1f5fe;' },
            'sidechain': { id: 'sidechain', content: 'üîó Sub-assistant', style: 'background-color: #f5f5f5;' }
        };

        // Build timeline data from messages
        function buildTimelineData() {
            let latestTimeString = '1970-01-01 00:00:00';
            const timelineItems = [];
            const timelineGroups = [];
            const usedGroups = new Set();

            // Clear existing mapping
            timelineIdToElement.clear();

            // Get all messages from the page (including filtered ones - we'll hide them with CSS)
            const messages = document.querySelectorAll('.message:not(.session-header)');

            messages.forEach((messageEl, index) => {
                // Extract message data - handle both simple and complex CSS classes
                const classList = Array.from(messageEl.classList);
                let messageType = 'system'; // Default fallback

                // Check for sidechain first (sub-assistant messages)
                if (classList.includes('sidechain')) {
                    messageType = 'sidechain';
                } else if (classList.includes('system-warning') || classList.includes('system-error') || classList.includes('system-info')) {
                    messageType = 'system';
                } else {
                    // Look for standard message types
                    messageType = classList.find(cls =>
                        ['user', 'assistant', 'tool_use', 'tool_result', 'thinking', 'system', 'image'].includes(cls)
                    ) ?? 'system';
                }

                const timestampEl = messageEl.querySelector('.timestamp');
                if (!timestampEl) return; // Skip if no timestamp

                // Use raw timestamp from data attribute if available, otherwise fall back to text content
                const rawTimestamp = timestampEl.getAttribute('data-timestamp');
                const timestamp = rawTimestamp ?? timestampEl.textContent.trim();
                if (timestamp > latestTimeString) latestTimeString = timestamp;

                // Get message content preview
                const contentEl = messageEl.querySelector('.content');
                let content = '';
                if (contentEl) {
                    let textContent = contentEl.textContent ?? contentEl.innerText ?? '';

                    // For system messages, try to extract just the message without the prefix
                    if (messageType === 'system') {
                        // System messages often have format like "‚ö†Ô∏è System Warning: message content"
                        const systemMatch = textContent.match(/^[‚ö†Ô∏è‚ùå‚ÑπÔ∏è]?\s*System\s+\w+:\s*(.+)$/);
                        if (systemMatch) {
                            textContent = systemMatch[1];
                        }
                    }

                    content = textContent.length > 100 ? textContent.substring(0, 100) + '...' : textContent;
                }

                // For tool_use messages, try to extract the tool name
                if (messageType === 'tool_use') {
                    // Try to extract tool name from JSON content
                    const nameMatch = content.match(/"name":\s*"([^"]+)"/);
                    if (nameMatch) {
                        const toolName = nameMatch[1];
                        content = toolName + ': ' + content.replace(/"name":\s*"[^"]+",?\s*/, '');
                    } else {
                        // Fallback: try to extract from header if available
                        const headerEl = messageEl.querySelector('.header span');
                        if (headerEl) {
                            const headerText = headerEl.textContent ?? '';
                            const toolMatch = headerText.match(/üõ†Ô∏è\s*(.+) \(Id:.*/);
                            if (toolMatch) {
                                content = toolMatch[1].replace("Tool Use: ", "") + (content ? ': ' + content : '');
                            }
                        }
                    }
                }

                // Add group if not already added
                if (!usedGroups.has(messageType)) {
                    timelineGroups.push(messageTypeGroups[messageType]);
                    usedGroups.add(messageType);
                }

                // Store mapping for click handling
                timelineIdToElement.set(index, messageEl);

                // Format tooltip content with proper containment and styling
                let title = contentEl.innerHTML;
                title = title.includes("<pre") ? title : `<pre>${title}</pre>`;

                // Clean up collapsible details for tooltip display
                if (title.includes("<details")) {
                    title = title.replace(/(<summary>.*<\/summary>)/gs, '').replace(/<details class="collapsible-details">(.*?)<\/details>/gs, (m, p) => p)
                }

                // Clean up excessive whitespace in pre tags
                title = title.replace(/<pre([^>]*)>[\s\r\n]+(.*?)[\s\r\n]+<\/pre>/gs, (m, attrs, content) => `<pre${attrs}>${content}</pre>`)

                // Adjust content display based on message type
                let displayContent = content ?? messageTypeGroups[messageType].content;

                // Check for sidechain context regardless of primary message type
                if (classList.includes('sidechain')) {
                    // Override group for sidechain messages, but preserve the content
                    messageType = 'sidechain';

                    // For sidechain messages, prefix with appropriate icon based on original type
                    if (classList.includes('user')) {
                        displayContent = 'üìù ' + (content ?? 'Sub-assistant prompt');
                    } else if (classList.includes('assistant')) {
                        displayContent = 'üîó ' + (content ?? 'Sub-assistant response');
                    } else if (classList.includes('tool_use')) {
                        displayContent = 'üîó ' + (content ?? 'Sub-assistant tool use');
                    } else if (classList.includes('tool_result')) {
                        displayContent = 'üîó ' + (content ?? 'Sub-assistant tool result');
                    } else {
                        displayContent = 'üîó ' + (content ?? 'Sub-assistant');
                    }
                }

                // Create timeline item
                const timelineItem = {
                    id: index,
                    content: displayContent,
                    start: timestamp,
                    group: messageType,
                    title,
                    className: `timeline-item-${messageType}`
                };

                timelineItems.push(timelineItem);
            });

            // Set timeline window to show last hour by default, with padding after the last message
            const timelineEnd = new Date(new Date(latestTimeString).getTime() + 60 * 60 * 1000); // 1 hour after latest
            const timelineStart = new Date(timelineEnd.getTime() - 2 * 60 * 60 * 1000); // 2 hours total window (1 hour before latest + 1 hour after)

            return { timelineItems, timelineGroups, timelineEnd, timelineStart };
        }

        // Filter timeline items based on current message filters
        function applyFilters() {
            if (!timeline || !groups) return;

            // Get active filter types from filter toggles
            const activeTypes = Array.from(document.querySelectorAll('.filter-toggle.active'))
                .map(toggle => toggle.dataset.type);

            // Update groups visibility based on filter states
            const updatedGroups = groups.map(group => ({
                ...group,
                visible: activeTypes.includes(group.id)
            }));

            // Update timeline groups
            timeline.setGroups(updatedGroups);
        }

        // Handle timeline item click - scroll to corresponding message
        function onTimelineSelect(event) {
            const selection = timeline.getSelection();
            if (selection.length > 0) {
                const itemId = selection[0];
                const messageEl = timelineIdToElement.get(itemId);
                if (messageEl) {
                    // Calculate timeline height for proper scroll positioning
                    const timelineContainer = document.getElementById('timeline-container');
                    const timelineHeight = timelineContainer ? timelineContainer.offsetHeight : 0;

                    // Scroll so message top aligns with timeline bottom
                    const elementTop = messageEl.offsetTop;
                    const scrollPosition = elementTop - timelineHeight - 10; // 10px padding

                    window.scrollTo({
                        top: Math.max(0, scrollPosition),
                        behavior: 'smooth'
                    });

                    // Highlight the message briefly
                    messageEl.style.backgroundColor = '#fff3cd';
                    setTimeout(() => {
                        messageEl.style.backgroundColor = '';
                    }, 2000);
                }
            }
        }

        // Initialize timeline
        function initTimeline() {
            if (timeline) return; // Already initialized

            console.log('Initializing vis-timeline...');

            const container = document.getElementById('timeline-visualization');
            if (!container) {
                console.error('Timeline container not found');
                return;
            }

            // Build timeline data
            const { timelineItems, timelineGroups, timelineEnd, timelineStart } = buildTimelineData();
            items = timelineItems
            groups = timelineGroups
            if (items.length === 0) {
                console.warn('No timeline items found');
                return;
            }

            // Timeline options
            const options = {
                height: '100%',
                stack: true,
                showCurrentTime: true,
                zoomMin: 1000 * 1, // 1 second
                zoomMax: 1000 * 60 * 60 * 24 * 30, // 30 days
                start: timelineStart,
                end: timelineEnd,
                orientation: 'top',
                align: 'left',
                tooltip: {
                    // FIXME: This followMouse doesn't work for some reason and the tooltip box gets cut off for the bottom timeline boxes
                    followMouse: true,
                    overflowMethod: 'cap'
                },
                margin: {
                    item: 2,
                    axis: 2
                },
                groupOrder: (a, b) => {
                    const order = ['user', 'assistant', 'sidechain', 'tool_use', 'tool_result', 'thinking', 'system', 'image'];
                    return order.indexOf(a.id) - order.indexOf(b.id);
                }
            };

            // Create timeline
            timeline = new vis.Timeline(container, new vis.DataSet(items), new vis.DataSet(groups), options);

            // Make timeline available globally for debugging
            window.timeline = timeline;

            // Add event listeners
            timeline.on('select', onTimelineSelect);

            // Apply current filters
            applyFilters();

            console.log('Timeline initialized with', items.length, 'items and', groups.length, 'groups');
        }

        // Load vis-timeline library dynamically
        function loadVisTimeline() {
            return new Promise((resolve, reject) => {
                if (window.vis && window.vis.Timeline) {
                    resolve();
                    return;
                }

                console.log('Loading vis-timeline from CDN...');

                // Load CSS first
                const link = document.createElement('link');
                link.rel = 'stylesheet';
                link.href = 'https://unpkg.com/vis-timeline/styles/vis-timeline-graph2d.min.css';
                document.head.appendChild(link);

                // Load JavaScript
                const script = document.createElement('script');
                script.src = 'https://unpkg.com/vis-timeline/standalone/umd/vis-timeline-graph2d.min.js';
                script.onload = () => {
                    console.log('vis-timeline loaded successfully');
                    isTimelineLoaded = true;
                    resolve();
                };
                script.onerror = () => {
                    console.error('Failed to load vis-timeline');
                    reject(new Error('Failed to load vis-timeline'));
                };
                document.head.appendChild(script);
            });
        }

        // Toggle timeline visibility
        function toggleTimeline() {
            const container = document.getElementById('timeline-container');
            const button = document.getElementById('toggleTimeline');

            if (container.style.display === 'none') {
                // Show timeline
                button.classList.add('active');
                button.title = 'Hide timeline';
                button.textContent = 'üóìÔ∏è';

                // Load vis-timeline if needed and show timeline
                loadVisTimeline().then(() => {
                    container.style.display = 'block';
                    // Set default height if not already set
                    if (!container.style.height) {
                        container.style.height = '30vh';
                    }
                    // Wait for container to be visible, then initialize
                    setTimeout(() => {
                        initTimeline();
                        initTimelineResize();
                    }, 100);
                }).catch(error => {
                    console.error('Error loading timeline:', error);
                    alert('Failed to load timeline. Please check your internet connection.');
                    container.style.display = 'none';
                    button.classList.remove('active');
                    button.title = 'Show timeline';
                    button.textContent = 'üìÜ';
                });
            } else {
                // Hide timeline
                container.style.display = 'none';
                button.classList.remove('active');
                button.title = 'Show timeline';
                button.textContent = 'üìÜ';
            }
        }

        // Update timeline position when filter bar is toggled
        function updateTimelinePosition() {
            const container = document.getElementById('timeline-container');
            const filterToolbar = document.querySelector('.filter-toolbar');

            if (container && filterToolbar) {
                const filterHeight = filterToolbar.offsetHeight;
                const computedStyle = getComputedStyle(filterToolbar);
                const isFilterVisible = computedStyle.display !== 'none' &&
                    computedStyle.visibility !== 'hidden' &&
                    filterHeight > 0;

                container.style.top = isFilterVisible ? `${filterHeight}px` : '0px';
            }
        }

        // Initialize timeline resizing functionality
        function initTimelineResize() {
            const container = document.getElementById('timeline-container');
            const resizeHandle = document.getElementById('timeline-resize-handle');

            if (!container || !resizeHandle) return;

            let startY = 0;
            let startHeight = 0;

            function handleMouseDown(e) {
                isResizing = true;
                startY = e.clientY;
                startHeight = container.offsetHeight;

                document.addEventListener('mousemove', handleMouseMove);
                document.addEventListener('mouseup', handleMouseUp);

                // Prevent text selection during resize
                document.body.style.userSelect = 'none';
                e.preventDefault();
            }

            function handleMouseMove(e) {
                if (!isResizing) return;

                const deltaY = e.clientY - startY;
                const newHeight = Math.max(150, Math.min(window.innerHeight * 0.8, startHeight + deltaY));

                container.style.height = newHeight + 'px';

                // Trigger timeline redraw if needed
                if (timeline) {
                    timeline.redraw();
                }
            }

            function handleMouseUp() {
                isResizing = false;
                document.removeEventListener('mousemove', handleMouseMove);
                document.removeEventListener('mouseup', handleMouseUp);
                document.body.style.userSelect = '';
            }

            // Add mouse event listeners
            resizeHandle.addEventListener('mousedown', handleMouseDown);

            // Also allow resizing by dragging the container bottom edge
            container.addEventListener('mousedown', function (e) {
                const rect = container.getBoundingClientRect();
                if (e.clientY >= rect.bottom - 8) {
                    handleMouseDown(e);
                }
            });
        }

        // Export functions to global scope
        window.toggleTimeline = toggleTimeline;
        window.applyTimelineFilters = applyFilters;
        window.updateTimelinePosition = updateTimelinePosition;

        // Hook into existing systems
        document.addEventListener('DOMContentLoaded', function () {
            // Listen for filter changes
            const filterToggles = document.querySelectorAll('.filter-toggle');
            filterToggles.forEach(toggle => {
                toggle.addEventListener('click', function () {
                    setTimeout(applyFilters, 50);
                });
            });

            // Listen for select all/none buttons
            const selectAllButton = document.getElementById('selectAll');
            const selectNoneButton = document.getElementById('selectNone');
            if (selectAllButton) {
                selectAllButton.addEventListener('click', function () {
                    setTimeout(applyFilters, 50);
                });
            }
            if (selectNoneButton) {
                selectNoneButton.addEventListener('click', function () {
                    setTimeout(applyFilters, 50);
                });
            }

            // Listen for filter toolbar visibility changes
            const filterButton = document.getElementById('filterMessages');
            const closeFiltersButton = document.getElementById('closeFilters');

            if (filterButton) {
                filterButton.addEventListener('click', function () {
                    setTimeout(updateTimelinePosition, 50);
                });
            }

            if (closeFiltersButton) {
                closeFiltersButton.addEventListener('click', function () {
                    setTimeout(updateTimelinePosition, 50);
                });
            }

            // Update timeline position on window resize
            window.addEventListener('resize', updateTimelinePosition);
        });
    })();
</script>

    <!-- Combined Search & Filter Toolbar -->
    <div class="filter-toolbar">
        <div class="toolbar-header">
            <h3>üîç Search & Filter</h3>
            <button class="close-toolbar-btn" id="closeToolbar" title="Close">‚úï</button>
        </div>

        <!-- Inline Search -->
        <!-- Inline Search Component for Filter Toolbar -->
<div id="searchContainer" class="search-inline search-container">
    <div class="search-input-wrapper">
        <input type="text"
               id="searchInput"
               class="search-input"
               placeholder="Search conversations... (Ctrl+F)"
               autocomplete="off">
        <button id="searchClear" class="search-clear" title="Clear search">‚úï</button>
    </div>

    <div id="searchResultsInfo" class="search-results-info">
        <div class="search-navigation">
            <span id="searchResultCount">No results</span>
            <button id="searchPrev" class="search-nav-btn" disabled title="Previous match (Shift+F3)">‚Üë</button>
            <button id="searchNext" class="search-nav-btn" disabled title="Next match (F3)">‚Üì</button>
        </div>
        <div class="search-options-inline">
            <label class="search-option-inline">
                <input type="checkbox" id="searchRegex">
                <span>Regex</span>
            </label>
            <label class="search-option-inline">
                <input type="checkbox" id="searchInFiltered" checked>
                <span>Visible only</span>
            </label>
        </div>
    </div>
</div>

        <!-- Filter Section -->
        <div class="filter-section">
            <div class="filter-toggles">
                <button class="filter-toggle active" data-type="user">ü§∑ User <span class="count">(0)</span></button>
                <button class="filter-toggle active" data-type="system">‚öôÔ∏è System <span class="count">(0)</span></button>
                <button class="filter-toggle active" data-type="assistant">ü§ñ Assistant <span
                        class="count">(0)</span></button>
                <button class="filter-toggle active" data-type="thinking">üí≠ Thinking <span
                        class="count">(0)</span></button>
                <button class="filter-toggle active" data-type="tool">üõ†Ô∏è Tool <span
                        class="count">(0)</span></button>
                <button class="filter-toggle active" data-type="sidechain">üîó Sub-assistant <span
                        class="count">(0)</span></button>
                <button class="filter-toggle active" data-type="image">üñºÔ∏è Images <span class="count">(0)</span></button>
            </div>
            <div class="filter-actions">
                <button class="filter-action-btn" id="selectAll">All</button>
                <button class="filter-action-btn" id="selectNone">None</button>
            </div>
        </div>
    </div>


    
    <div class="navigation">
        <a href="combined_transcripts.html" class="combined-transcript-link">
            ‚Üê View All Sessions (Combined Transcript)
        </a>
    </div>
    

    
    
    <div class="session-divider"></div>
    <div id='session-8675a1f5-6785-4b2d-a77f-75b62fb028c2' class='message session-header'>
        <div class='header'>Session: Senior-Level Clean Code &amp; Design Patterns Skill ‚Ä¢ 8675a1f5</div>
        

    </div>
    
    
    
    
    <div class='message user sidechain'>
        <div class='header'>
            <span>üìù Sub-assistant prompt</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:42:19.177Z'>2025-11-07 10:42:19</span>
                </div>
                
            </div>
        </div>
        <div class='content'><p>Warmup</p>
</div>
    </div>
    
    
    
    
    <div class='message user sidechain'>
        <div class='header'>
            <span>üìù Sub-assistant prompt</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:42:19.178Z'>2025-11-07 10:42:19</span>
                </div>
                
            </div>
        </div>
        <div class='content'><p>Warmup</p>
</div>
    </div>
    
    
    
    
    <div class='message user'>
        <div class='header'>
            <span>ü§∑ User</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:42:23.013Z'>2025-11-07 10:42:23</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>create me a skill which write clean code using the best practices for design patterns. on a
level of a senior levle software engineer</pre></div>
    </div>
    
    
    
    
    <div class='message assistant sidechain'>
        <div class='header'>
            <span>üîó Sub-assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:42:25.252Z'>2025-11-07 10:42:25</span>
                </div>
                
                <span class='token-usage'>Input: 813 | Output: 155</span>
                
            </div>
        </div>
        <div class='content'><p>I'm Claude Code, Anthropic's official CLI for Claude, and I'm ready to help you search through the codebase at <code>/root/Claude/claude-factory</code>.</p>
<p>I've reviewed the project instructions in CLAUDE.md. This is a workspace for creating tools for Claude Code, including skills, subagents, and hooks, with specific directories and workflows defined.</p>
<p>I'm prepared to:</p>
<ul>
<li>Search files using glob patterns for broad matching</li>
<li>Use grep with regex for content searching</li>
<li>Read specific files you need analyzed</li>
<li>Help navigate and explore the codebase structure</li>
<li>Report findings with absolute file paths and relevant code snippets</li>
</ul>
<p>What would you like me to search for or explore in this codebase?</p>
</div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:42:27.535Z'>2025-11-07 10:42:27</span>
                </div>
                
                <span class='token-usage'>Input: 2 | Output: 8 | Cache Read: 19973</span>
                
            </div>
        </div>
        <div class='content markdown'><p>I'll help you create a skill for writing clean code with design patterns at a senior level. Let me start by using the skill-creator to guide this development.</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01EvGicpbvs5Q73gHBiewK6M">üõ†Ô∏è Skill</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:42:28.476Z'>2025-11-07 10:42:28</span>
                </div>
                
            </div>
        </div>
        <div class='content'><table class='tool-params-table'>
            <tr>
                <td class='tool-param-key'>skill</td>
                <td class='tool-param-value'>skill-creator</td>
            </tr>
        </table></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01EvGicpbvs5Q73gHBiewK6M"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:42:28.552Z' data-duration='took 76 ms'>2025-11-07 10:42:28</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>Launching skill: skill-creator</pre></div>
    </div>
    
    
    
    
    <div class='message system'>
        <div class='header'>
            <span>‚öôÔ∏è System</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:42:28.543Z'>2025-11-07 10:42:28</span>
                </div>
                
            </div>
        </div>
        <div class='content'><strong>Command:</strong> skill-creator</div>
    </div>
    
    
    
    
    <div class='message user'>
        <div class='header'>
            <span>ü§∑ User</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:42:28.543Z'>2025-11-07 10:42:28</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>Base directory for this skill: /root/Claude/claude-factory/.claude/skills/skill-creator

# Skill Creator

This skill provides guidance for creating effective skills.

## About Skills

Skills are modular, self-contained packages that extend Claude&#x27;s capabilities by providing
specialized knowledge, workflows, and tools. Think of them as &quot;onboarding guides&quot; for specific
domains or tasks‚Äîthey transform Claude from a general-purpose agent into a specialized agent
equipped with procedural knowledge that no model can fully possess.

### What Skills Provide

1. Specialized workflows - Multi-step procedures for specific domains
2. Tool integrations - Instructions for working with specific file formats or APIs
3. Domain expertise - Company-specific knowledge, schemas, business logic
4. Bundled resources - Scripts, references, and assets for complex and repetitive tasks

### Anatomy of a Skill

Every skill consists of a required SKILL.md file and optional bundled resources:

```
skill-name/
‚îú‚îÄ‚îÄ SKILL.md (required)
‚îÇ   ‚îú‚îÄ‚îÄ YAML frontmatter metadata (required)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ name: (required)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ description: (required)
‚îÇ   ‚îî‚îÄ‚îÄ Markdown instructions (required)
‚îî‚îÄ‚îÄ Bundled Resources (optional)
    ‚îú‚îÄ‚îÄ scripts/          - Executable code (Python/Bash/etc.)
    ‚îú‚îÄ‚îÄ references/       - Documentation intended to be loaded into context as needed
    ‚îî‚îÄ‚îÄ assets/           - Files used in output (templates, icons, fonts, etc.)
```

#### SKILL.md (required)

**Metadata Quality:** The `name` and `description` in YAML frontmatter determine when Claude will use the skill. Be specific about what the skill does and when to use it. Use the third-person (e.g. &quot;This skill should be used when...&quot; instead of &quot;Use this skill when...&quot;).

#### Bundled Resources (optional)

##### Scripts (`scripts/`)

Executable code (Python/Bash/etc.) for tasks that require deterministic reliability or are repeatedly rewritten.

- **When to include**: When the same code is being rewritten repeatedly or deterministic reliability is needed
- **Example**: `scripts/rotate_pdf.py` for PDF rotation tasks
- **Benefits**: Token efficient, deterministic, may be executed without loading into context
- **Note**: Scripts may still need to be read by Claude for patching or environment-specific adjustments

##### References (`references/`)

Documentation and reference material intended to be loaded as needed into context to inform Claude&#x27;s process and thinking.

- **When to include**: For documentation that Claude should reference while working
- **Examples**: `references/finance.md` for financial schemas, `references/mnda.md` for company NDA template, `references/policies.md` for company policies, `references/api_docs.md` for API specifications
- **Use cases**: Database schemas, API documentation, domain knowledge, company policies, detailed workflow guides
- **Benefits**: Keeps SKILL.md lean, loaded only when Claude determines it&#x27;s needed
- **Best practice**: If files are large (&gt;10k words), include grep search patterns in SKILL.md
- **Avoid duplication**: Information should live in either SKILL.md or references files, not both. Prefer references files for detailed information unless it&#x27;s truly core to the skill‚Äîthis keeps SKILL.md lean while making information discoverable without hogging the context window. Keep only essential procedural instructions and workflow guidance in SKILL.md; move detailed reference material, schemas, and examples to references files.

##### Assets (`assets/`)

Files not intended to be loaded into context, but rather used within the output Claude produces.

- **When to include**: When the skill needs files that will be used in the final output
- **Examples**: `assets/logo.png` for brand assets, `assets/slides.pptx` for PowerPoint templates, `assets/frontend-template/` for HTML/React boilerplate, `assets/font.ttf` for typography
- **Use cases**: Templates, images, icons, boilerplate code, fonts, sample documents that get copied or modified
- **Benefits**: Separates output resources from documentation, enables Claude to use files without loading them into context

### Progressive Disclosure Design Principle

Skills use a three-level loading system to manage context efficiently:

1. **Metadata (name + description)** - Always in context (~100 words)
2. **SKILL.md body** - When skill triggers (&lt;5k words)
3. **Bundled resources** - As needed by Claude (Unlimited*)

*Unlimited because scripts can be executed without reading into context window.

## Skill Creation Process

To create a skill, follow the &quot;Skill Creation Process&quot; in order, skipping steps only if there is a clear reason why they are not applicable.

### Step 1: Understanding the Skill with Concrete Examples

Skip this step only when the skill&#x27;s usage patterns are already clearly understood. It remains valuable even when working with an existing skill.

To create an effective skill, clearly understand concrete examples of how the skill will be used. This understanding can come from either direct user examples or generated examples that are validated with user feedback.

For example, when building an image-editor skill, relevant questions include:

- &quot;What functionality should the image-editor skill support? Editing, rotating, anything else?&quot;
- &quot;Can you give some examples of how this skill would be used?&quot;
- &quot;I can imagine users asking for things like &#x27;Remove the red-eye from this image&#x27; or &#x27;Rotate this image&#x27;. Are there other ways you imagine this skill being used?&quot;
- &quot;What would a user say that should trigger this skill?&quot;

To avoid overwhelming users, avoid asking too many questions in a single message. Start with the most important questions and follow up as needed for better effectiveness.

Conclude this step when there is a clear sense of the functionality the skill should support.

### Step 2: Planning the Reusable Skill Contents

To turn concrete examples into an effective skill, analyze each example by:

1. Considering how to execute on the example from scratch
2. Identifying what scripts, references, and assets would be helpful when executing these workflows repeatedly

Example: When building a `pdf-editor` skill to handle queries like &quot;Help me rotate this PDF,&quot; the analysis shows:

1. Rotating a PDF requires re-writing the same code each time
2. A `scripts/rotate_pdf.py` script would be helpful to store in the skill

Example: When designing a `frontend-webapp-builder` skill for queries like &quot;Build me a todo app&quot; or &quot;Build me a dashboard to track my steps,&quot; the analysis shows:

1. Writing a frontend webapp requires the same boilerplate HTML/React each time
2. An `assets/hello-world/` template containing the boilerplate HTML/React project files would be helpful to store in the skill

Example: When building a `big-query` skill to handle queries like &quot;How many users have logged in today?&quot; the analysis shows:

1. Querying BigQuery requires re-discovering the table schemas and relationships each time
2. A `references/schema.md` file documenting the table schemas would be helpful to store in the skill

To establish the skill&#x27;s contents, analyze each concrete example to create a list of the reusable resources to include: scripts, references, and assets.

### Step 3: Initializing the Skill

At this point, it is time to actually create the skill.

Skip this step only if the skill being developed already exists, and iteration or packaging is needed. In this case, continue to the next step.

When creating a new skill from scratch, always run the `init_skill.py` script. The script conveniently generates a new template skill directory that automatically includes everything a skill requires, making the skill creation process much more efficient and reliable.

Usage:

```bash
scripts/init_skill.py &lt;skill-name&gt; --path &lt;output-directory&gt;
```

The script:

- Creates the skill directory at the specified path
- Generates a SKILL.md template with proper frontmatter and TODO placeholders
- Creates example resource directories: `scripts/`, `references/`, and `assets/`
- Adds example files in each directory that can be customized or deleted

After initialization, customize or remove the generated SKILL.md and example files as needed.

### Step 4: Edit the Skill

When editing the (newly-generated or existing) skill, remember that the skill is being created for another instance of Claude to use. Focus on including information that would be beneficial and non-obvious to Claude. Consider what procedural knowledge, domain-specific details, or reusable assets would help another Claude instance execute these tasks more effectively.

#### Start with Reusable Skill Contents

To begin implementation, start with the reusable resources identified above: `scripts/`, `references/`, and `assets/` files. Note that this step may require user input. For example, when implementing a `brand-guidelines` skill, the user may need to provide brand assets or templates to store in `assets/`, or documentation to store in `references/`.

Also, delete any example files and directories not needed for the skill. The initialization script creates example files in `scripts/`, `references/`, and `assets/` to demonstrate structure, but most skills won&#x27;t need all of them.

#### Update SKILL.md

**Writing Style:** Write the entire skill using **imperative/infinitive form** (verb-first instructions), not second person. Use objective, instructional language (e.g., &quot;To accomplish X, do Y&quot; rather than &quot;You should do X&quot; or &quot;If you need to do X&quot;). This maintains consistency and clarity for AI consumption.

To complete SKILL.md, answer the following questions:

1. What is the purpose of the skill, in a few sentences?
2. When should the skill be used?
3. In practice, how should Claude use the skill? All reusable skill contents developed above should be referenced so that Claude knows how to use them.

### Step 5: Packaging a Skill

Once the skill is ready, it should be packaged into a distributable zip file that gets shared with the user. The packaging process automatically validates the skill first to ensure it meets all requirements:

```bash
scripts/package_skill.py &lt;path/to/skill-folder&gt;
```

Optional output directory specification:

```bash
scripts/package_skill.py &lt;path/to/skill-folder&gt; ./dist
```

The packaging script will:

1. **Validate** the skill automatically, checking:
   - YAML frontmatter format and required fields
   - Skill naming conventions and directory structure
   - Description completeness and quality
   - File organization and resource references

2. **Package** the skill if validation passes, creating a zip file named after the skill (e.g., `my-skill.zip`) that includes all files and maintains the proper directory structure for distribution.

If validation fails, the script will report the errors and exit without creating a package. Fix any validation errors and run the packaging command again.

### Step 6: Iterate

After testing the skill, users may request improvements. Often this happens right after using the skill, with fresh context of how the skill performed.

**Iteration workflow:**
1. Use the skill on real tasks
2. Notice struggles or inefficiencies
3. Identify how SKILL.md or bundled resources should be updated
4. Implement changes and test again</pre></div>
    </div>
    
    
    
    
    <div class='message assistant sidechain'>
        <div class='header'>
            <span>üîó Sub-assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:42:28.634Z'>2025-11-07 10:42:28</span>
                </div>
                
                <span class='token-usage'>Input: 824 | Output: 140</span>
                
            </div>
        </div>
        <div class='content'><p>I'm ready to help you with the Claude Factory project! I can assist with:</p>
<p><strong>Core Capabilities:</strong></p>
<ul>
<li>üîç Searching and exploring the codebase</li>
<li>üìù Creating skills, subagents, and hooks for Claude Code</li>
<li>üì¶ Packaging tools into distributable formats</li>
<li>üìÇ Organizing files into the proper directories</li>
</ul>
<p><strong>Key Paths:</strong></p>
<ul>
<li>Skills directory: <code>skills/</code></li>
<li>Agents directory: <code>agents/</code></li>
<li>Skill creator tool: <code>.claude/skills/skill-creator</code></li>
</ul>
<p>What would you like me to help you create or find today?</p>
</div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:42:31.039Z'>2025-11-07 10:42:31</span>
                </div>
                
                <span class='token-usage'>Input: 1 | Output: 3 | Cache Creation: 2698 | Cache Read: 19973</span>
                
            </div>
        </div>
        <div class='content markdown'><p>I'll create a senior-level skill for writing clean code with design patterns. Let me start by understanding the scope and requirements.</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01WiMgjWqa5UQYF3kBkH7zyJ">üõ†Ô∏è AskUserQuestion</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:42:33.415Z'>2025-11-07 10:42:33</span>
                </div>
                
            </div>
        </div>
        <div class='content'><table class='tool-params-table'>
            <tr>
                <td class='tool-param-key'>questions</td>
                <td class='tool-param-value'>
                        <details class='tool-param-collapsible'>
                            <summary>[
  {
    &quot;question&quot;: &quot;What programming languages should this skill focus on?&quot;,
    &quot;header&quot;: &quot;Langu...</summary>
                            <pre class='tool-param-structured'>[
  {
    &quot;question&quot;: &quot;What programming languages should this skill focus on?&quot;,
    &quot;header&quot;: &quot;Languages&quot;,
    &quot;multiSelect&quot;: true,
    &quot;options&quot;: [
      {
        &quot;label&quot;: &quot;Multi-language (Python, JavaScript, Java, Go, etc.)&quot;,
        &quot;description&quot;: &quot;Generic design patterns applicable across languages&quot;
      },
      {
        &quot;label&quot;: &quot;Language-specific&quot;,
        &quot;description&quot;: &quot;Focus on language-specific idioms and patterns (e.g., Pythonic code)&quot;
      }
    ]
  },
  {
    &quot;question&quot;: &quot;What are the primary use cases for this skill?&quot;,
    &quot;header&quot;: &quot;Use Cases&quot;,
    &quot;multiSelect&quot;: true,
    &quot;options&quot;: [
      {
        &quot;label&quot;: &quot;Code review and analysis&quot;,
        &quot;description&quot;: &quot;Reviewing existing code for design pattern improvements&quot;
      },
      {
        &quot;label&quot;: &quot;New implementation&quot;,
        &quot;description&quot;: &quot;Implementing features using design patterns from scratch&quot;
      },
      {
        &quot;label&quot;: &quot;Refactoring existing code&quot;,
        &quot;description&quot;: &quot;Improving code structure using design patterns&quot;
      },
      {
        &quot;label&quot;: &quot;Education and best practices&quot;,
        &quot;description&quot;: &quot;Teaching design patterns and clean code principles&quot;
      }
    ]
  }
]</pre>
                        </details>
                    </td>
            </tr>
        </table></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01WiMgjWqa5UQYF3kBkH7zyJ"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:18.434Z' data-duration='took 45.0s'>2025-11-07 10:43:18</span>
                </div>
                
            </div>
        </div>
        <div class='content'>
    <details class="collapsible-details">
        <summary>
            <div class="preview-content"><pre>User has answered your questions: &quot;What programming languages should this skill focus on?&quot;=&quot;Multi-language (Python, JavaScript, Java, Go, etc.)&quot;, &quot;What are the primary use cas...</pre></div>
        </summary>
        <div class="details-content">
            <pre>User has answered your questions: &quot;What programming languages should this skill focus on?&quot;=&quot;Multi-language (Python, JavaScript, Java, Go, etc.)&quot;, &quot;What are the primary use cases for this skill?&quot;=&quot;New implementation, Refactoring existing code&quot;. You can now continue with the user&#x27;s answers in mind.</pre>
        </div>
    </details>
    </div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:21.554Z'>2025-11-07 10:43:21</span>
                </div>
                
                <span class='token-usage'>Input: 3 | Output: 2 | Cache Creation: 374 | Cache Read: 22671</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Now let me create a comprehensive skill for clean code with design patterns. I'll use the TodoWrite tool to track the creation process.</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01VPb6bTGxDbN2ys4S28gLVr">üìù Todo List</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:23.168Z'>2025-11-07 10:43:23</span>
                </div>
                
            </div>
        </div>
        <div class='content'>
    <div class="todo-list">
        
                <div class="todo-item in_progress medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">üîÑ</span>
                    <span class="todo-content">Initialize skill directory structure</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item pending medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">‚è≥</span>
                    <span class="todo-content">Create SKILL.md with comprehensive design pattern guidance</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item pending medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">‚è≥</span>
                    <span class="todo-content">Create references for design patterns and best practices</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item pending medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">‚è≥</span>
                    <span class="todo-content">Create scripts for code analysis and refactoring</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item pending medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">‚è≥</span>
                    <span class="todo-content">Package the skill into distributable zip</span>
                    <span class="todo-id">#</span>
                </div>
            
    </div>
    </div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01VPb6bTGxDbN2ys4S28gLVr"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:23.297Z' data-duration='took 129 ms'>2025-11-07 10:43:23</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>Todos have been modified successfully. Ensure that you continue to use the todo list to track your progress. Please proceed with the current tasks if applicable</pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:26.352Z'>2025-11-07 10:43:26</span>
                </div>
                
                <span class='token-usage'>Input: 3 | Output: 1 | Cache Creation: 272 | Cache Read: 23045</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Let me initialize the skill using the provided script:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01C7wuHLVu28oxo2ii9mM5H7">üõ†Ô∏è Bash <span class='tool-summary'>Initialize clean-code-design-patterns skill</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:27.050Z'>2025-11-07 10:43:27</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='bash-tool-content'><pre class='bash-tool-command'>python .claude/skills/skill-creator/scripts/init_skill.py clean-code-design-patterns --path skills/</pre></div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01C7wuHLVu28oxo2ii9mM5H7"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:28.761Z' data-duration='took 1.7s'>2025-11-07 10:43:28</span>
                </div>
                
            </div>
        </div>
        <div class='content'>
    <details class="collapsible-details">
        <summary>
            <div class="preview-content"><pre>üöÄ Initializing skill: clean-code-design-patterns
   Location: skills/

‚úÖ Created skill directory: /root/Claude/claude-factory/skills/clean-code-design-patterns
‚úÖ Created SKILL.md
‚úÖ Created scripts/exa...</pre></div>
        </summary>
        <div class="details-content">
            <pre>üöÄ Initializing skill: clean-code-design-patterns
   Location: skills/

‚úÖ Created skill directory: /root/Claude/claude-factory/skills/clean-code-design-patterns
‚úÖ Created SKILL.md
‚úÖ Created scripts/example.py
‚úÖ Created references/api_reference.md
‚úÖ Created assets/example_asset.txt

‚úÖ Skill &#x27;clean-code-design-patterns&#x27; initialized successfully at /root/Claude/claude-factory/skills/clean-code-design-patterns

Next steps:
1. Edit SKILL.md to complete the TODO items and update the description
2. Customize or delete the example files in scripts/, references/, and assets/
3. Run the validator when ready to check the skill structure</pre>
        </div>
    </details>
    </div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:30.623Z'>2025-11-07 10:43:30</span>
                </div>
                
                <span class='token-usage'>Input: 3 | Output: 1 | Cache Creation: 307 | Cache Read: 23317</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Great! Now let me mark the first todo as completed and create the comprehensive SKILL.md:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_012brcAEXjpGqP8m9TNn6RyS">üìù Todo List</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:31.278Z'>2025-11-07 10:43:31</span>
                </div>
                
            </div>
        </div>
        <div class='content'>
    <div class="todo-list">
        
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Initialize skill directory structure</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item in_progress medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">üîÑ</span>
                    <span class="todo-content">Create SKILL.md with comprehensive design pattern guidance</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item pending medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">‚è≥</span>
                    <span class="todo-content">Create references for design patterns and best practices</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item pending medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">‚è≥</span>
                    <span class="todo-content">Create scripts for code analysis and refactoring</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item pending medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">‚è≥</span>
                    <span class="todo-content">Package the skill into distributable zip</span>
                    <span class="todo-id">#</span>
                </div>
            
    </div>
    </div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_012brcAEXjpGqP8m9TNn6RyS"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:31.370Z' data-duration='took 92 ms'>2025-11-07 10:43:31</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>Todos have been modified successfully. Ensure that you continue to use the todo list to track your progress. Please proceed with the current tasks if applicable</pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:33.123Z'>2025-11-07 10:43:33</span>
                </div>
                
                <span class='token-usage'>Input: 3 | Output: 6 | Cache Creation: 264 | Cache Read: 23624</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Now let me create the main SKILL.md file:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_016K7naMhLpwzVJPo4eaNCwu">üìù Write <span class='tool-summary'>/root/Claude/claude-factory/skills/clean-code-design-patterns/SKILL.md</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:48.158Z'>2025-11-07 10:43:48</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='write-tool-content'>
        <details class='collapsible-code'>
            <summary>
                <span class='line-count'>151 lines</span>
                <div class='preview-content'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>---
name: Clean Code with Design Patterns
<span class="gu">description: This skill should be used when implementing new features or refactoring existing code to apply senior-level design patterns, SOLID principles, and clean code practices. It guides the analysis, design, and implementation of code that is maintainable, scalable, and follows industry best practices across multiple programming languages.</span>
<span class="gu">---</span>
</code></pre></div></td></tr></table></div>
</div>
            </summary>
            <div class='code-full'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code>---
name: Clean Code with Design Patterns
<span class="gu">description: This skill should be used when implementing new features or refactoring existing code to apply senior-level design patterns, SOLID principles, and clean code practices. It guides the analysis, design, and implementation of code that is maintainable, scalable, and follows industry best practices across multiple programming languages.</span>
<span class="gu">---</span>

<span class="gh"># Clean Code with Design Patterns</span>

<span class="gu">## Purpose</span>

This skill provides senior-level guidance for writing clean, maintainable code using proven design patterns and architectural principles. It helps analyze code quality, identify architectural improvements, and implement solutions that follow SOLID principles, Gang of Four patterns, and modern best practices.

<span class="gu">## When to Use This Skill</span>

Use this skill when:

<span class="k">-</span><span class="w"> </span><span class="gs">**Implementing new features**</span> - Ensuring new code follows design patterns from the start
<span class="k">-</span><span class="w"> </span><span class="gs">**Refactoring existing code**</span> - Identifying and applying patterns to improve structure and maintainability
<span class="k">-</span><span class="w"> </span><span class="gs">**Code review**</span> - Assessing code against clean code standards and design pattern best practices
<span class="k">-</span><span class="w"> </span><span class="gs">**Architecture decisions**</span> - Selecting appropriate patterns for scalability and maintainability
<span class="k">-</span><span class="w"> </span><span class="gs">**Multi-language projects**</span> - Applying language-agnostic principles with language-specific idioms

<span class="gu">## How to Use This Skill</span>

<span class="gu">### Phase 1: Analysis and Assessment</span>

Before making implementation decisions, conduct a thorough analysis:

<span class="k">1.</span> <span class="gs">**Understand the Context**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Identify the problem domain and requirements
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Determine current pain points and technical debt
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Consider system constraints and performance needs
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Map existing architecture and dependencies

<span class="k">2.</span> <span class="gs">**Assess Code Quality**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Review for SOLID principle violations (see <span class="sb">`references/solid_principles.md`</span>)
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Identify code smells (long methods, large classes, tight coupling)
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Check for missing abstractions and violations of DRY principle
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Evaluate testability and dependency injection patterns

<span class="k">3.</span> <span class="gs">**Pattern Selection**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Reference <span class="sb">`references/design_patterns_guide.md`</span> for pattern catalog
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Consider the specific language&#39;s idiomatic approach
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Evaluate trade-offs: complexity vs. maintainability
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Ensure pattern fits the problem (avoid over-engineering)

<span class="gu">### Phase 2: Design and Planning</span>

<span class="k">1.</span> <span class="gs">**Create Abstraction Layers**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Define clear interfaces and contracts
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Separate concerns (business logic, data access, presentation)
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Use composition over inheritance
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Consider the principle of least surprise

<span class="k">2.</span> <span class="gs">**Plan Dependency Management**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Identify dependencies early
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Design for dependency injection
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Plan for testability from the start
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Consider lifecycle management (singleton, transient, scoped)

<span class="k">3.</span> <span class="gs">**Document Design Decisions**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Record which patterns are applied and why
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Document assumptions and constraints
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Include rationale for architectural choices

<span class="gu">### Phase 3: Implementation</span>

<span class="k">1.</span> <span class="gs">**Apply Patterns Consistently**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Reference <span class="sb">`references/clean_code_checklist.md`</span> during implementation
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Follow the language-specific idioms while applying patterns
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Use descriptive naming that reveals intent
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Keep methods and classes small and focused

<span class="k">2.</span> <span class="gs">**Build for Testability**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Design with testing in mind from the start
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Inject dependencies to enable mocking
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Create small, testable units
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Avoid tight coupling to infrastructure

<span class="k">3.</span> <span class="gs">**Maintain SOLID Principles**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span><span class="gs">**S**</span>ingle Responsibility: One reason to change per class/function
<span class="w">   </span><span class="k">-</span><span class="w"> </span><span class="gs">**O**</span>pen/Closed: Open for extension, closed for modification
<span class="w">   </span><span class="k">-</span><span class="w"> </span><span class="gs">**L**</span>iskov Substitution: Derived types must be substitutable
<span class="w">   </span><span class="k">-</span><span class="w"> </span><span class="gs">**I**</span>nterface Segregation: Segregate fat interfaces
<span class="w">   </span><span class="k">-</span><span class="w"> </span><span class="gs">**D**</span>ependency Inversion: Depend on abstractions, not concretions

<span class="gu">### Phase 4: Review and Refinement</span>

<span class="k">1.</span> <span class="gs">**Validate Against Patterns**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Ensure pattern implementation is correct
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Check for anti-patterns and violations
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Verify abstraction layers are clean

<span class="k">2.</span> <span class="gs">**Code Quality Checks**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Complexity metrics: McCabe complexity, cognitive complexity
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Test coverage: Aim for meaningful coverage (70%+)
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Readability: Can a new team member understand it?
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Performance: Have you optimized after profiling?

<span class="k">3.</span> <span class="gs">**Document and Communicate**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Add inline comments for non-obvious logic
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Create architecture diagrams where helpful
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Document public APIs and contracts
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Share design rationale with team

<span class="gu">## Key Principles to Remember</span>

<span class="gu">### Clean Code Foundations</span>
<span class="k">-</span><span class="w"> </span><span class="gs">**Meaningful Names**</span>: Variables, functions, and classes should clearly express intent
<span class="k">-</span><span class="w"> </span><span class="gs">**Functions Should Do One Thing**</span>: Keep methods focused and small (&lt; 20 lines ideal)
<span class="k">-</span><span class="w"> </span><span class="gs">**DRY (Don&#39;t Repeat Yourself)**</span>: Extract common logic into reusable components
<span class="k">-</span><span class="w"> </span><span class="gs">**Error Handling**</span>: Handle errors explicitly, use typed exceptions
<span class="k">-</span><span class="w"> </span><span class="gs">**Comments**</span>: Write code that&#39;s self-explanatory; comments explain why, not what

<span class="gu">### Design Patterns to Prioritize</span>
<span class="k">-</span><span class="w"> </span><span class="gs">**Dependency Injection**</span>: Enables testing and loose coupling
<span class="k">-</span><span class="w"> </span><span class="gs">**Strategy Pattern**</span>: Varies algorithms at runtime
<span class="k">-</span><span class="w"> </span><span class="gs">**Factory Pattern**</span>: Encapsulates object creation
<span class="k">-</span><span class="w"> </span><span class="gs">**Observer Pattern**</span>: Decouples event handling
<span class="k">-</span><span class="w"> </span><span class="gs">**Repository Pattern**</span>: Abstracts data access
<span class="k">-</span><span class="w"> </span><span class="gs">**Adapter Pattern**</span>: Makes incompatible interfaces work together
<span class="k">-</span><span class="w"> </span><span class="gs">**Decorator Pattern**</span>: Adds behavior without modifying originals

<span class="gu">### Language-Specific Considerations</span>
<span class="k">-</span><span class="w"> </span>Apply language idioms alongside patterns
<span class="k">-</span><span class="w"> </span>Consider performance implications in your language
<span class="k">-</span><span class="w"> </span>Use built-in language features to simplify patterns
<span class="k">-</span><span class="w"> </span>Follow the ecosystem&#39;s conventions and standards
<span class="k">-</span><span class="w"> </span>Leverage type systems (if available) for safety

<span class="gu">## Common Pitfalls to Avoid</span>

<span class="k">-</span><span class="w"> </span><span class="gs">**Over-engineering**</span>: Using patterns for trivial problems
<span class="k">-</span><span class="w"> </span><span class="gs">**Pattern Mixing**</span>: Combining incompatible patterns carelessly
<span class="k">-</span><span class="w"> </span><span class="gs">**Ignoring Context**</span>: Applying patterns without understanding the specific problem
<span class="k">-</span><span class="w"> </span><span class="gs">**Premature Optimization**</span>: Optimize after measuring, not before
<span class="k">-</span><span class="w"> </span><span class="gs">**Insufficient Testing**</span>: Design without considering testability
<span class="k">-</span><span class="w"> </span><span class="gs">**Poor Naming**</span>: Sacrificing clarity for brevity
<span class="k">-</span><span class="w"> </span><span class="gs">**God Objects**</span>: Classes that do too much
<span class="k">-</span><span class="w"> </span><span class="gs">**Feature Envy**</span>: Methods that use another object&#39;s internals excessively

<span class="gu">## Resources</span>

Reference the following detailed guides:

<span class="k">-</span><span class="w"> </span><span class="sb">`references/design_patterns_guide.md`</span> - Comprehensive catalog of patterns with implementation examples
<span class="k">-</span><span class="w"> </span><span class="sb">`references/solid_principles.md`</span> - Detailed explanation of SOLID principles
<span class="k">-</span><span class="w"> </span><span class="sb">`references/clean_code_checklist.md`</span> - Checklist for evaluating code quality
<span class="k">-</span><span class="w"> </span><span class="sb">`references/refactoring_strategies.md`</span> - Techniques for safely improving existing code

Use <span class="sb">`scripts/code_analyzer.py`</span> for automated analysis of code quality and pattern recommendations.
</code></pre></div></td></tr></table></div>
</div>
        </details>
        </div></div>
    </div>
    
    
    
    
    <div class='message tool_result error paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_016K7naMhLpwzVJPo4eaNCwu">üö® Error</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:48.225Z' data-duration='took 67 ms'>2025-11-07 10:43:48</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>File has not been read yet. Read it first before writing to it.</pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:50.907Z'>2025-11-07 10:43:50</span>
                </div>
                
                <span class='token-usage'>Input: 4 | Output: 1 | Cache Creation: 1659 | Cache Read: 23888</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Let me read the file first:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_019PShCmHPNQKJM6qf8JW3Wa">üìÑ Read <span class='tool-summary'>/root/Claude/claude-factory/skills/clean-code-design-patterns/SKILL.md</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:51.640Z'>2025-11-07 10:43:51</span>
                </div>
                
            </div>
        </div>
        <div class='content'></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_019PShCmHPNQKJM6qf8JW3Wa"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:51.740Z' data-duration='took 100 ms'>2025-11-07 10:43:51</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='read-tool-result'>
                <details class='collapsible-code'>
                    <summary>
                        <span class='line-count'>86 lines</span>
                        <div class='preview-content'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>---
name: clean-code-design-patterns
<span class="gu">description: [TODO: Complete and informative explanation of what the skill does and when to use it. Include WHEN to use this skill - specific scenarios, file types, or tasks that trigger it.]</span>
<span class="gu">---</span>
</code></pre></div></td></tr></table></div>
</div>
                    </summary>
                    <div class='code-full'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code>---
name: clean-code-design-patterns
<span class="gu">description: [TODO: Complete and informative explanation of what the skill does and when to use it. Include WHEN to use this skill - specific scenarios, file types, or tasks that trigger it.]</span>
<span class="gu">---</span>

<span class="gh"># Clean Code Design Patterns</span>

<span class="gu">## Overview</span>

[TODO: 1-2 sentences explaining what this skill enables]

<span class="gu">## Structuring This Skill</span>

[TODO: Choose the structure that best fits this skill&#39;s purpose. Common patterns:

<span class="gs">**1. Workflow-Based**</span> (best for sequential processes)
<span class="k">-</span><span class="w"> </span>Works well when there are clear step-by-step procedures
<span class="k">-</span><span class="w"> </span>Example: DOCX skill with &quot;Workflow Decision Tree&quot; ‚Üí &quot;Reading&quot; ‚Üí &quot;Creating&quot; ‚Üí &quot;Editing&quot;
<span class="k">-</span><span class="w"> </span>Structure: ## Overview ‚Üí ## Workflow Decision Tree ‚Üí ## Step 1 ‚Üí ## Step 2...

<span class="gs">**2. Task-Based**</span> (best for tool collections)
<span class="k">-</span><span class="w"> </span>Works well when the skill offers different operations/capabilities
<span class="k">-</span><span class="w"> </span>Example: PDF skill with &quot;Quick Start&quot; ‚Üí &quot;Merge PDFs&quot; ‚Üí &quot;Split PDFs&quot; ‚Üí &quot;Extract Text&quot;
<span class="k">-</span><span class="w"> </span>Structure: ## Overview ‚Üí ## Quick Start ‚Üí ## Task Category 1 ‚Üí ## Task Category 2...

<span class="gs">**3. Reference/Guidelines**</span> (best for standards or specifications)
<span class="k">-</span><span class="w"> </span>Works well for brand guidelines, coding standards, or requirements
<span class="k">-</span><span class="w"> </span>Example: Brand styling with &quot;Brand Guidelines&quot; ‚Üí &quot;Colors&quot; ‚Üí &quot;Typography&quot; ‚Üí &quot;Features&quot;
<span class="k">-</span><span class="w"> </span>Structure: ## Overview ‚Üí ## Guidelines ‚Üí ## Specifications ‚Üí ## Usage...

<span class="gs">**4. Capabilities-Based**</span> (best for integrated systems)
<span class="k">-</span><span class="w"> </span>Works well when the skill provides multiple interrelated features
<span class="k">-</span><span class="w"> </span>Example: Product Management with &quot;Core Capabilities&quot; ‚Üí numbered capability list
<span class="k">-</span><span class="w"> </span>Structure: ## Overview ‚Üí ## Core Capabilities ‚Üí ### 1. Feature ‚Üí ### 2. Feature...

Patterns can be mixed and matched as needed. Most skills combine patterns (e.g., start with task-based, add workflow for complex operations).

Delete this entire &quot;Structuring This Skill&quot; section when done - it&#39;s just guidance.]

<span class="gu">## [TODO: Replace with the first main section based on chosen structure]</span>

[TODO: Add content here. See examples in existing skills:
<span class="k">-</span><span class="w"> </span>Code samples for technical skills
<span class="k">-</span><span class="w"> </span>Decision trees for complex workflows
<span class="k">-</span><span class="w"> </span>Concrete examples with realistic user requests
<span class="k">-</span><span class="w"> </span>References to scripts/templates/references as needed]

<span class="gu">## Resources</span>

This skill includes example resource directories that demonstrate how to organize different types of bundled resources:

<span class="gu">### scripts/</span>
Executable code (Python/Bash/etc.) that can be run directly to perform specific operations.

<span class="gs">**Examples from other skills:**</span>
<span class="k">-</span><span class="w"> </span>PDF skill: <span class="sb">`fill_fillable_fields.py`</span>, <span class="sb">`extract_form_field_info.py`</span> - utilities for PDF manipulation
<span class="k">-</span><span class="w"> </span>DOCX skill: <span class="sb">`document.py`</span>, <span class="sb">`utilities.py`</span> - Python modules for document processing

<span class="gs">**Appropriate for:**</span> Python scripts, shell scripts, or any executable code that performs automation, data processing, or specific operations.

<span class="gs">**Note:**</span> Scripts may be executed without loading into context, but can still be read by Claude for patching or environment adjustments.

<span class="gu">### references/</span>
Documentation and reference material intended to be loaded into context to inform Claude&#39;s process and thinking.

<span class="gs">**Examples from other skills:**</span>
<span class="k">-</span><span class="w"> </span>Product management: <span class="sb">`communication.md`</span>, <span class="sb">`context_building.md`</span> - detailed workflow guides
<span class="k">-</span><span class="w"> </span>BigQuery: API reference documentation and query examples
<span class="k">-</span><span class="w"> </span>Finance: Schema documentation, company policies

<span class="gs">**Appropriate for:**</span> In-depth documentation, API references, database schemas, comprehensive guides, or any detailed information that Claude should reference while working.

<span class="gu">### assets/</span>
Files not intended to be loaded into context, but rather used within the output Claude produces.

<span class="gs">**Examples from other skills:**</span>
<span class="k">-</span><span class="w"> </span>Brand styling: PowerPoint template files (.pptx), logo files
<span class="k">-</span><span class="w"> </span>Frontend builder: HTML/React boilerplate project directories
<span class="k">-</span><span class="w"> </span>Typography: Font files (.ttf, .woff2)

<span class="gs">**Appropriate for:**</span> Templates, boilerplate code, document templates, images, icons, fonts, or any files meant to be copied or used in the final output.

---

<span class="gs">**Any unneeded directories can be deleted.**</span> Not every skill requires all three types of resources.
</code></pre></div></td></tr></table></div>
</div>
                </details>
                <div class='system-reminder'>ü§ñ <em>Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.</em></div></div></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:43:54.621Z'>2025-11-07 10:43:54</span>
                </div>
                
                <span class='token-usage'>Input: 3 | Output: 2 | Cache Creation: 1382 | Cache Read: 25547</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Now let me write the comprehensive SKILL.md:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01Q6fc3m28Kvp6PG1vrFT5Pn">üìù Edit <span class='tool-summary'>/root/Claude/claude-factory/skills/clean-code-design-patterns/SKILL.md</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:44:20.691Z'>2025-11-07 10:44:20</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='edit-tool-content'><div class='edit-diff'><div class='diff-line diff-context'><span class='diff-marker'> </span>---</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>name: <mark class='diff-char-removed'>c</mark>lean<mark class='diff-char-removed'>-c</mark>ode<mark class='diff-char-removed'>-d</mark>esign<mark class='diff-char-removed'>-p</mark>atterns</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>name: <mark class='diff-char-added'>C</mark>lean<mark class='diff-char-added'> C</mark>ode<mark class='diff-char-added'> with D</mark>esign<mark class='diff-char-added'> P</mark>atterns</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>description: <mark class='diff-char-removed'>[</mark>T<mark class='diff-char-removed'>ODO: Complete and informative explanation of</mark> wh<mark class='diff-char-removed'>at</mark> th<mark class='diff-char-removed'>e skill does and </mark>w<mark class='diff-char-removed'>hen to use it</mark>.<mark class='diff-char-removed'> Include WHEN to use this skill - specific scenarios, file types, or tasks that trigger it.]</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>description: T<mark class='diff-char-added'>his skill should be used</mark> wh<mark class='diff-char-added'>en implementing new features or refactoring existing code to apply senior-level design patterns, SOLID principles, and clean code practices. It guides analysis, design, and implementation of code</mark> th<mark class='diff-char-added'>at is maintainable, scalable, and follo</mark>w<mark class='diff-char-added'>s industry best practices across multiple programming languages</mark>.</div><div class='diff-line diff-context'><span class='diff-marker'> </span>---</div><div class='diff-line diff-context'><span class='diff-marker'> </span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span># Clean Code Design Patterns</div><div class='diff-line diff-added'><span class='diff-marker'>+</span># Clean Code<mark class='diff-char-added'> with</mark> Design Patterns</div><div class='diff-line diff-context'><span class='diff-marker'> </span></div><div class='diff-line diff-context'><span class='diff-marker'> </span>## Overview</div><div class='diff-line diff-context'><span class='diff-marker'> </span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span><mark class='diff-char-removed'>[</mark>TOD<mark class='diff-char-removed'>O: 1-2 sentences explaining w</mark>hat <mark class='diff-char-removed'>this skill ena</mark>b<mark class='diff-char-removed'>les]</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>T<mark class='diff-char-added'>his skill provides senior-level guidance for writing clean, maintainable code using proven design patterns and architectural principles. It enables engineers to analyze code quality, identify architectural improvements, apply S</mark>O<mark class='diff-char-added'>LI</mark>D<mark class='diff-char-added'> principles, and implement solutions t</mark>hat <mark class='diff-char-added'>use Gang of Four patterns and modern </mark>b<mark class='diff-char-added'>est practices.</mark></div><div class='diff-line diff-context'><span class='diff-marker'> </span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>## <mark class='diff-char-removed'>S</mark>t<mark class='diff-char-removed'>ructuring</mark> This Skill</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>## <mark class='diff-char-added'>When </mark>t<mark class='diff-char-added'>o Use</mark> This Skill</div><div class='diff-line diff-context'><span class='diff-marker'> </span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span><mark class='diff-char-removed'>[TODO: Choo</mark>se<mark class='diff-char-removed'> the structure that best fits</mark> this skill<mark class='diff-char-removed'>&#x27;s</mark> <mark class='diff-char-removed'>purpos</mark>e<mark class='diff-char-removed'>. Commo</mark>n<mark class='diff-char-removed'> patterns</mark>:</div><div class='diff-line diff-added'><span class='diff-marker'>+</span><mark class='diff-char-added'>U</mark>se this skill <mark class='diff-char-added'>wh</mark>en:</div><div class='diff-line diff-context'><span class='diff-marker'> </span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>**<mark class='diff-char-removed'>1. Workf</mark>l<mark class='diff-char-removed'>ow-Bas</mark>e<mark class='diff-char-removed'>d** (best for sequ</mark>ential pro<mark class='diff-char-removed'>c</mark>es<mark class='diff-char-removed'>ses)</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span><mark class='diff-char-added'>- </mark>**<mark class='diff-char-added'>Imp</mark>le<mark class='diff-char-added'>m</mark>enti<mark class='diff-char-added'>ng new fe</mark>a<mark class='diff-char-added'>tures** - Ensuring new code fo</mark>l<mark class='diff-char-added'>lows design</mark> p<mark class='diff-char-added'>atterns f</mark>ro<mark class='diff-char-added'>m th</mark>e<mark class='diff-char-added'> </mark>s<mark class='diff-char-added'>tart</mark></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- <mark class='diff-char-removed'>W</mark>or<mark class='diff-char-removed'>k</mark>s <mark class='diff-char-removed'>w</mark>e<mark class='diff-char-removed'>ll</mark> <mark class='diff-char-removed'>when </mark>t<mark class='diff-char-removed'>he</mark>re a<mark class='diff-char-removed'>re</mark> <mark class='diff-char-removed'>c</mark>l<mark class='diff-char-removed'>ear s</mark>t<mark class='diff-char-removed'>ep-b</mark>y<mark class='diff-char-removed'>-step procedures</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- <mark class='diff-char-added'>**Refact</mark>or<mark class='diff-char-added'>ing existing code** - Identifying and applying pattern</mark>s <mark class='diff-char-added'>to improv</mark>e <mark class='diff-char-added'>s</mark>t<mark class='diff-char-added'>ructu</mark>re a<mark class='diff-char-added'>nd</mark> <mark class='diff-char-added'>maintainabi</mark>l<mark class='diff-char-added'>i</mark>ty</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- E<mark class='diff-char-removed'>x</mark>a<mark class='diff-char-removed'>mp</mark>l<mark class='diff-char-removed'>e: DOCX skill with &quot;Workflow Decision Tree&quot; ‚Üí &quot;Reading&quot; ‚Üí &quot;Cre</mark>ating<mark class='diff-char-removed'>&quot;</mark> <mark class='diff-char-removed'>‚Üí</mark> <mark class='diff-char-removed'>&quot;E</mark>d<mark class='diff-char-removed'>i</mark>ti<mark class='diff-char-removed'>ng&quot;</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span><mark class='diff-char-added'>- **Code review and assessment** </mark>- E<mark class='diff-char-added'>v</mark>al<mark class='diff-char-added'>u</mark>ating <mark class='diff-char-added'>code</mark> <mark class='diff-char-added'>against clean co</mark>d<mark class='diff-char-added'>e standards and best prac</mark>ti<mark class='diff-char-added'>ces</mark></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- <mark class='diff-char-removed'>S</mark>t<mark class='diff-char-removed'>ru</mark>cture<mark class='diff-char-removed'>:</mark> <mark class='diff-char-removed'>## Overview ‚Üí ## Workflow D</mark>ecision <mark class='diff-char-removed'>T</mark>r<mark class='diff-char-removed'>e</mark>e <mark class='diff-char-removed'>‚Üí ## S</mark>te<mark class='diff-char-removed'>p</mark> <mark class='diff-char-removed'>1</mark> <mark class='diff-char-removed'>‚Üí</mark> <mark class='diff-char-removed'>##</mark> <mark class='diff-char-removed'>S</mark>t<mark class='diff-char-removed'>ep 2...</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- <mark class='diff-char-added'>**Archi</mark>t<mark class='diff-char-added'>e</mark>cture <mark class='diff-char-added'>d</mark>ecision<mark class='diff-char-added'>s**</mark> <mark class='diff-char-added'>- Selecting app</mark>r<mark class='diff-char-added'>opriat</mark>e <mark class='diff-char-added'>pat</mark>te<mark class='diff-char-added'>rns</mark> <mark class='diff-char-added'>for</mark> <mark class='diff-char-added'>scalability</mark> <mark class='diff-char-added'>and</mark> <mark class='diff-char-added'>main</mark>t<mark class='diff-char-added'>ainability</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Working across languages** - Applying language-agnostic principles with language-specific idioms</div><div class='diff-line diff-context'><span class='diff-marker'> </span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>## The Clean Code Workflow</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>**2. Task-Based** (best for tool collections)</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Works well when the skill offers different operations/capabilities</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Example: PDF skill with &quot;Quick Start&quot; ‚Üí &quot;Merge PDFs&quot; ‚Üí &quot;Split PDFs&quot; ‚Üí &quot;Extract Text&quot;</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Structure: ## Overview ‚Üí ## Quick Start ‚Üí ## Task Category 1 ‚Üí ## Task Category 2...</div><div class='diff-line diff-context'><span class='diff-marker'> </span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>### Phase 1: Analysis and Assessment</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>**3. Reference/Guidelines** (best for standards or specifications)</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Works well for brand guidelines, coding standards, or requirements</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Example: Brand styling with &quot;Brand Guidelines&quot; ‚Üí &quot;Colors&quot; ‚Üí &quot;Typography&quot; ‚Üí &quot;Features&quot;</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Structure: ## Overview ‚Üí ## Guidelines ‚Üí ## Specifications ‚Üí ## Usage...</div><div class='diff-line diff-context'><span class='diff-marker'> </span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>Before making implementation decisions, conduct thorough analysis:</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>**4. Capabilities-Based** (best for integrated systems)</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Works well when the skill provides multiple interrelated features</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Example: Product Management with &quot;Core Capabilities&quot; ‚Üí numbered capability list</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Structure: ## Overview ‚Üí ## Core Capabilities ‚Üí ### 1. Feature ‚Üí ### 2. Feature...</div><div class='diff-line diff-context'><span class='diff-marker'> </span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span><mark class='diff-char-removed'>Patt</mark>er<mark class='diff-char-removed'>n</mark>s<mark class='diff-char-removed'> can be mixed </mark>and <mark class='diff-char-removed'>ma</mark>t<mark class='diff-char-removed'>c</mark>he<mark class='diff-char-removed'>d</mark> <mark class='diff-char-removed'>as </mark>n<mark class='diff-char-removed'>eeded. Most skills combine pat</mark>te<mark class='diff-char-removed'>rns (e.g., s</mark>t<mark class='diff-char-removed'>art with task-based, add workflow for complex operations).</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span><mark class='diff-char-added'>1. **Und</mark>ers<mark class='diff-char-added'>t</mark>and the <mark class='diff-char-added'>Co</mark>nte<mark class='diff-char-added'>x</mark>t<mark class='diff-char-added'>**</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Identify problem domain and requirements</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Determine current pain points and technical debt</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Consider system constraints and performance needs</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Map existing architecture and dependencies</div><div class='diff-line diff-context'><span class='diff-marker'> </span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span><mark class='diff-char-removed'>D</mark>e<mark class='diff-char-removed'>let</mark>e <mark class='diff-char-removed'>this entire &quot;Str</mark>u<mark class='diff-char-removed'>cturing This Ski</mark>l<mark class='diff-char-removed'>l&quot; section when done - </mark>it<mark class='diff-char-removed'>&#x27;</mark>s<mark class='diff-char-removed'> j</mark>us<mark class='diff-char-removed'>t guidance.]</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span><mark class='diff-char-added'>2. **Ass</mark>e<mark class='diff-char-added'>ss Cod</mark>e <mark class='diff-char-added'>Q</mark>u<mark class='diff-char-added'>a</mark>lit<mark class='diff-char-added'>y I</mark>s<mark class='diff-char-added'>s</mark>u<mark class='diff-char-added'>e</mark>s<mark class='diff-char-added'>**</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Review for SOLID principle violations (reference `references/solid_principles.md`)</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Identify code smells: long methods, large classes, tight coupling, duplicate code</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Check for missing abstractions and violations of DRY (Don&#x27;t Repeat Yourself)</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Evaluate testability and current dependency injection approach</div><div class='diff-line diff-context'><span class='diff-marker'> </span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span><mark class='diff-char-removed'>##</mark> <mark class='diff-char-removed'>[TODO: R</mark>e<mark class='diff-char-removed'>p</mark>l<mark class='diff-char-removed'>ace with the first main s</mark>ecti<mark class='diff-char-removed'>o</mark>n<mark class='diff-char-removed'> ba</mark>s<mark class='diff-char-removed'>ed on chosen structure]</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span><mark class='diff-char-added'>3.</mark> <mark class='diff-char-added'>**S</mark>elect<mark class='diff-char-added'> Appropr</mark>i<mark class='diff-char-added'>ate Patter</mark>ns<mark class='diff-char-added'>**</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Reference `references/design_patterns_guide.md` for the pattern catalog</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Consider language-specific idioms and conventions</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Evaluate complexity vs. maintainability trade-offs</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Validate pattern fits the specific problem (avoid over-engineering simple solutions)</div><div class='diff-line diff-context'><span class='diff-marker'> </span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span><mark class='diff-char-removed'>[TODO</mark>: <mark class='diff-char-removed'>Ad</mark>d <mark class='diff-char-removed'>co</mark>n<mark class='diff-char-removed'>te</mark>n<mark class='diff-char-removed'>t here. See examples in exist</mark>ing<mark class='diff-char-removed'> skills:</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span><mark class='diff-char-added'>### Phase 2</mark>: <mark class='diff-char-added'>Design an</mark>d <mark class='diff-char-added'>Pla</mark>nning</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span><mark class='diff-char-removed'>- Code samples for technical skills</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span><mark class='diff-char-removed'>-</mark> <mark class='diff-char-removed'>D</mark>ec<mark class='diff-char-removed'>is</mark>ion <mark class='diff-char-removed'>t</mark>r<mark class='diff-char-removed'>ee</mark>s<mark class='diff-char-removed'> for complex workflows</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span><mark class='diff-char-added'>1.</mark> <mark class='diff-char-added'>**Cr</mark>e<mark class='diff-char-added'>ate Clear Abstra</mark>c<mark class='diff-char-added'>t</mark>ion <mark class='diff-char-added'>Laye</mark>rs<mark class='diff-char-added'>**</mark></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- <mark class='diff-char-removed'>Co</mark>n<mark class='diff-char-removed'>cret</mark>e ex<mark class='diff-char-removed'>am</mark>ples <mark class='diff-char-removed'>wi</mark>t<mark class='diff-char-removed'>h </mark>r<mark class='diff-char-removed'>e</mark>a<mark class='diff-char-removed'>listi</mark>c<mark class='diff-char-removed'> user reques</mark>ts</div><div class='diff-line diff-added'><span class='diff-marker'>+</span><mark class='diff-char-added'>   </mark>- <mark class='diff-char-added'>Defi</mark>ne expl<mark class='diff-char-added'>icit interfac</mark>es <mark class='diff-char-added'>and con</mark>tracts</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- <mark class='diff-char-removed'>R</mark>e<mark class='diff-char-removed'>f</mark>e<mark class='diff-char-removed'>re</mark>nces <mark class='diff-char-removed'>t</mark>o <mark class='diff-char-removed'>scripts/templ</mark>at<mark class='diff-char-removed'>es/referen</mark>ces as<mark class='diff-char-removed'> n</mark>e<mark class='diff-char-removed'>eded]</mark></div><div class='diff-line diff-added'><span class='diff-marker'>+</span><mark class='diff-char-added'>   </mark>- <mark class='diff-char-added'>S</mark>e<mark class='diff-char-added'>parat</mark>e<mark class='diff-char-added'> co</mark>nce<mark class='diff-char-added'>rns: busines</mark>s <mark class='diff-char-added'>l</mark>o<mark class='diff-char-added'>gic,</mark> <mark class='diff-char-added'>d</mark>at<mark class='diff-char-added'>a ac</mark>ces<mark class='diff-char-added'>s,</mark> <mark class='diff-char-added'>presentation, infr</mark>as<mark class='diff-char-added'>tructur</mark>e</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Favor composition over inheritance</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Follow principle of least surprise</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>2. **Plan Dependency Management**</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Identify all dependencies early</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Design for dependency injection from the start</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Plan for testability and mocking</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Consider lifecycle management (singleton, transient, scoped)</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>3. **Document Design Decisions**</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Record which patterns are being applied and why</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Document assumptions and constraints</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Include rationale for architectural choices</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Make trade-offs explicit</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>### Phase 3: Implementation</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>1. **Apply Patterns Consistently**</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Reference `references/clean_code_checklist.md` during implementation</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Follow language idioms while applying patterns</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Use descriptive naming that reveals intent</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Keep methods and classes small and focused (single responsibility)</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>2. **Build for Testability**</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Design with testing as a first-class concern</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Inject dependencies to enable mocking</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Create small, testable units</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Avoid tight coupling to infrastructure layers</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>3. **Maintain SOLID Principles Throughout**</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - **S**ingle Responsibility: One reason to change per class/module</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - **O**pen/Closed: Open for extension, closed for modification</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - **L**iskov Substitution: Derived types must be substitutable for base types</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - **I**nterface Segregation: Segregate fat interfaces into smaller, focused ones</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - **D**ependency Inversion: Depend on abstractions, not concrete implementations</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>### Phase 4: Review and Refinement</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>1. **Validate Pattern Implementation**</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Ensure pattern is correctly applied</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Check for anti-patterns and violations</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Verify abstraction layers are clean and well-defined</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>2. **Perform Code Quality Checks**</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Complexity metrics: McCabe complexity, cognitive complexity</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Test coverage: Aim for meaningful coverage (70%+)</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Readability: Can a new team member understand it?</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Performance: Optimize after profiling, not prematurely</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>3. **Document and Communicate**</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Add inline comments only for non-obvious logic (let code be self-documenting)</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Create architecture diagrams where helpful</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Document public APIs and contracts</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>   - Share design rationale with team</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>## Core Clean Code Principles</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>### 1. Meaningful Names</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Variables, functions, and classes should clearly express intent</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Use pronounceable, searchable names</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Avoid misleading hints or abbreviations</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Use domain language from the business</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>### 2. Functions Should Do One Thing</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Keep methods focused and small (&lt;20 lines ideal)</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- If a function needs comments to explain &quot;what&quot; it does, split it</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Use clear, expressive names to replace comments</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Extract helper functions ruthlessly</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>### 3. DRY (Don&#x27;t Repeat Yourself)</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Extract common logic into reusable components</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Use inheritance and composition to eliminate duplication</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Consider templates and patterns to reduce boilerplate</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Be wary of accidental duplication in structure</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>### 4. Error Handling</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Handle errors explicitly, don&#x27;t silently swallow them</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Use typed exceptions when available</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Provide context in error messages</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Create exception hierarchies that make sense</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>### 5. Comments and Documentation</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Write self-explanatory code; comments explain &quot;why&quot;, not &quot;what&quot;</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Remove commented-out code (version control handles history)</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Keep documentation synchronized with code changes</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- Use types and tests as documentation</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>## Key Design Patterns to Apply</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>### Structural Patterns</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Adapter**: Makes incompatible interfaces work together</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Bridge**: Separates abstraction from implementation</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Decorator**: Adds behavior without modifying originals</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Facade**: Simplifies complex subsystem interfaces</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>### Behavioral Patterns</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Strategy**: Encapsulates algorithms for runtime selection</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Observer**: Decouples event handling and notification</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Template Method**: Defines algorithm skeleton in base class</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Chain of Responsibility**: Passes requests along a chain of handlers</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>### Creational Patterns</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Factory**: Encapsulates object creation logic</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Builder**: Constructs complex objects step-by-step</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Dependency Injection**: Provides dependencies externally</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>### Architectural Patterns</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Repository**: Abstracts data access logic</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Service Layer**: Encapsulates business logic</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **MVC/MVP**: Separates concerns in user-facing code</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Hexagonal (Ports &amp; Adapters)**: Isolates business logic from infrastructure</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>## Language-Specific Considerations</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>Apply design patterns alongside language idioms:</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Python**: Use properties, decorators, and context managers; follow PEP 8</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **JavaScript/TypeScript**: Leverage prototypes, higher-order functions, async patterns</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Java**: Use generics, annotations, and stream APIs</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Go**: Favor composition, use interfaces for abstraction</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **C#**: Use properties, LINQ, and async/await patterns</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>Consider language performance characteristics when applying patterns. Use built-in features to simplify pattern implementation.</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>## Common Pitfalls to Avoid</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Over-engineering**: Using sophisticated patterns for trivial problems</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Pattern Mixing**: Combining incompatible patterns without understanding interactions</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Ignoring Context**: Blindly applying patterns without understanding the specific domain</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Premature Optimization**: Optimize after measuring performance, not before</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Insufficient Testing**: Designing without considering testability from the start</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Poor Naming**: Sacrificing clarity for brevity</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **God Objects**: Classes that accumulate too many responsibilities</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Feature Envy**: Methods that access another object&#x27;s internals excessively</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- **Inappropriate Abstraction**: Creating abstractions too early or for single use cases</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>## Practical Implementation Approach</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>When refactoring or implementing:</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>1. Start with understanding: What is the code trying to accomplish?</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>2. Identify violations: Which SOLID principles are violated?</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>3. Select patterns: What patterns would help?</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>4. Plan changes: What&#x27;s the safest sequence of changes?</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>5. Implement incrementally: Make small, testable changes</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>6. Verify coverage: Ensure tests cover the new behavior</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>7. Review and document: Share design decisions with team</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>## Resources and References</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- `references/design_patterns_guide.md` - Comprehensive pattern catalog with implementation examples and trade-offs</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- `references/solid_principles.md` - Deep dive into SOLID principles with examples for each</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- `references/clean_code_checklist.md` - Practical checklist for evaluating code quality</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>- `references/refactoring_strategies.md` - Safe techniques for improving existing code</div><div class='diff-line diff-added'><span class='diff-marker'>+</span></div><div class='diff-line diff-added'><span class='diff-marker'>+</span>Use `scripts/code_analyzer.py` for automated analysis of code quality metrics and pattern recommendations.</div></div></div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01Q6fc3m28Kvp6PG1vrFT5Pn"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:44:20.994Z' data-duration='took 303 ms'>2025-11-07 10:44:20</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='edit-tool-result'>
                <details class='collapsible-code'>
                    <summary>
                        <span class='line-count'>210 lines</span>
                        <div class='preview-content'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>---
name: Clean Code with Design Patterns
<span class="gu">description: This skill should be used when implementing new features or refactoring existing code to apply senior-level design patterns, SOLID principles, and clean code practices. It guides analysis, design, and implementation of code that is maintainable, scalable, and follows industry best practices across multiple programming languages.</span>
<span class="gu">---</span>
</code></pre></div></td></tr></table></div>
</div>
                    </summary>
                    <div class='code-full'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code>---
name: Clean Code with Design Patterns
<span class="gu">description: This skill should be used when implementing new features or refactoring existing code to apply senior-level design patterns, SOLID principles, and clean code practices. It guides analysis, design, and implementation of code that is maintainable, scalable, and follows industry best practices across multiple programming languages.</span>
<span class="gu">---</span>

<span class="gh"># Clean Code with Design Patterns</span>

<span class="gu">## Overview</span>

This skill provides senior-level guidance for writing clean, maintainable code using proven design patterns and architectural principles. It enables engineers to analyze code quality, identify architectural improvements, apply SOLID principles, and implement solutions that use Gang of Four patterns and modern best practices.

<span class="gu">## When to Use This Skill</span>

Use this skill when:

<span class="k">-</span><span class="w"> </span><span class="gs">**Implementing new features**</span> - Ensuring new code follows design patterns from the start
<span class="k">-</span><span class="w"> </span><span class="gs">**Refactoring existing code**</span> - Identifying and applying patterns to improve structure and maintainability
<span class="k">-</span><span class="w"> </span><span class="gs">**Code review and assessment**</span> - Evaluating code against clean code standards and best practices
<span class="k">-</span><span class="w"> </span><span class="gs">**Architecture decisions**</span> - Selecting appropriate patterns for scalability and maintainability
<span class="k">-</span><span class="w"> </span><span class="gs">**Working across languages**</span> - Applying language-agnostic principles with language-specific idioms

<span class="gu">## The Clean Code Workflow</span>

<span class="gu">### Phase 1: Analysis and Assessment</span>

Before making implementation decisions, conduct thorough analysis:

<span class="k">1.</span> <span class="gs">**Understand the Context**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Identify problem domain and requirements
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Determine current pain points and technical debt
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Consider system constraints and performance needs
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Map existing architecture and dependencies

<span class="k">2.</span> <span class="gs">**Assess Code Quality Issues**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Review for SOLID principle violations (reference <span class="sb">`references/solid_principles.md`</span>)
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Identify code smells: long methods, large classes, tight coupling, duplicate code
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Check for missing abstractions and violations of DRY (Don&#39;t Repeat Yourself)
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Evaluate testability and current dependency injection approach

<span class="k">3.</span> <span class="gs">**Select Appropriate Patterns**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Reference <span class="sb">`references/design_patterns_guide.md`</span> for the pattern catalog
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Consider language-specific idioms and conventions
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Evaluate complexity vs. maintainability trade-offs
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Validate pattern fits the specific problem (avoid over-engineering simple solutions)

<span class="gu">### Phase 2: Design and Planning</span>

<span class="k">1.</span> <span class="gs">**Create Clear Abstraction Layers**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Define explicit interfaces and contracts
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Separate concerns: business logic, data access, presentation, infrastructure
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Favor composition over inheritance
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Follow principle of least surprise

<span class="k">2.</span> <span class="gs">**Plan Dependency Management**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Identify all dependencies early
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Design for dependency injection from the start
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Plan for testability and mocking
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Consider lifecycle management (singleton, transient, scoped)

<span class="k">3.</span> <span class="gs">**Document Design Decisions**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Record which patterns are being applied and why
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Document assumptions and constraints
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Include rationale for architectural choices
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Make trade-offs explicit

<span class="gu">### Phase 3: Implementation</span>

<span class="k">1.</span> <span class="gs">**Apply Patterns Consistently**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Reference <span class="sb">`references/clean_code_checklist.md`</span> during implementation
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Follow language idioms while applying patterns
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Use descriptive naming that reveals intent
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Keep methods and classes small and focused (single responsibility)

<span class="k">2.</span> <span class="gs">**Build for Testability**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Design with testing as a first-class concern
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Inject dependencies to enable mocking
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Create small, testable units
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Avoid tight coupling to infrastructure layers

<span class="k">3.</span> <span class="gs">**Maintain SOLID Principles Throughout**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span><span class="gs">**S**</span>ingle Responsibility: One reason to change per class/module
<span class="w">   </span><span class="k">-</span><span class="w"> </span><span class="gs">**O**</span>pen/Closed: Open for extension, closed for modification
<span class="w">   </span><span class="k">-</span><span class="w"> </span><span class="gs">**L**</span>iskov Substitution: Derived types must be substitutable for base types
<span class="w">   </span><span class="k">-</span><span class="w"> </span><span class="gs">**I**</span>nterface Segregation: Segregate fat interfaces into smaller, focused ones
<span class="w">   </span><span class="k">-</span><span class="w"> </span><span class="gs">**D**</span>ependency Inversion: Depend on abstractions, not concrete implementations

<span class="gu">### Phase 4: Review and Refinement</span>

<span class="k">1.</span> <span class="gs">**Validate Pattern Implementation**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Ensure pattern is correctly applied
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Check for anti-patterns and violations
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Verify abstraction layers are clean and well-defined

<span class="k">2.</span> <span class="gs">**Perform Code Quality Checks**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Complexity metrics: McCabe complexity, cognitive complexity
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Test coverage: Aim for meaningful coverage (70%+)
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Readability: Can a new team member understand it?
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Performance: Optimize after profiling, not prematurely

<span class="k">3.</span> <span class="gs">**Document and Communicate**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Add inline comments only for non-obvious logic (let code be self-documenting)
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Create architecture diagrams where helpful
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Document public APIs and contracts
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Share design rationale with team

<span class="gu">## Core Clean Code Principles</span>

<span class="gu">### 1. Meaningful Names</span>
<span class="k">-</span><span class="w"> </span>Variables, functions, and classes should clearly express intent
<span class="k">-</span><span class="w"> </span>Use pronounceable, searchable names
<span class="k">-</span><span class="w"> </span>Avoid misleading hints or abbreviations
<span class="k">-</span><span class="w"> </span>Use domain language from the business

<span class="gu">### 2. Functions Should Do One Thing</span>
<span class="k">-</span><span class="w"> </span>Keep methods focused and small (&lt;20 lines ideal)
<span class="k">-</span><span class="w"> </span>If a function needs comments to explain &quot;what&quot; it does, split it
<span class="k">-</span><span class="w"> </span>Use clear, expressive names to replace comments
<span class="k">-</span><span class="w"> </span>Extract helper functions ruthlessly

<span class="gu">### 3. DRY (Don&#39;t Repeat Yourself)</span>
<span class="k">-</span><span class="w"> </span>Extract common logic into reusable components
<span class="k">-</span><span class="w"> </span>Use inheritance and composition to eliminate duplication
<span class="k">-</span><span class="w"> </span>Consider templates and patterns to reduce boilerplate
<span class="k">-</span><span class="w"> </span>Be wary of accidental duplication in structure

<span class="gu">### 4. Error Handling</span>
<span class="k">-</span><span class="w"> </span>Handle errors explicitly, don&#39;t silently swallow them
<span class="k">-</span><span class="w"> </span>Use typed exceptions when available
<span class="k">-</span><span class="w"> </span>Provide context in error messages
<span class="k">-</span><span class="w"> </span>Create exception hierarchies that make sense

<span class="gu">### 5. Comments and Documentation</span>
<span class="k">-</span><span class="w"> </span>Write self-explanatory code; comments explain &quot;why&quot;, not &quot;what&quot;
<span class="k">-</span><span class="w"> </span>Remove commented-out code (version control handles history)
<span class="k">-</span><span class="w"> </span>Keep documentation synchronized with code changes
<span class="k">-</span><span class="w"> </span>Use types and tests as documentation

<span class="gu">## Key Design Patterns to Apply</span>

<span class="gu">### Structural Patterns</span>
<span class="k">-</span><span class="w"> </span><span class="gs">**Adapter**</span>: Makes incompatible interfaces work together
<span class="k">-</span><span class="w"> </span><span class="gs">**Bridge**</span>: Separates abstraction from implementation
<span class="k">-</span><span class="w"> </span><span class="gs">**Decorator**</span>: Adds behavior without modifying originals
<span class="k">-</span><span class="w"> </span><span class="gs">**Facade**</span>: Simplifies complex subsystem interfaces

<span class="gu">### Behavioral Patterns</span>
<span class="k">-</span><span class="w"> </span><span class="gs">**Strategy**</span>: Encapsulates algorithms for runtime selection
<span class="k">-</span><span class="w"> </span><span class="gs">**Observer**</span>: Decouples event handling and notification
<span class="k">-</span><span class="w"> </span><span class="gs">**Template Method**</span>: Defines algorithm skeleton in base class
<span class="k">-</span><span class="w"> </span><span class="gs">**Chain of Responsibility**</span>: Passes requests along a chain of handlers

<span class="gu">### Creational Patterns</span>
<span class="k">-</span><span class="w"> </span><span class="gs">**Factory**</span>: Encapsulates object creation logic
<span class="k">-</span><span class="w"> </span><span class="gs">**Builder**</span>: Constructs complex objects step-by-step
<span class="k">-</span><span class="w"> </span><span class="gs">**Dependency Injection**</span>: Provides dependencies externally

<span class="gu">### Architectural Patterns</span>
<span class="k">-</span><span class="w"> </span><span class="gs">**Repository**</span>: Abstracts data access logic
<span class="k">-</span><span class="w"> </span><span class="gs">**Service Layer**</span>: Encapsulates business logic
<span class="k">-</span><span class="w"> </span><span class="gs">**MVC/MVP**</span>: Separates concerns in user-facing code
<span class="k">-</span><span class="w"> </span><span class="gs">**Hexagonal (Ports &amp; Adapters)**</span>: Isolates business logic from infrastructure

<span class="gu">## Language-Specific Considerations</span>

Apply design patterns alongside language idioms:

<span class="k">-</span><span class="w"> </span><span class="gs">**Python**</span>: Use properties, decorators, and context managers; follow PEP 8
<span class="k">-</span><span class="w"> </span><span class="gs">**JavaScript/TypeScript**</span>: Leverage prototypes, higher-order functions, async patterns
<span class="k">-</span><span class="w"> </span><span class="gs">**Java**</span>: Use generics, annotations, and stream APIs
<span class="k">-</span><span class="w"> </span><span class="gs">**Go**</span>: Favor composition, use interfaces for abstraction
<span class="k">-</span><span class="w"> </span><span class="gs">**C#**</span>: Use properties, LINQ, and async/await patterns

Consider language performance characteristics when applying patterns. Use built-in features to simplify pattern implementation.

<span class="gu">## Common Pitfalls to Avoid</span>

<span class="k">-</span><span class="w"> </span><span class="gs">**Over-engineering**</span>: Using sophisticated patterns for trivial problems
<span class="k">-</span><span class="w"> </span><span class="gs">**Pattern Mixing**</span>: Combining incompatible patterns without understanding interactions
<span class="k">-</span><span class="w"> </span><span class="gs">**Ignoring Context**</span>: Blindly applying patterns without understanding the specific domain
<span class="k">-</span><span class="w"> </span><span class="gs">**Premature Optimization**</span>: Optimize after measuring performance, not before
<span class="k">-</span><span class="w"> </span><span class="gs">**Insufficient Testing**</span>: Designing without considering testability from the start
<span class="k">-</span><span class="w"> </span><span class="gs">**Poor Naming**</span>: Sacrificing clarity for brevity
<span class="k">-</span><span class="w"> </span><span class="gs">**God Objects**</span>: Classes that accumulate too many responsibilities
<span class="k">-</span><span class="w"> </span><span class="gs">**Feature Envy**</span>: Methods that access another object&#39;s internals excessively
<span class="k">-</span><span class="w"> </span><span class="gs">**Inappropriate Abstraction**</span>: Creating abstractions too early or for single use cases

<span class="gu">## Practical Implementation Approach</span>

When refactoring or implementing:

<span class="k">1.</span> Start with understanding: What is the code trying to accomplish?
<span class="k">2.</span> Identify violations: Which SOLID principles are violated?
<span class="k">3.</span> Select patterns: What patterns would help?
<span class="k">4.</span> Plan changes: What&#39;s the safest sequence of changes?
<span class="k">5.</span> Implement incrementally: Make small, testable changes
<span class="k">6.</span> Verify coverage: Ensure tests cover the new behavior
<span class="k">7.</span> Review and document: Share design decisions with team

<span class="gu">## Resources and References</span>

<span class="k">-</span><span class="w"> </span><span class="sb">`references/design_patterns_guide.md`</span> - Comprehensive pattern catalog with implementation examples and trade-offs
<span class="k">-</span><span class="w"> </span><span class="sb">`references/solid_principles.md`</span> - Deep dive into SOLID principles with examples for each
<span class="k">-</span><span class="w"> </span><span class="sb">`references/clean_code_checklist.md`</span> - Practical checklist for evaluating code quality
<span class="k">-</span><span class="w"> </span><span class="sb">`references/refactoring_strategies.md`</span> - Safe techniques for improving existing code

Use <span class="sb">`scripts/code_analyzer.py`</span> for automated analysis of code quality metrics and pattern recommendations.

<span class="gu">## Resources</span>

This skill includes example resource directories that demonstrate how to organize different types of bundled resources:
</code></pre></div></td></tr></table></div>
</div>
                </details>
                </div></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:44:24.186Z'>2025-11-07 10:44:24</span>
                </div>
                
                <span class='token-usage'>Input: 2 | Output: 1 | Cache Creation: 5751 | Cache Read: 26929</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Good! Now let me clean up the rest of the file and mark this todo as complete:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_019SfM5Tg6nVZhUjA3iE8wms">üìù Edit <span class='tool-summary'>/root/Claude/claude-factory/skills/clean-code-design-patterns/SKILL.md</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:44:31.170Z'>2025-11-07 10:44:31</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='edit-tool-content'><div class='edit-diff'><div class='diff-line diff-removed'><span class='diff-marker'>-</span>## Resources</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>This skill includes example resource directories that demonstrate how to organize different types of bundled resources:</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>### scripts/</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>Executable code (Python/Bash/etc.) that can be run directly to perform specific operations.</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>**Examples from other skills:**</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- PDF skill: `fill_fillable_fields.py`, `extract_form_field_info.py` - utilities for PDF manipulation</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- DOCX skill: `document.py`, `utilities.py` - Python modules for document processing</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>**Appropriate for:** Python scripts, shell scripts, or any executable code that performs automation, data processing, or specific operations.</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>**Note:** Scripts may be executed without loading into context, but can still be read by Claude for patching or environment adjustments.</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>### references/</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>Documentation and reference material intended to be loaded into context to inform Claude&#x27;s process and thinking.</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>**Examples from other skills:**</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Product management: `communication.md`, `context_building.md` - detailed workflow guides</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- BigQuery: API reference documentation and query examples</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Finance: Schema documentation, company policies</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>**Appropriate for:** In-depth documentation, API references, database schemas, comprehensive guides, or any detailed information that Claude should reference while working.</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>### assets/</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>Files not intended to be loaded into context, but rather used within the output Claude produces.</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>**Examples from other skills:**</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Brand styling: PowerPoint template files (.pptx), logo files</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Frontend builder: HTML/React boilerplate project directories</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>- Typography: Font files (.ttf, .woff2)</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>**Appropriate for:** Templates, boilerplate code, document templates, images, icons, fonts, or any files meant to be copied or used in the final output.</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>---</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span></div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>**Any unneeded directories can be deleted.** Not every skill requires all three types of resources.</div></div></div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_019SfM5Tg6nVZhUjA3iE8wms"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:44:31.245Z' data-duration='took 75 ms'>2025-11-07 10:44:31</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='edit-tool-result'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">-</span><span class="w"> </span><span class="sb">`references/refactoring_strategies.md`</span> - Safe techniques for improving existing code

Use <span class="sb">`scripts/code_analyzer.py`</span> for automated analysis of code quality metrics and pattern recommendations.
</code></pre></div></td></tr></table></div>
</div></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:44:34.612Z'>2025-11-07 10:44:34</span>
                </div>
                
                <span class='token-usage'>Input: 2 | Output: 1 | Cache Creation: 648 | Cache Read: 32680</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Perfect! Now let me update the todo list and create the reference files:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01Ph3aQeiC8bJC8WgQ4UJu9P">üìù Todo List</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:44:35.571Z'>2025-11-07 10:44:35</span>
                </div>
                
            </div>
        </div>
        <div class='content'>
    <div class="todo-list">
        
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Initialize skill directory structure</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Create SKILL.md with comprehensive design pattern guidance</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item in_progress medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">üîÑ</span>
                    <span class="todo-content">Create references for design patterns and best practices</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item pending medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">‚è≥</span>
                    <span class="todo-content">Create scripts for code analysis and refactoring</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item pending medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">‚è≥</span>
                    <span class="todo-content">Package the skill into distributable zip</span>
                    <span class="todo-id">#</span>
                </div>
            
    </div>
    </div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01Ph3aQeiC8bJC8WgQ4UJu9P"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:44:35.727Z' data-duration='took 156 ms'>2025-11-07 10:44:35</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>Todos have been modified successfully. Ensure that you continue to use the todo list to track your progress. Please proceed with the current tasks if applicable</pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:44:38.402Z'>2025-11-07 10:44:38</span>
                </div>
                
                <span class='token-usage'>Input: 2 | Output: 1 | Cache Creation: 259 | Cache Read: 33328</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Now let me create the reference files. First, I'll delete the example files and create the actual reference materials:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01HVizrRh8DiR2L9PFD58JnC">üõ†Ô∏è Bash <span class='tool-summary'>Delete example files from skill</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:44:39.283Z'>2025-11-07 10:44:39</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='bash-tool-content'><pre class='bash-tool-command'>rm /root/Claude/claude-factory/skills/clean-code-design-patterns/references/api_reference.md /root/Claude/claude-factory/skills/clean-code-design-patterns/scripts/example.py /root/Claude/claude-factory/skills/clean-code-design-patterns/assets/example_asset.txt</pre></div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01HVizrRh8DiR2L9PFD58JnC"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:44:39.517Z' data-duration='took 234 ms'>2025-11-07 10:44:39</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre></pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:44:42.964Z'>2025-11-07 10:44:42</span>
                </div>
                
                <span class='token-usage'>Input: 3 | Output: 1 | Cache Creation: 198 | Cache Read: 33587</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Now let me create the comprehensive reference files:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_015EWx5WDkP76aUdKcB4Zj6D">üìù Write <span class='tool-summary'>/root/Claude/claude-factory/skills/clean-code-design-patterns/references/design_patterns_guide.md</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:45:22.734Z'>2025-11-07 10:45:22</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='write-tool-content'>
        <details class='collapsible-code'>
            <summary>
                <span class='line-count'>772 lines</span>
                <div class='preview-content'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gh"># Design Patterns Comprehensive Guide</span>

<span class="gu">## Overview</span>

This guide provides detailed explanations of design patterns at a senior engineering level, including when to apply them, implementation strategies, and language-specific considerations.
</code></pre></div></td></tr></table></div>
</div>
            </summary>
            <div class='code-full'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gh"># Design Patterns Comprehensive Guide</span>

<span class="gu">## Overview</span>

This guide provides detailed explanations of design patterns at a senior engineering level, including when to apply them, implementation strategies, and language-specific considerations.

---

<span class="gu">## Creational Patterns</span>

<span class="gu">### Factory Pattern</span>

<span class="gs">**Problem**</span>: Creating objects without specifying exact classes, centralizing creation logic.

<span class="gs">**When to Use**</span>:
<span class="k">-</span><span class="w"> </span>Multiple related object types with similar interfaces
<span class="k">-</span><span class="w"> </span>Creation logic is complex
<span class="k">-</span><span class="w"> </span>Need to abstract object instantiation from clients
<span class="k">-</span><span class="w"> </span>Objects should be created based on runtime conditions

<span class="gs">**Implementation Approach**</span>:

<span class="sb">```python</span>
<span class="c1"># Bad: Tight coupling to concrete classes</span>
<span class="k">class</span><span class="w"> </span><span class="nc">OrderProcessor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_type</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">order_type</span> <span class="o">==</span> <span class="s2">&quot;standard&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">StandardOrder</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">order_type</span> <span class="o">==</span> <span class="s2">&quot;expedited&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ExpeditedOrder</span><span class="p">()</span>

<span class="c1"># Good: Factory pattern with abstraction</span>
<span class="k">class</span><span class="w"> </span><span class="nc">OrderFactory</span><span class="p">:</span>
    <span class="n">_creators</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order_type</span><span class="p">,</span> <span class="n">creator</span><span class="p">):</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_creators</span><span class="p">[</span><span class="n">order_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">creator</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order_type</span><span class="p">):</span>
        <span class="n">creator</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_creators</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">order_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">creator</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown order type: </span><span class="si">{</span><span class="n">order_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">creator</span><span class="p">()</span>

<span class="n">OrderFactory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;standard&quot;</span><span class="p">,</span> <span class="n">StandardOrder</span><span class="p">)</span>
<span class="n">OrderFactory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;expedited&quot;</span><span class="p">,</span> <span class="n">ExpeditedOrder</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">OrderProcessor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_type</span><span class="p">):</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">OrderFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">order_type</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">order</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Decouples client from concrete implementations
<span class="k">-</span><span class="w"> </span>Centralizes object creation
<span class="k">-</span><span class="w"> </span>Easy to add new types without modifying clients
<span class="k">-</span><span class="w"> </span>Enables runtime polymorphism

<span class="gs">**Trade-offs**</span>:
<span class="k">-</span><span class="w"> </span>Adds abstraction layer
<span class="k">-</span><span class="w"> </span>Can be overkill for simple object creation
<span class="k">-</span><span class="w"> </span>Factory itself needs testing

---

<span class="gu">### Builder Pattern</span>

<span class="gs">**Problem**</span>: Constructing complex objects with many optional parameters.

<span class="gs">**When to Use**</span>:
<span class="k">-</span><span class="w"> </span>Objects have many optional or required parameters
<span class="k">-</span><span class="w"> </span>Multiple ways to configure an object
<span class="k">-</span><span class="w"> </span>Want to avoid constructor parameter explosion (telescoping)
<span class="k">-</span><span class="w"> </span>Object construction is multi-step
<span class="k">-</span><span class="w"> </span>Want to enforce immutability

<span class="gs">**Implementation Approach**</span>:

<span class="sb">```python</span>
<span class="c1"># Bad: Telescoping constructor</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DatabaseConfig</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5432</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">database</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ssl</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
        <span class="c1"># Many parameters to remember and order</span>

<span class="c1"># Good: Builder pattern</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DatabaseConfig</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="n">database</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ssl</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">retries</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ssl</span> <span class="o">=</span> <span class="n">ssl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retries</span> <span class="o">=</span> <span class="n">retries</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DatabaseConfigBuilder</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="mi">5432</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ssl</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retries</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">with_port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DatabaseConfigBuilder&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">with_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DatabaseConfigBuilder&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">with_database</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DatabaseConfigBuilder&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">with_ssl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ssl</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DatabaseConfigBuilder&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ssl</span> <span class="o">=</span> <span class="n">ssl</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatabaseConfig</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Credentials required&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DatabaseConfig</span><span class="p">(</span>
            <span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
            <span class="n">username</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
            <span class="n">database</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">,</span>
            <span class="n">ssl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ssl</span><span class="p">,</span>
            <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span>
            <span class="n">retries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">retries</span>
        <span class="p">)</span>

<span class="c1"># Usage</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">(</span><span class="n">DatabaseConfigBuilder</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">with_port</span><span class="p">(</span><span class="mi">5432</span><span class="p">)</span>
    <span class="o">.</span><span class="n">with_credentials</span><span class="p">(</span><span class="s2">&quot;admin&quot;</span><span class="p">,</span> <span class="s2">&quot;secret&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">with_database</span><span class="p">(</span><span class="s2">&quot;myapp&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">with_ssl</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">build</span><span class="p">())</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Readable, fluent interface
<span class="k">-</span><span class="w"> </span>Clear parameter intent
<span class="k">-</span><span class="w"> </span>Validation in one place
<span class="k">-</span><span class="w"> </span>Immutable result
<span class="k">-</span><span class="w"> </span>Optional parameters handled elegantly

<span class="gs">**Trade-offs**</span>:
<span class="k">-</span><span class="w"> </span>More code to write
<span class="k">-</span><span class="w"> </span>Extra object allocation
<span class="k">-</span><span class="w"> </span>Validation happens at build time

---

<span class="gu">### Dependency Injection</span>

<span class="gs">**Problem**</span>: Objects depend on concrete implementations, making testing and reuse difficult.

<span class="gs">**When to Use**</span>:
<span class="k">-</span><span class="w"> </span>Need to swap implementations for testing
<span class="k">-</span><span class="w"> </span>Multiple implementations of same interface exist
<span class="k">-</span><span class="w"> </span>Want loose coupling between components
<span class="k">-</span><span class="w"> </span>Need lifecycle management (singleton, transient, scoped)

<span class="gs">**Implementation Approach**</span>:

<span class="sb">```python</span>
<span class="c1"># Bad: Hard coupling</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span> <span class="o">=</span> <span class="n">PostgreSQLUserRepository</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">FileLogger</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating user: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

<span class="c1"># Good: Dependency injection</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserRepository</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Logger</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repository</span><span class="p">:</span> <span class="n">UserRepository</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span> <span class="n">Logger</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span> <span class="o">=</span> <span class="n">repository</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating user: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

<span class="c1"># Testing</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MockUserRepository</span><span class="p">(</span><span class="n">UserRepository</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saved_users</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saved_users</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MockLogger</span><span class="p">(</span><span class="n">Logger</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

<span class="c1"># Usage</span>
<span class="n">repo</span> <span class="o">=</span> <span class="n">MockUserRepository</span><span class="p">()</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">MockLogger</span><span class="p">()</span>
<span class="n">service</span> <span class="o">=</span> <span class="n">UserService</span><span class="p">(</span><span class="n">repo</span><span class="p">,</span> <span class="n">logger</span><span class="p">)</span>
<span class="n">service</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">repo</span><span class="o">.</span><span class="n">saved_users</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="s2">&quot;Creating user: Alice&quot;</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">logs</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Easy to test with mocks
<span class="k">-</span><span class="w"> </span>Easy to swap implementations
<span class="k">-</span><span class="w"> </span>Loose coupling
<span class="k">-</span><span class="w"> </span>Single Responsibility Principle

<span class="gs">**Trade-offs**</span>:
<span class="k">-</span><span class="w"> </span>Requires IoC container or manual wiring
<span class="k">-</span><span class="w"> </span>More constructor parameters
<span class="k">-</span><span class="w"> </span>Requires understanding of abstraction

---

<span class="gu">## Structural Patterns</span>

<span class="gu">### Adapter Pattern</span>

<span class="gs">**Problem**</span>: Making incompatible interfaces work together.

<span class="gs">**When to Use**</span>:
<span class="k">-</span><span class="w"> </span>Integrating legacy code with new systems
<span class="k">-</span><span class="w"> </span>Third-party libraries have incompatible interfaces
<span class="k">-</span><span class="w"> </span>Need to normalize multiple similar but different interfaces
<span class="k">-</span><span class="w"> </span>Don&#39;t want to modify existing classes

<span class="gs">**Implementation Approach**</span>:

<span class="sb">```python</span>
<span class="c1"># Legacy system</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LegacyPaymentProcessor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process_payment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount_cents</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="n">amount_cents</span> <span class="o">/</span> <span class="mi">100</span><span class="p">}</span>

<span class="c1"># New system expects this interface</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PaymentProcessor</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PaymentResult</span><span class="p">:</span> <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PaymentResult</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">reference</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="n">success</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amount</span> <span class="o">=</span> <span class="n">amount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span>

<span class="c1"># Adapter</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LegacyPaymentProcessorAdapter</span><span class="p">(</span><span class="n">PaymentProcessor</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legacy_processor</span><span class="p">:</span> <span class="n">LegacyPaymentProcessor</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legacy_processor</span> <span class="o">=</span> <span class="n">legacy_processor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PaymentResult</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">amount_cents</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">amount</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">legacy_processor</span><span class="o">.</span><span class="n">process_payment</span><span class="p">(</span><span class="n">amount_cents</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">PaymentResult</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
                <span class="n">amount</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">]),</span>
                <span class="n">reference</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reference&quot;</span><span class="p">,</span> <span class="s2">&quot;legacy&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PaymentResult</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

<span class="c1"># Usage</span>
<span class="n">legacy</span> <span class="o">=</span> <span class="n">LegacyPaymentProcessor</span><span class="p">()</span>
<span class="n">processor</span> <span class="o">=</span> <span class="n">LegacyPaymentProcessorAdapter</span><span class="p">(</span><span class="n">legacy</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="mf">19.99</span><span class="p">)</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>No modification to existing classes
<span class="k">-</span><span class="w"> </span>Decouples from incompatible interfaces
<span class="k">-</span><span class="w"> </span>Reusable integration code

<span class="gs">**Trade-offs**</span>:
<span class="k">-</span><span class="w"> </span>Extra layer of indirection
<span class="k">-</span><span class="w"> </span>Requires understanding of both interfaces

---

<span class="gu">### Decorator Pattern</span>

<span class="gs">**Problem**</span>: Adding behavior to objects without modifying their class, or creating combinatorial explosion of subclasses.

<span class="gs">**When to Use**</span>:
<span class="k">-</span><span class="w"> </span>Need to add responsibilities to objects dynamically
<span class="k">-</span><span class="w"> </span>Want to avoid subclass explosion
<span class="k">-</span><span class="w"> </span>Multiple features can be combined in various ways
<span class="k">-</span><span class="w"> </span>Original class shouldn&#39;t be modified

<span class="gs">**Implementation Approach**</span>:

<span class="sb">```python</span>
<span class="c1"># Component</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DataStore</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span> <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FileDataStore</span><span class="p">(</span><span class="n">DataStore</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c1"># Decorators</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EncryptedDataStoreDecorator</span><span class="p">(</span><span class="n">DataStore</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">store</span><span class="p">:</span> <span class="n">DataStore</span><span class="p">,</span> <span class="n">cipher</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="o">=</span> <span class="n">store</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cipher</span> <span class="o">=</span> <span class="n">cipher</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">encrypted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">encrypted</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">encrypted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CachedDataStoreDecorator</span><span class="p">(</span><span class="n">DataStore</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">store</span><span class="p">:</span> <span class="n">DataStore</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="o">=</span> <span class="n">store</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

<span class="c1"># Composition</span>
<span class="n">base_store</span> <span class="o">=</span> <span class="n">FileDataStore</span><span class="p">(</span><span class="s2">&quot;/data&quot;</span><span class="p">)</span>
<span class="n">encrypted_store</span> <span class="o">=</span> <span class="n">EncryptedDataStoreDecorator</span><span class="p">(</span><span class="n">base_store</span><span class="p">,</span> <span class="n">cipher</span><span class="p">)</span>
<span class="n">cached_store</span> <span class="o">=</span> <span class="n">CachedDataStoreDecorator</span><span class="p">(</span><span class="n">encrypted_store</span><span class="p">)</span>

<span class="n">cached_store</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;user_1&quot;</span><span class="p">,</span> <span class="s2">&quot;secret_data&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cached_store</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;user_1&quot;</span><span class="p">)</span>  <span class="c1"># From cache, decrypted</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Behavior composition without subclasses
<span class="k">-</span><span class="w"> </span>Single Responsibility: each decorator does one thing
<span class="k">-</span><span class="w"> </span>Easy to add/remove features
<span class="k">-</span><span class="w"> </span>Runtime flexibility

<span class="gs">**Trade-offs**</span>:
<span class="k">-</span><span class="w"> </span>Can create deep decorator chains (hard to debug)
<span class="k">-</span><span class="w"> </span>Ordering of decorators matters
<span class="k">-</span><span class="w"> </span>Requires careful interface design

---

<span class="gu">### Facade Pattern</span>

<span class="gs">**Problem**</span>: Subsystem is complex, clients need simplified interface.

<span class="gs">**When to Use**</span>:
<span class="k">-</span><span class="w"> </span>Complex subsystem with many interdependent parts
<span class="k">-</span><span class="w"> </span>Multiple clients need only specific functionality
<span class="k">-</span><span class="w"> </span>Want to decouple clients from subsystem changes
<span class="k">-</span><span class="w"> </span>Need to provide simple entry point to complex system

<span class="gs">**Implementation Approach**</span>:

<span class="sb">```python</span>
<span class="c1"># Complex subsystem</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PaymentGateway</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">authorize_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># Complex logic</span>
        <span class="k">return</span> <span class="s2">&quot;auth_id_123&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FraudDetection</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_transaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># Complex fraud checking</span>
        <span class="k">return</span> <span class="kc">True</span>

<span class="k">class</span><span class="w"> </span><span class="nc">BillingSystem</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">record_transaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span> <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NotificationService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">send_receipt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span> <span class="k">pass</span>

<span class="c1"># Facade</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PaymentProcessor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gateway</span> <span class="o">=</span> <span class="n">PaymentGateway</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fraud_detector</span> <span class="o">=</span> <span class="n">FraudDetection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">billing</span> <span class="o">=</span> <span class="n">BillingSystem</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notifications</span> <span class="o">=</span> <span class="n">NotificationService</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_payment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simplified interface hiding complexity&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">auth_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">authorize_card</span><span class="p">(</span><span class="n">card_token</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">fraud_detector</span><span class="o">.</span><span class="n">check_transaction</span><span class="p">(</span><span class="n">auth_id</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">billing</span><span class="o">.</span><span class="n">record_transaction</span><span class="p">(</span><span class="n">auth_id</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notifications</span><span class="o">.</span><span class="n">send_receipt</span><span class="p">(</span><span class="n">customer_id</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

<span class="c1"># Usage</span>
<span class="n">processor</span> <span class="o">=</span> <span class="n">PaymentProcessor</span><span class="p">()</span>
<span class="n">success</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="n">process_payment</span><span class="p">(</span><span class="s2">&quot;customer_1&quot;</span><span class="p">,</span> <span class="s2">&quot;token_xyz&quot;</span><span class="p">,</span> <span class="mf">99.99</span><span class="p">)</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Simplified interface
<span class="k">-</span><span class="w"> </span>Decouples clients from subsystem
<span class="k">-</span><span class="w"> </span>Reduces dependencies
<span class="k">-</span><span class="w"> </span>Easier to change subsystem internals

<span class="gs">**Trade-offs**</span>:
<span class="k">-</span><span class="w"> </span>Facade can become bloated
<span class="k">-</span><span class="w"> </span>May hide important details from clients
<span class="k">-</span><span class="w"> </span>Single point of failure

---

<span class="gu">## Behavioral Patterns</span>

<span class="gu">### Strategy Pattern</span>

<span class="gs">**Problem**</span>: Multiple algorithms for same task, need to switch at runtime.

<span class="gs">**When to Use**</span>:
<span class="k">-</span><span class="w"> </span>Multiple related algorithms
<span class="k">-</span><span class="w"> </span>Need to choose algorithm at runtime
<span class="k">-</span><span class="w"> </span>Want to avoid conditional logic
<span class="k">-</span><span class="w"> </span>Algorithms change frequently
<span class="k">-</span><span class="w"> </span>Need to test algorithms in isolation

<span class="gs">**Implementation Approach**</span>:

<span class="sb">```python</span>
<span class="c1"># Problem: Algorithm selection with conditionals</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SortingEngine</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s2">&quot;bubble&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bubble_sort</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s2">&quot;quick&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quick_sort</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s2">&quot;merge&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_merge_sort</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_bubble_sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span> <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_quick_sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span> <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_merge_sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span> <span class="k">pass</span>

<span class="c1"># Solution: Strategy pattern</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SortingStrategy</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span> <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">BubbleSort</span><span class="p">(</span><span class="n">SortingStrategy</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="c1"># Implementation</span>
        <span class="k">return</span> <span class="n">data</span>

<span class="k">class</span><span class="w"> </span><span class="nc">QuickSort</span><span class="p">(</span><span class="n">SortingStrategy</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="c1"># Implementation</span>
        <span class="k">return</span> <span class="n">data</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SortingEngine</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="n">SortingStrategy</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strategy</span> <span class="o">=</span> <span class="n">strategy</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">strategy</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Usage</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">SortingEngine</span><span class="p">(</span><span class="n">QuickSort</span><span class="p">())</span>
<span class="n">sorted_data</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Eliminates complex conditional logic
<span class="k">-</span><span class="w"> </span>Easy to add new algorithms
<span class="k">-</span><span class="w"> </span>Algorithms testable in isolation
<span class="k">-</span><span class="w"> </span>Runtime selection without recompilation

<span class="gs">**Trade-offs**</span>:
<span class="k">-</span><span class="w"> </span>Each algorithm as separate class
<span class="k">-</span><span class="w"> </span>Overhead for simple algorithms
<span class="k">-</span><span class="w"> </span>Client must understand algorithms to choose

---

<span class="gu">### Observer Pattern</span>

<span class="gs">**Problem**</span>: Multiple objects need to react to state changes in another object.

<span class="gs">**When to Use**</span>:
<span class="k">-</span><span class="w"> </span>One-to-many object relationship
<span class="k">-</span><span class="w"> </span>Don&#39;t know dependencies in advance
<span class="k">-</span><span class="w"> </span>Object state changes frequently
<span class="k">-</span><span class="w"> </span>Want loose coupling between subject and observers

<span class="gs">**Implementation Approach**</span>:

<span class="sb">```python</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>

<span class="c1"># Subject</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserRepository</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_observers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">UserRepositoryObserver</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_users</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span> <span class="s1">&#39;UserRepositoryObserver&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_observers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observer</span><span class="p">:</span> <span class="s1">&#39;UserRepositoryObserver&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_observers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">notify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="s1">&#39;User&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">observer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observers</span><span class="p">:</span>
            <span class="n">observer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">event_type</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="s1">&#39;User&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_users</span><span class="p">[</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s2">&quot;user_created&quot;</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_users</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s2">&quot;user_deleted&quot;</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>

<span class="c1"># Observers</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserRepositoryObserver</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="s1">&#39;User&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">EmailNotificationObserver</span><span class="p">(</span><span class="n">UserRepositoryObserver</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="s1">&#39;User&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">event_type</span> <span class="o">==</span> <span class="s2">&quot;user_created&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sending welcome email to </span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">LoggingObserver</span><span class="p">(</span><span class="n">UserRepositoryObserver</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="s1">&#39;User&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[LOG] </span><span class="si">{</span><span class="n">event_type</span><span class="si">}</span><span class="s2">: User </span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Usage</span>
<span class="n">repo</span> <span class="o">=</span> <span class="n">UserRepository</span><span class="p">()</span>
<span class="n">repo</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">EmailNotificationObserver</span><span class="p">())</span>
<span class="n">repo</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">LoggingObserver</span><span class="p">())</span>

<span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="s2">&quot;alice@example.com&quot;</span><span class="p">)</span>
<span class="n">repo</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>  <span class="c1"># Notifies all observers</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Loose coupling
<span class="k">-</span><span class="w"> </span>Dynamic subscription
<span class="k">-</span><span class="w"> </span>Supports broadcast communication
<span class="k">-</span><span class="w"> </span>Promotes separation of concerns

<span class="gs">**Trade-offs**</span>:
<span class="k">-</span><span class="w"> </span>Observers called in undefined order
<span class="k">-</span><span class="w"> </span>Can be hard to trace observer notifications
<span class="k">-</span><span class="w"> </span>Memory leaks if observers not detached
<span class="k">-</span><span class="w"> </span>Performance cost with many observers

---

<span class="gu">### Strategy vs. Template Method</span>

<span class="gs">**Template Method**</span>: Algorithm structure in base class, subclasses override steps.

<span class="sb">```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ReportGenerator</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">()</span>
        <span class="n">formatted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="n">formatted</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fetch_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">format_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span> <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formatted</span><span class="p">):</span> <span class="k">pass</span>
<span class="sb">```</span>

<span class="gs">**Use Template Method when**</span>: Algorithm structure is fixed, variations are in steps.

<span class="gs">**Use Strategy when**</span>: Entire algorithm varies, want to swap at runtime.

---

<span class="gu">## Architectural Patterns</span>

<span class="gu">### Repository Pattern</span>

<span class="gs">**Problem**</span>: Data access logic scattered throughout application, hard to test.

<span class="gs">**When to Use**</span>:
<span class="k">-</span><span class="w"> </span>Multiple data sources (database, cache, API)
<span class="k">-</span><span class="w"> </span>Need to abstract data access
<span class="k">-</span><span class="w"> </span>Want to test business logic without data layer
<span class="k">-</span><span class="w"> </span>Data access logic is complex

<span class="gs">**Implementation Approach**</span>:

<span class="sb">```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserRepository</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">find_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">User</span><span class="p">]:</span> <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">find_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">User</span><span class="p">]:</span> <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SQLUserRepository</span><span class="p">(</span><span class="n">UserRepository</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection</span><span class="p">:</span> <span class="n">Connection</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="n">connection</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">User</span><span class="p">]:</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users WHERE id = ?&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">user_id</span><span class="p">,))</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_to_user</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">if</span> <span class="n">row</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
            <span class="s2">&quot;INSERT OR REPLACE INTO users (id, name, email) VALUES (?, ?, ?)&quot;</span><span class="p">,</span>
            <span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CachedUserRepository</span><span class="p">(</span><span class="n">UserRepository</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="n">UserRepository</span><span class="p">,</span> <span class="n">cache</span><span class="p">:</span> <span class="n">Cache</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base</span> <span class="o">=</span> <span class="n">base</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="n">cache</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">User</span><span class="p">]:</span>
        <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;user:</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cached</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cached</span>

        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">find_by_id</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;user:</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">user</span>

<span class="c1"># Usage in business logic</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repository</span><span class="p">:</span> <span class="n">UserRepository</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span> <span class="o">=</span> <span class="n">repository</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">deactivate_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">find_by_id</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        <span class="n">user</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>

<span class="c1"># Testing</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MockUserRepository</span><span class="p">(</span><span class="n">UserRepository</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">users</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">User</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">user</span>

<span class="n">repo</span> <span class="o">=</span> <span class="n">MockUserRepository</span><span class="p">()</span>
<span class="n">service</span> <span class="o">=</span> <span class="n">UserService</span><span class="p">(</span><span class="n">repo</span><span class="p">)</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Data access logic centralized
<span class="k">-</span><span class="w"> </span>Easy to test business logic
<span class="k">-</span><span class="w"> </span>Easy to swap data sources
<span class="k">-</span><span class="w"> </span>Consistent data access interface

<span class="gs">**Trade-offs**</span>:
<span class="k">-</span><span class="w"> </span>Extra layer of abstraction
<span class="k">-</span><span class="w"> </span>Need to maintain repository interfaces
<span class="k">-</span><span class="w"> </span>ORM might duplicate functionality

---

<span class="gu">## Pattern Selection Framework</span>

<span class="gu">### Ask These Questions</span>

<span class="k">1.</span> <span class="gs">**What problem are we solving?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Is it structural, behavioral, or creational?
<span class="w">   </span><span class="k">-</span><span class="w"> </span>How complex is the problem?

<span class="k">2.</span> <span class="gs">**What are the forces?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Coupling/cohesion concerns?
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Testing requirements?
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Runtime flexibility needed?

<span class="k">3.</span> <span class="gs">**Is pattern the simplest solution?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Can we solve it without a pattern?
<span class="w">   </span><span class="k">-</span><span class="w"> </span>What&#39;s the cost vs. benefit?

<span class="k">4.</span> <span class="gs">**Language idioms?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Does the language support this pattern natively?
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Follow language conventions, not rigid patterns

<span class="k">5.</span> <span class="gs">**Team understanding?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Does the team understand the pattern?
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Is it worth the cognitive load?

---

<span class="gu">## Anti-Patterns to Avoid</span>

<span class="k">-</span><span class="w"> </span><span class="gs">**God Object**</span>: Class responsible for too much
<span class="k">-</span><span class="w"> </span><span class="gs">**Feature Envy**</span>: Method using another class&#39;s data extensively
<span class="k">-</span><span class="w"> </span><span class="gs">**Spaghetti Code**</span>: Tangled, hard-to-follow control flow
<span class="k">-</span><span class="w"> </span><span class="gs">**Singleton Abuse**</span>: Overusing singletons for global state
<span class="k">-</span><span class="w"> </span><span class="gs">**Copy-Paste Code**</span>: Duplicating logic instead of extracting
<span class="k">-</span><span class="w"> </span><span class="gs">**Hard-Coded Dependencies**</span>: Tight coupling to concrete classes
<span class="k">-</span><span class="w"> </span><span class="gs">**Silent Failures**</span>: Swallowing exceptions without handling
</code></pre></div></td></tr></table></div>
</div>
        </details>
        </div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_015EWx5WDkP76aUdKcB4Zj6D"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:45:23.003Z' data-duration='took 269 ms'>2025-11-07 10:45:23</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>File created successfully at: /root/Claude/claude-factory/skills/clean-code-design-patterns/references/design_patterns_guide.md ...</pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:45:26.121Z'>2025-11-07 10:45:26</span>
                </div>
                
                <span class='token-usage'>Input: 2 | Output: 1 | Cache Creation: 5787 | Cache Read: 33785</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Now let me create the SOLID principles reference:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01JQWyXZBwdiw3q1udTy7muf">üìù Write <span class='tool-summary'>/root/Claude/claude-factory/skills/clean-code-design-patterns/references/solid_principles.md</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:45:57.769Z'>2025-11-07 10:45:57</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='write-tool-content'>
        <details class='collapsible-code'>
            <summary>
                <span class='line-count'>554 lines</span>
                <div class='preview-content'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gh"># SOLID Principles Deep Dive</span>

<span class="gu">## Overview</span>

SOLID is an acronym for five design principles that make code more maintainable, flexible, and testable. Coined by Robert C. Martin, these principles guide senior-level code design decisions.
</code></pre></div></td></tr></table></div>
</div>
            </summary>
            <div class='code-full'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gh"># SOLID Principles Deep Dive</span>

<span class="gu">## Overview</span>

SOLID is an acronym for five design principles that make code more maintainable, flexible, and testable. Coined by Robert C. Martin, these principles guide senior-level code design decisions.

---

<span class="gu">## S - Single Responsibility Principle (SRP)</span>

<span class="gs">**Definition**</span>: A class should have only one reason to change, meaning it should have only one job or responsibility.

<span class="gu">### The Problem (Violation)</span>

<span class="sb">```python</span>
<span class="c1"># Bad: Multiple responsibilities</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserManager</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">User</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span>
        <span class="c1"># Database responsibility</span>
        <span class="n">db</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="c1"># Validation responsibility</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_email</span><span class="p">(</span><span class="n">email</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid email&quot;</span><span class="p">)</span>
        <span class="c1"># Email notification responsibility</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_welcome_email</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="c1"># Logging responsibility</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_user_creation</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">user</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;@&quot;</span> <span class="ow">in</span> <span class="n">email</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_send_welcome_email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_log_user_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>
<span class="sb">```</span>

<span class="gs">**Problems**</span>:
<span class="k">-</span><span class="w"> </span>Hard to test: must mock database, email, logging
<span class="k">-</span><span class="w"> </span>Change in email format requires modifying UserManager
<span class="k">-</span><span class="w"> </span>Reusing validation logic requires importing UserManager
<span class="k">-</span><span class="w"> </span>Too many reasons to change

<span class="gu">### The Solution</span>

<span class="sb">```python</span>
<span class="c1"># Good: Separated responsibilities</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EmailValidator</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;@&quot;</span> <span class="ow">in</span> <span class="n">email</span> <span class="ow">and</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">email</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserRepository</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">db</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">WelcomeEmailNotifier</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">send_welcome_email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Send email</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserLogger</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">log_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Log user creation</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repository</span><span class="p">:</span> <span class="n">UserRepository</span><span class="p">,</span>
                 <span class="n">validator</span><span class="p">:</span> <span class="n">EmailValidator</span><span class="p">,</span>
                 <span class="n">notifier</span><span class="p">:</span> <span class="n">WelcomeEmailNotifier</span><span class="p">,</span>
                 <span class="n">logger</span><span class="p">:</span> <span class="n">UserLogger</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span> <span class="o">=</span> <span class="n">repository</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validator</span> <span class="o">=</span> <span class="n">validator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span> <span class="o">=</span> <span class="n">notifier</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">User</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validator</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">email</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid email&quot;</span><span class="p">)</span>

        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span><span class="o">.</span><span class="n">send_welcome_email</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">log_creation</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">user</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Each class has one reason to change
<span class="k">-</span><span class="w"> </span>Easy to test each component independently
<span class="k">-</span><span class="w"> </span>Easy to reuse components
<span class="k">-</span><span class="w"> </span>Clear separation of concerns

<span class="gu">### How to Identify SRP Violations</span>

<span class="k">-</span><span class="w"> </span><span class="gs">**Multiple reasons to change**</span>: If the class needs to change for business logic AND email format AND database changes
<span class="k">-</span><span class="w"> </span><span class="gs">**Hard to name**</span>: If you can&#39;t describe the class in one sentence without &quot;and&quot;
<span class="k">-</span><span class="w"> </span><span class="gs">**Large classes**</span>: Classes with many methods often violate SRP
<span class="k">-</span><span class="w"> </span><span class="gs">**Hard to test**</span>: Need to mock many dependencies

---

<span class="gu">## O - Open/Closed Principle (OCP)</span>

<span class="gs">**Definition**</span>: Software entities should be open for extension but closed for modification.

<span class="gu">### The Problem (Violation)</span>

<span class="sb">```python</span>
<span class="c1"># Bad: Modification required for each new type</span>
<span class="k">class</span><span class="w"> </span><span class="nc">OrderProcessor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">Order</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">order</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;standard&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">order</span><span class="o">.</span><span class="n">total</span> <span class="o">*</span> <span class="mf">0.0</span>
        <span class="k">elif</span> <span class="n">order</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;premium&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">order</span><span class="o">.</span><span class="n">total</span> <span class="o">*</span> <span class="mf">0.1</span>
        <span class="k">elif</span> <span class="n">order</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;vip&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">order</span><span class="o">.</span><span class="n">total</span> <span class="o">*</span> <span class="mf">0.2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown order type: </span><span class="si">{</span><span class="n">order</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="sb">```</span>

<span class="gs">**Problems**</span>:
<span class="k">-</span><span class="w"> </span>Adding new order type requires modifying OrderProcessor
<span class="k">-</span><span class="w"> </span>Each modification is a chance for bugs
<span class="k">-</span><span class="w"> </span>Hard to test new types in isolation
<span class="k">-</span><span class="w"> </span>Violates the concept of closure

<span class="gu">### The Solution</span>

<span class="sb">```python</span>
<span class="c1"># Good: Extensible through new classes</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DiscountStrategy</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_total</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">StandardDiscountStrategy</span><span class="p">(</span><span class="n">DiscountStrategy</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_total</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PremiumDiscountStrategy</span><span class="p">(</span><span class="n">DiscountStrategy</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_total</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">order_total</span> <span class="o">*</span> <span class="mf">0.1</span>

<span class="k">class</span><span class="w"> </span><span class="nc">VIPDiscountStrategy</span><span class="p">(</span><span class="n">DiscountStrategy</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_total</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">order_total</span> <span class="o">*</span> <span class="mf">0.2</span>

<span class="k">class</span><span class="w"> </span><span class="nc">OrderProcessor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discount_strategy</span><span class="p">:</span> <span class="n">DiscountStrategy</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">discount_strategy</span> <span class="o">=</span> <span class="n">discount_strategy</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="n">Order</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">discount_strategy</span><span class="o">.</span><span class="n">calculate_discount</span><span class="p">(</span><span class="n">order</span><span class="o">.</span><span class="n">total</span><span class="p">)</span>

<span class="c1"># Adding new type requires no modification</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CorporateDiscountStrategy</span><span class="p">(</span><span class="n">DiscountStrategy</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_total</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">order_total</span> <span class="o">*</span> <span class="mf">0.15</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>New functionality added without modifying existing code
<span class="k">-</span><span class="w"> </span>Lower risk of breaking existing functionality
<span class="k">-</span><span class="w"> </span>Easier to test new implementations
<span class="k">-</span><span class="w"> </span>Follows polymorphism principles

<span class="gu">### How to Achieve OCP</span>

<span class="k">-</span><span class="w"> </span><span class="gs">**Use abstraction**</span>: Define interfaces/abstract classes
<span class="k">-</span><span class="w"> </span><span class="gs">**Use composition**</span>: Inject dependencies
<span class="k">-</span><span class="w"> </span><span class="gs">**Use design patterns**</span>: Strategy, Decorator, Factory
<span class="k">-</span><span class="w"> </span><span class="gs">**Avoid type checking**</span>: Don&#39;t use isinstance() for dispatch
<span class="k">-</span><span class="w"> </span><span class="gs">**Extension points**</span>: Design with future extensions in mind

---

<span class="gu">## L - Liskov Substitution Principle (LSP)</span>

<span class="gs">**Definition**</span>: Subtypes must be substitutable for their base types without breaking the application.

<span class="gu">### The Problem (Violation)</span>

<span class="sb">```python</span>
<span class="c1"># Bad: Subclass violates contract</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Rectangle</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">height</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">width</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">height</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span>

<span class="c1"># Square IS-A Rectangle (mathematically), but breaks behavior</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Square</span><span class="p">(</span><span class="n">Rectangle</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">width</span>  <span class="c1"># Violates expectation</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">height</span>  <span class="c1"># Violates expectation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">height</span>

<span class="c1"># Client code breaks with Square</span>
<span class="k">def</span><span class="w"> </span><span class="nf">process_shape</span><span class="p">(</span><span class="n">rect</span><span class="p">:</span> <span class="n">Rectangle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">rect</span><span class="o">.</span><span class="n">set_width</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">rect</span><span class="o">.</span><span class="n">set_height</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">rect</span><span class="o">.</span><span class="n">area</span><span class="p">()</span> <span class="o">==</span> <span class="mi">20</span>  <span class="c1"># Fails if rect is a Square!</span>
<span class="sb">```</span>

<span class="gs">**Problems**</span>:
<span class="k">-</span><span class="w"> </span>Subclass breaks parent&#39;s invariants
<span class="k">-</span><span class="w"> </span>Client code must know about subtypes
<span class="k">-</span><span class="w"> </span>Unexpected behavior from polymorphism
<span class="k">-</span><span class="w"> </span>Fragile code

<span class="gu">### The Solution</span>

<span class="sb">```python</span>
<span class="c1"># Good: Separate hierarchies based on behavior</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Shape</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Rectangle</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">height</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">width</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">height</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Square</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">side</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_side</span> <span class="o">=</span> <span class="n">side</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_side</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">side</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_side</span> <span class="o">=</span> <span class="n">side</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_side</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_side</span>

<span class="c1"># Client code works correctly</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_total_area</span><span class="p">(</span><span class="n">shapes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Shape</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">shape</span><span class="o">.</span><span class="n">area</span><span class="p">()</span> <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">shapes</span><span class="p">)</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Polymorphism works as expected
<span class="k">-</span><span class="w"> </span>No surprising behavior from subclasses
<span class="k">-</span><span class="w"> </span>Client code more robust
<span class="k">-</span><span class="w"> </span>Inheritance hierarchies are correct

<span class="gu">### How to Ensure LSP</span>

<span class="k">-</span><span class="w"> </span><span class="gs">**Verify postconditions**</span>: Subclass can&#39;t weaken guarantees
<span class="k">-</span><span class="w"> </span><span class="gs">**Check preconditions**</span>: Subclass can&#39;t strengthen requirements
<span class="k">-</span><span class="w"> </span><span class="gs">**Maintain invariants**</span>: Don&#39;t violate parent&#39;s invariants
<span class="k">-</span><span class="w"> </span><span class="gs">**Ask &quot;is-a&quot; carefully**</span>: Behavioral compatibility, not just concept
<span class="k">-</span><span class="w"> </span><span class="gs">**Use tests**</span>: Test substitutability with different implementations

---

<span class="gu">## I - Interface Segregation Principle (ISP)</span>

<span class="gs">**Definition**</span>: Clients should not be forced to depend on interfaces they don&#39;t use.

<span class="gu">### The Problem (Violation)</span>

<span class="sb">```python</span>
<span class="c1"># Bad: Fat interface</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Worker</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">work</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eat_lunch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Robot</span><span class="p">(</span><span class="n">Worker</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">work</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Robot working&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">eat_lunch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Robot doesn&#39;t eat&quot;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Human</span><span class="p">(</span><span class="n">Worker</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">work</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Human working&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">eat_lunch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Human eating&quot;</span><span class="p">)</span>

<span class="c1"># Client code must check type</span>
<span class="k">def</span><span class="w"> </span><span class="nf">manage_worker</span><span class="p">(</span><span class="n">worker</span><span class="p">:</span> <span class="n">Worker</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">work</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">Human</span><span class="p">):</span>
        <span class="n">worker</span><span class="o">.</span><span class="n">eat_lunch</span><span class="p">()</span>  <span class="c1"># Hack due to fat interface</span>
<span class="sb">```</span>

<span class="gs">**Problems**</span>:
<span class="k">-</span><span class="w"> </span>Robot forced to implement eat_lunch()
<span class="k">-</span><span class="w"> </span>Client code needs type checking
<span class="k">-</span><span class="w"> </span>Changes to interface affect many implementations
<span class="k">-</span><span class="w"> </span>Hard to add partial implementations

<span class="gu">### The Solution</span>

<span class="sb">```python</span>
<span class="c1"># Good: Segregated interfaces</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Workable</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">work</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Eatable</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eat_lunch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Robot</span><span class="p">(</span><span class="n">Workable</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">work</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Robot working&quot;</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Human</span><span class="p">(</span><span class="n">Workable</span><span class="p">,</span> <span class="n">Eatable</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">work</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Human working&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">eat_lunch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Human eating&quot;</span><span class="p">)</span>

<span class="c1"># Clean client code</span>
<span class="k">def</span><span class="w"> </span><span class="nf">manage_workable</span><span class="p">(</span><span class="n">worker</span><span class="p">:</span> <span class="n">Workable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">worker</span><span class="o">.</span><span class="n">work</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">manage_eatable</span><span class="p">(</span><span class="n">eater</span><span class="p">:</span> <span class="n">Eatable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">eater</span><span class="o">.</span><span class="n">eat_lunch</span><span class="p">()</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Classes only implement what they need
<span class="k">-</span><span class="w"> </span>No forced implementations
<span class="k">-</span><span class="w"> </span>Flexible interface composition
<span class="k">-</span><span class="w"> </span>Easier to test and mock

<span class="gu">### How to Apply ISP</span>

<span class="k">-</span><span class="w"> </span><span class="gs">**Break down interfaces**</span>: One interface per client concern
<span class="k">-</span><span class="w"> </span><span class="gs">**Ask &quot;who uses this?&quot;**</span>: Design interfaces for specific clients
<span class="k">-</span><span class="w"> </span><span class="gs">**Prefer small interfaces**</span>: Easier to implement and test
<span class="k">-</span><span class="w"> </span><span class="gs">**Use role-based interfaces**</span>: Name based on what role is played
<span class="k">-</span><span class="w"> </span><span class="gs">**Multiple inheritance**</span>: Implement multiple focused interfaces

---

<span class="gu">## D - Dependency Inversion Principle (DIP)</span>

<span class="gs">**Definition**</span>: High-level modules should not depend on low-level modules. Both should depend on abstractions. Additionally, abstractions should not depend on details; details should depend on abstractions.

<span class="gu">### The Problem (Violation)</span>

<span class="sb">```python</span>
<span class="c1"># Bad: High-level depends on low-level (concrete)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MySQLDatabase</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Direct database operations</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">MySQLDatabase</span><span class="p">()</span>  <span class="c1"># Hard coupling</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">User</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">save_user</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">user</span>

<span class="c1"># Testing requires a real database</span>
<span class="n">service</span> <span class="o">=</span> <span class="n">UserService</span><span class="p">()</span>  <span class="c1"># Must have MySQL available</span>
<span class="sb">```</span>

<span class="gs">**Problems**</span>:
<span class="k">-</span><span class="w"> </span>High-level UserService depends on low-level MySQLDatabase
<span class="k">-</span><span class="w"> </span>Hard coupling makes testing difficult
<span class="k">-</span><span class="w"> </span>Changing database requires modifying UserService
<span class="k">-</span><span class="w"> </span>Violates Open/Closed Principle

<span class="gu">### The Solution</span>

<span class="sb">```python</span>
<span class="c1"># Good: Both depend on abstraction</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserRepository</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MySQLDatabase</span><span class="p">(</span><span class="n">UserRepository</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Database operations</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PostgresDatabase</span><span class="p">(</span><span class="n">UserRepository</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Database operations</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repository</span><span class="p">:</span> <span class="n">UserRepository</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span> <span class="o">=</span> <span class="n">repository</span>  <span class="c1"># Depends on abstraction</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">User</span><span class="p">:</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">save_user</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">user</span>

<span class="c1"># Testing with mock</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MockRepository</span><span class="p">(</span><span class="n">UserRepository</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

<span class="n">service</span> <span class="o">=</span> <span class="n">UserService</span><span class="p">(</span><span class="n">MockRepository</span><span class="p">())</span>  <span class="c1"># Easy to test</span>
<span class="sb">```</span>

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>High-level modules independent of low-level details
<span class="k">-</span><span class="w"> </span>Easy to swap implementations
<span class="k">-</span><span class="w"> </span>Easy to test with mocks
<span class="k">-</span><span class="w"> </span>Supports Open/Closed and Liskov principles

<span class="gu">### Dependency Injection Container</span>

<span class="sb">```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DIContainer</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_services</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">implementation</span><span class="p">:</span> <span class="nb">type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_services</span><span class="p">[</span><span class="n">interface</span><span class="p">]</span> <span class="o">=</span> <span class="n">implementation</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">:</span> <span class="nb">type</span><span class="p">):</span>
        <span class="n">implementation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_services</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">implementation</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No implementation for </span><span class="si">{</span><span class="n">interface</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">implementation</span><span class="p">()</span>

<span class="c1"># Usage</span>
<span class="n">container</span> <span class="o">=</span> <span class="n">DIContainer</span><span class="p">()</span>
<span class="n">container</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">UserRepository</span><span class="p">,</span> <span class="n">MySQLDatabase</span><span class="p">)</span>

<span class="n">repository</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">UserRepository</span><span class="p">)</span>
<span class="n">service</span> <span class="o">=</span> <span class="n">UserService</span><span class="p">(</span><span class="n">repository</span><span class="p">)</span>
<span class="sb">```</span>

---

<span class="gu">## How SOLID Principles Work Together</span>

<span class="sb">```python</span>
<span class="c1"># Complete example following all SOLID principles</span>

<span class="c1"># S - Each class has single responsibility</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EmailValidator</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span> <span class="k">pass</span>

<span class="c1"># O - Extensible through abstraction</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NotificationStrategy</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">EmailNotification</span><span class="p">(</span><span class="n">NotificationStrategy</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SMSNotification</span><span class="p">(</span><span class="n">NotificationStrategy</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="k">pass</span>

<span class="c1"># L - Substitutable implementations</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserRepository</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DatabaseRepository</span><span class="p">(</span><span class="n">UserRepository</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="k">pass</span>

<span class="c1"># I - Segregated interfaces</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Authenticatable</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">credentials</span><span class="p">):</span> <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Notifiable</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">notify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span> <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">User</span><span class="p">(</span><span class="n">Authenticatable</span><span class="p">,</span> <span class="n">Notifiable</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">credentials</span><span class="p">):</span> <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">notify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span> <span class="k">pass</span>

<span class="c1"># D - Depends on abstractions</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">repository</span><span class="p">:</span> <span class="n">UserRepository</span><span class="p">,</span>
                 <span class="n">validator</span><span class="p">:</span> <span class="n">EmailValidator</span><span class="p">,</span>
                 <span class="n">notification</span><span class="p">:</span> <span class="n">NotificationStrategy</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span> <span class="o">=</span> <span class="n">repository</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validator</span> <span class="o">=</span> <span class="n">validator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notification</span> <span class="o">=</span> <span class="n">notification</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">User</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validator</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">email</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid email&quot;</span><span class="p">)</span>

        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notification</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">user</span>
<span class="sb">```</span>

---

<span class="gu">## Common Mistakes with SOLID</span>

<span class="k">-</span><span class="w"> </span><span class="gs">**Overapplying SRP**</span>: Breaking code into too many tiny classes
<span class="k">-</span><span class="w"> </span><span class="gs">**Premature abstraction**</span>: Abstracting before understanding the domain
<span class="k">-</span><span class="w"> </span><span class="gs">**Ignoring context**</span>: SOLID is guidance, not dogma
<span class="k">-</span><span class="w"> </span><span class="gs">**Missing LSP**</span>: Creating incorrect inheritance hierarchies
<span class="k">-</span><span class="w"> </span><span class="gs">**Fat interfaces ignored**</span>: Not actually segregating when needed
<span class="k">-</span><span class="w"> </span><span class="gs">**Circular dependencies**</span>: Dependencies still forming cycles despite DIP

<span class="gu">## When NOT to Use SOLID</span>

<span class="k">-</span><span class="w"> </span>Simple scripts and throwaway code
<span class="k">-</span><span class="w"> </span>Prototypes and experiments
<span class="k">-</span><span class="w"> </span>Extremely time-constrained situations
<span class="k">-</span><span class="w"> </span>When team doesn&#39;t understand principles yet
<span class="k">-</span><span class="w"> </span>Over-engineering trivial domains

Start with simple code. Apply SOLID when complexity demands it.
</code></pre></div></td></tr></table></div>
</div>
        </details>
        </div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01JQWyXZBwdiw3q1udTy7muf"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:45:57.939Z' data-duration='took 170 ms'>2025-11-07 10:45:57</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>File created successfully at: /root/Claude/claude-factory/skills/clean-code-design-patterns/references/solid_principles.md ...</pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:46:01.180Z'>2025-11-07 10:46:01</span>
                </div>
                
                <span class='token-usage'>Input: 1 | Output: 1 | Cache Creation: 4296 | Cache Read: 39572</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Now let me create the clean code checklist reference:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01FTsWksiFxAfMuNxhd12mMk">üìù Write <span class='tool-summary'>/root/Claude/claude-factory/skills/clean-code-design-patterns/references/clean_code_checklist.md</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:46:26.698Z'>2025-11-07 10:46:26</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='write-tool-content'>
        <details class='collapsible-code'>
            <summary>
                <span class='line-count'>266 lines</span>
                <div class='preview-content'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gh"># Clean Code Checklist</span>

A practical checklist for evaluating and ensuring code quality at a senior level.

<span class="gu">## Naming Conventions</span>
</code></pre></div></td></tr></table></div>
</div>
            </summary>
            <div class='code-full'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gh"># Clean Code Checklist</span>

A practical checklist for evaluating and ensuring code quality at a senior level.

<span class="gu">## Naming Conventions</span>

<span class="k">- [ ]</span> Variable names are pronounceable and searchable
<span class="k">- [ ]</span> Function names clearly describe what they do (verb + noun)
<span class="k">- [ ]</span> Class names are nouns, verbs are avoided
<span class="k">- [ ]</span> Boolean names start with &quot;is&quot;, &quot;has&quot;, &quot;can&quot;, &quot;should&quot;
<span class="k">- [ ]</span> No single-letter variables except loop counters (i, j, k)
<span class="k">- [ ]</span> Abbreviations are minimized or avoided
<span class="k">- [ ]</span> Names use domain language and business terminology
<span class="k">- [ ]</span> No misleading names or names similar to other common names
<span class="k">- [ ]</span> Names don&#39;t encode type information (no &quot;userString&quot;, &quot;userArray&quot;)
<span class="k">- [ ]</span> Constants are UPPER_SNAKE_CASE
<span class="k">- [ ]</span> Methods and variables are camelCase or snake_case (consistent)

<span class="gu">## Function/Method Quality</span>

<span class="k">- [ ]</span> Methods do one thing well
<span class="k">- [ ]</span> Methods are less than 20 lines (ideally)
<span class="k">- [ ]</span> Methods have 3 or fewer parameters
<span class="k">- [ ]</span> No boolean parameters (use separate methods instead)
<span class="k">- [ ]</span> Output parameters avoided (return values preferred)
<span class="k">- [ ]</span> Method name matches what it does
<span class="k">- [ ]</span> No temporal coupling (methods called in specific order)
<span class="k">- [ ]</span> Deeply nested code is refactored (max 2-3 levels)
<span class="k">- [ ]</span> Extract helper methods for complex logic
<span class="k">- [ ]</span> No side effects (method does only what name suggests)
<span class="k">- [ ]</span> Dead code is removed
<span class="k">- [ ]</span> Methods have clear error handling

<span class="gu">## Class/Module Quality</span>

<span class="k">- [ ]</span> Class has single responsibility
<span class="k">- [ ]</span> Class is cohesive (fields used by most methods)
<span class="k">- [ ]</span> Class is less than 200 lines
<span class="k">- [ ]</span> Public interface is clear and minimal
<span class="k">- [ ]</span> Tight coupling is eliminated
<span class="k">- [ ]</span> Dependencies are injected, not created
<span class="k">- [ ]</span> Class can be tested in isolation
<span class="k">- [ ]</span> No &quot;God objects&quot; (classes doing too much)
<span class="k">- [ ]</span> Inheritance is used correctly (is-a relationship)
<span class="k">- [ ]</span> Composition is preferred over inheritance

<span class="gu">## Comments and Documentation</span>

<span class="k">- [ ]</span> Code is self-explanatory (readable without comments)
<span class="k">- [ ]</span> Comments explain &quot;why&quot;, not &quot;what&quot;
<span class="k">- [ ]</span> No commented-out code (use version control)
<span class="k">- [ ]</span> No misleading or obsolete comments
<span class="k">- [ ]</span> Complex algorithms have explanatory comments
<span class="k">- [ ]</span> Public APIs have documentation
<span class="k">- [ ]</span> Assumptions are documented
<span class="k">- [ ]</span> Non-obvious performance implications are noted
<span class="k">- [ ]</span> Workarounds are explained with ticket references

<span class="gu">## Error Handling</span>

<span class="k">- [ ]</span> No silent failures or swallowed exceptions
<span class="k">- [ ]</span> Specific exceptions caught, not generic Exception
<span class="k">- [ ]</span> Error messages provide context
<span class="k">- [ ]</span> Errors are logged appropriately
<span class="k">- [ ]</span> Resource cleanup is guaranteed (try/finally or try/with)
<span class="k">- [ ]</span> No returning error codes
<span class="k">- [ ]</span> Null/None values are handled explicitly
<span class="k">- [ ]</span> Preconditions are validated
<span class="k">- [ ]</span> Postconditions are verified

<span class="gu">## Code Organization</span>

<span class="k">- [ ]</span> Imports are organized logically
<span class="k">- [ ]</span> No circular dependencies
<span class="k">- [ ]</span> Related code is grouped together
<span class="k">- [ ]</span> Public methods are before private methods
<span class="k">- [ ]</span> Related methods are together
<span class="k">- [ ]</span> Vertical spacing separates concepts
<span class="k">- [ ]</span> No unnecessary horizontal scrolling
<span class="k">- [ ]</span> Lines are less than 120 characters
<span class="k">- [ ]</span> Consistent indentation (spaces, not tabs)
<span class="k">- [ ]</span> Files follow naming conventions

<span class="gu">## Testing</span>

<span class="k">- [ ]</span> Code is testable (low coupling)
<span class="k">- [ ]</span> Test coverage is meaningful (70%+)
<span class="k">- [ ]</span> Tests have clear names describing what they test
<span class="k">- [ ]</span> Tests are independent (no execution order dependency)
<span class="k">- [ ]</span> No brittle tests (testing implementation, not behavior)
<span class="k">- [ ]</span> Mocks/stubs used appropriately
<span class="k">- [ ]</span> Edge cases are tested
<span class="k">- [ ]</span> Error conditions are tested
<span class="k">- [ ]</span> Tests don&#39;t depend on specific timing
<span class="k">- [ ]</span> Assertions are clear and specific

<span class="gu">## SOLID Principles</span>

<span class="gu">### Single Responsibility Principle</span>

<span class="k">- [ ]</span> Class has one reason to change
<span class="k">- [ ]</span> Methods have one responsibility
<span class="k">- [ ]</span> No mixing of concerns
<span class="k">- [ ]</span> Easy to describe class purpose in one sentence

<span class="gu">### Open/Closed Principle</span>

<span class="k">- [ ]</span> New functionality doesn&#39;t require modifying existing code
<span class="k">- [ ]</span> Extension points are well-designed
<span class="k">- [ ]</span> No type-based conditionals (use polymorphism)
<span class="k">- [ ]</span> Abstractions enable extension

<span class="gu">### Liskov Substitution Principle</span>

<span class="k">- [ ]</span> Subclasses don&#39;t violate parent contracts
<span class="k">- [ ]</span> Polymorphism works as expected
<span class="k">- [ ]</span> No type checking in client code
<span class="k">- [ ]</span> Inheritance represents true is-a relationships

<span class="gu">### Interface Segregation Principle</span>

<span class="k">- [ ]</span> Interfaces are focused and small
<span class="k">- [ ]</span> No unused method implementations
<span class="k">- [ ]</span> Interfaces represent client needs
<span class="k">- [ ]</span> Multiple small interfaces preferred over fat interface

<span class="gu">### Dependency Inversion Principle</span>

<span class="k">- [ ]</span> High-level modules depend on abstractions
<span class="k">- [ ]</span> Dependencies are injected
<span class="k">- [ ]</span> No new-ing up dependencies in constructors
<span class="k">- [ ]</span> Easy to swap implementations for testing

<span class="gu">## Performance and Scalability</span>

<span class="k">- [ ]</span> No premature optimization
<span class="k">- [ ]</span> Performance-critical code is profiled
<span class="k">- [ ]</span> Algorithm complexity is appropriate
<span class="k">- [ ]</span> Database queries are optimized
<span class="k">- [ ]</span> Memory is managed appropriately
<span class="k">- [ ]</span> No n+1 query problems
<span class="k">- [ ]</span> Caching is used appropriately
<span class="k">- [ ]</span> No blocking operations in async code

<span class="gu">## Security</span>

<span class="k">- [ ]</span> User input is validated
<span class="k">- [ ]</span> No SQL injection vulnerabilities
<span class="k">- [ ]</span> No XSS vulnerabilities
<span class="k">- [ ]</span> Sensitive data is not logged
<span class="k">- [ ]</span> No hardcoded credentials
<span class="k">- [ ]</span> API keys/secrets use environment variables
<span class="k">- [ ]</span> Access control is implemented
<span class="k">- [ ]</span> Data is encrypted where needed

<span class="gu">## Language-Specific</span>

<span class="gu">### Python</span>
<span class="k">- [ ]</span> Follows PEP 8 style guide
<span class="k">- [ ]</span> Type hints used where beneficial
<span class="k">- [ ]</span> Context managers used for resources
<span class="k">- [ ]</span> No bare except clauses
<span class="k">- [ ]</span> Properties used for encapsulation
<span class="k">- [ ]</span> Decorators used appropriately

<span class="gu">### JavaScript/TypeScript</span>
<span class="k">- [ ]</span> No var (use const/let)
<span class="k">- [ ]</span> Async/await used over callbacks
<span class="k">- [ ]</span> Type definitions available (TypeScript)
<span class="k">- [ ]</span> No hoisting surprises
<span class="k">- [ ]</span> Promises handled properly
<span class="k">- [ ]</span> No memory leaks from closures

<span class="gu">### Java</span>
<span class="k">- [ ]</span> Generics used for type safety
<span class="k">- [ ]</span> Checked exceptions handled appropriately
<span class="k">- [ ]</span> Immutable objects where possible
<span class="k">- [ ]</span> Enums used for constants
<span class="k">- [ ]</span> Streams used for collection operations

<span class="gu">## Code Review Checklist</span>

Before submitting for review:

<span class="k">- [ ]</span> Code builds without warnings
<span class="k">- [ ]</span> All tests pass
<span class="k">- [ ]</span> Code follows project style guide
<span class="k">- [ ]</span> No debugging code left in
<span class="k">- [ ]</span> No console.log/print statements (use logging)
<span class="k">- [ ]</span> Large changes are split into logical commits
<span class="k">- [ ]</span> Commit messages are clear and descriptive
<span class="k">- [ ]</span> PR/MR description explains why, not what
<span class="k">- [ ]</span> Related tests are updated
<span class="k">- [ ]</span> Documentation is updated

<span class="gu">## Refactoring Checklist</span>

Before refactoring:

<span class="k">- [ ]</span> Tests provide adequate coverage
<span class="k">- [ ]</span> Understand the current behavior
<span class="k">- [ ]</span> Have a clear goal
<span class="k">- [ ]</span> Make small changes incrementally
<span class="k">- [ ]</span> Tests pass after each change
<span class="k">- [ ]</span> Commit frequently

<span class="gu">## Anti-Patterns to Watch For</span>

<span class="k">- [ ]</span> Long methods (extract smaller methods)
<span class="k">- [ ]</span> Large classes (split responsibilities)
<span class="k">- [ ]</span> Long parameter lists (use objects)
<span class="k">- [ ]</span> Duplicate code (extract to shared method)
<span class="k">- [ ]</span> Switch statements (use polymorphism)
<span class="k">- [ ]</span> Temporary fields (use separate class)
<span class="k">- [ ]</span> Feature envy (move to object that owns the data)
<span class="k">- [ ]</span> Data clumps (group data into objects)
<span class="k">- [ ]</span> Primitive obsession (use domain objects)
<span class="k">- [ ]</span> Lazy classes (remove or consolidate)
<span class="k">- [ ]</span> Speculative generality (YAGNI principle)
<span class="k">- [ ]</span> Parallel inheritance hierarchies (consolidate)

<span class="gu">## Design Review Checklist</span>

For significant features or modules:

<span class="k">- [ ]</span> Architecture is clearly understood
<span class="k">- [ ]</span> Key design decisions are documented
<span class="k">- [ ]</span> Design supports testability
<span class="k">- [ ]</span> Design supports extensibility
<span class="k">- [ ]</span> Error handling strategy is clear
<span class="k">- [ ]</span> Security implications considered
<span class="k">- [ ]</span> Performance implications considered
<span class="k">- [ ]</span> Dependencies are minimized
<span class="k">- [ ]</span> Integration points are clean
<span class="k">- [ ]</span> Team agrees on the approach

<span class="gu">## Code Quality Metrics</span>

<span class="k">-</span><span class="w"> </span><span class="gs">**Cyclomatic Complexity**</span>: Functions should be &lt; 10
<span class="k">-</span><span class="w"> </span><span class="gs">**Cognitive Complexity**</span>: Functions should be &lt; 15
<span class="k">-</span><span class="w"> </span><span class="gs">**Test Coverage**</span>: Aim for 70-80% meaningful coverage
<span class="k">-</span><span class="w"> </span><span class="gs">**Technical Debt**</span>: Track and prioritize
<span class="k">-</span><span class="w"> </span><span class="gs">**Duplication**</span>: Keep DRY, but don&#39;t over-engineer
<span class="k">-</span><span class="w"> </span><span class="gs">**Coupling**</span>: Minimize between modules
<span class="k">-</span><span class="w"> </span><span class="gs">**Cohesion**</span>: Maximize within modules
<span class="k">-</span><span class="w"> </span><span class="gs">**Method Length**</span>: Average &lt; 15 lines
<span class="k">-</span><span class="w"> </span><span class="gs">**Class Length**</span>: Average &lt; 150 lines
<span class="k">-</span><span class="w"> </span><span class="gs">**Parameter Count**</span>: Average &lt; 3 per method

<span class="gu">## Quick Self-Review</span>

<span class="k">1.</span> <span class="gs">**Can I explain this code to a junior developer in 5 minutes?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>If no, it&#39;s too complex or unclear

<span class="k">2.</span> <span class="gs">**Would I be happy maintaining this code for the next year?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>If no, refactor it

<span class="k">3.</span> <span class="gs">**Are there at least 3 other ways to misunderstand this code?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>If yes, rename or refactor

<span class="k">4.</span> <span class="gs">**Does this violate any SOLID principle?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>If yes, refactor

<span class="k">5.</span> <span class="gs">**Can I test this without setting up a database/API?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>If no, reduce coupling
</code></pre></div></td></tr></table></div>
</div>
        </details>
        </div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01FTsWksiFxAfMuNxhd12mMk"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:46:26.897Z' data-duration='took 199 ms'>2025-11-07 10:46:26</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>File created successfully at: /root/Claude/claude-factory/skills/clean-code-design-patterns/references/clean_code_checklist.md ...</pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:46:30.443Z'>2025-11-07 10:46:30</span>
                </div>
                
                <span class='token-usage'>Input: 1 | Output: 1 | Cache Creation: 2400 | Cache Read: 43868</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Now let me create the refactoring strategies reference:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01WUjxkX2it5pojinWm8tS8h">üìù Write <span class='tool-summary'>/root/Claude/claude-factory/skills/clean-code-design-patterns/references/refactoring_strategies.md</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:46:59.225Z'>2025-11-07 10:46:59</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='write-tool-content'>
        <details class='collapsible-code'>
            <summary>
                <span class='line-count'>577 lines</span>
                <div class='preview-content'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gh"># Refactoring Strategies: Safe Techniques for Code Improvement</span>

<span class="gu">## Core Principles of Safe Refactoring</span>

<span class="k">1.</span> <span class="gs">**Green Light First**</span>: Ensure all tests pass before refactoring
</code></pre></div></td></tr></table></div>
</div>
            </summary>
            <div class='code-full'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="gh"># Refactoring Strategies: Safe Techniques for Code Improvement</span>

<span class="gu">## Core Principles of Safe Refactoring</span>

<span class="k">1.</span> <span class="gs">**Green Light First**</span>: Ensure all tests pass before refactoring
<span class="k">2.</span> <span class="gs">**Make One Change**</span>: Refactor one thing at a time
<span class="k">3.</span> <span class="gs">**Keep Tests Green**</span>: Tests should pass after each change
<span class="k">4.</span> <span class="gs">**Commit Frequently**</span>: Small commits for easy rollback
<span class="k">5.</span> <span class="gs">**Review Often**</span>: Get feedback on refactoring direction

---

<span class="gu">## Refactoring Workflow</span>

<span class="gu">### Pre-Refactoring Checklist</span>

<span class="k">- [ ]</span> Understand what the code does
<span class="k">- [ ]</span> Tests cover the code (70%+ coverage)
<span class="k">- [ ]</span> No active development on this code
<span class="k">- [ ]</span> Clear goal for refactoring
<span class="k">- [ ]</span> Team awareness of changes
<span class="k">- [ ]</span> Have escape plan if things go wrong

<span class="gu">### Refactoring Phases</span>

<span class="k">1.</span> <span class="gs">**Analysis**</span>: Identify pain points
<span class="k">2.</span> <span class="gs">**Planning**</span>: Determine safest approach
<span class="k">3.</span> <span class="gs">**Execution**</span>: Make changes incrementally
<span class="k">4.</span> <span class="gs">**Verification**</span>: Ensure behavior unchanged
<span class="k">5.</span> <span class="gs">**Optimization**</span>: Improve performance if needed
<span class="k">6.</span> <span class="gs">**Documentation**</span>: Update documentation

---

<span class="gu">## Common Refactoring Techniques</span>

<span class="gu">### 1. Extract Method</span>

<span class="gs">**Goal**</span>: Break long methods into smaller, focused methods

<span class="gs">**Before**</span>:
<span class="sb">```python</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_total_price</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
        <span class="c1"># Complex calculation</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_taxable</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">item</span><span class="o">.</span><span class="n">price</span> <span class="o">*</span> <span class="mf">1.08</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">item</span><span class="o">.</span><span class="n">price</span>

        <span class="c1"># Apply discount</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">quantity</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">-=</span> <span class="n">total</span> <span class="o">*</span> <span class="mf">0.1</span>
        <span class="k">elif</span> <span class="n">item</span><span class="o">.</span><span class="n">quantity</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">-=</span> <span class="n">total</span> <span class="o">*</span> <span class="mf">0.05</span>

        <span class="c1"># Apply loyalty discount</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">customer</span><span class="o">.</span><span class="n">is_loyal</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">-=</span> <span class="n">total</span> <span class="o">*</span> <span class="mf">0.02</span>

    <span class="k">return</span> <span class="n">total</span>
<span class="sb">```</span>

<span class="gs">**After**</span>:
<span class="sb">```python</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_total_price</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_item_price</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_discounts</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_calculate_item_price</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="n">price</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">price</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_taxable</span><span class="p">:</span>
        <span class="n">price</span> <span class="o">*=</span> <span class="mf">1.08</span>
    <span class="k">return</span> <span class="n">price</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_apply_discounts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">subtotal</span><span class="p">):</span>
    <span class="n">discount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quantity_discount</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">quantity</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">customer</span><span class="o">.</span><span class="n">is_loyal</span><span class="p">:</span>
        <span class="n">discount</span> <span class="o">+=</span> <span class="mf">0.02</span>
    <span class="k">return</span> <span class="n">subtotal</span> <span class="o">*</span> <span class="n">discount</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_quantity_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantity</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">quantity</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.1</span>
    <span class="k">elif</span> <span class="n">quantity</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.05</span>
    <span class="k">return</span> <span class="mi">0</span>
<span class="sb">```</span>

<span class="gs">**Steps**</span>:
<span class="k">1.</span> Identify logical chunks of code
<span class="k">2.</span> Create new method with clear name
<span class="k">3.</span> Move chunk into new method
<span class="k">4.</span> Run tests
<span class="k">5.</span> Repeat

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Methods become focused and testable
<span class="k">-</span><span class="w"> </span>Logic becomes reusable
<span class="k">-</span><span class="w"> </span>Complex logic becomes understandable

---

<span class="gu">### 2. Rename for Clarity</span>

<span class="gs">**Goal**</span>: Use clearer names that reveal intent

<span class="gs">**Before**</span>:
<span class="sb">```python</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fn</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">validate</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">create_sess</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">usr</span> <span class="o">=</span> <span class="n">find_user</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">usr</span> <span class="ow">and</span> <span class="n">usr</span><span class="o">.</span><span class="n">pwd</span> <span class="o">==</span> <span class="n">hash_pwd</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
<span class="sb">```</span>

<span class="gs">**After**</span>:
<span class="sb">```python</span>
<span class="k">def</span><span class="w"> </span><span class="nf">authenticate_user</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">is_valid_credentials</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">create_session</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span><span class="w"> </span><span class="nf">is_valid_credentials</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">find_user</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">user</span> <span class="ow">and</span> <span class="n">user</span><span class="o">.</span><span class="n">password</span> <span class="o">==</span> <span class="n">hash_password</span><span class="p">(</span><span class="n">password</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
<span class="sb">```</span>

<span class="gs">**Steps**</span>:
<span class="k">1.</span> Use IDE refactoring (rename all occurrences)
<span class="k">2.</span> Run tests to verify
<span class="k">3.</span> Commit

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Code becomes self-documenting
<span class="k">-</span><span class="w"> </span>Intent is clear
<span class="k">-</span><span class="w"> </span>Easier to understand and maintain

---

<span class="gu">### 3. Remove Duplication</span>

<span class="gs">**Goal**</span>: Consolidate repeated code into reusable functions

<span class="gs">**Before**</span>:
<span class="sb">```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ReportGenerator</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_sales_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM sales WHERE date &gt;= DATE_SUB(NOW(), INTERVAL 30 DAY)&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">format_report</span><span class="p">(</span><span class="s2">&quot;Sales Report&quot;</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_customer_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM customers WHERE created &gt;= DATE_SUB(NOW(), INTERVAL 30 DAY)&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">format_report</span><span class="p">(</span><span class="s2">&quot;Customer Report&quot;</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">total</span><span class="p">):</span>
        <span class="c1"># Common formatting logic</span>
        <span class="k">pass</span>
<span class="sb">```</span>

<span class="gs">**After**</span>:
<span class="sb">```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ReportGenerator</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_sales_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_recent_records</span><span class="p">(</span><span class="s2">&quot;sales&quot;</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_report</span><span class="p">(</span><span class="s2">&quot;Sales Report&quot;</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_customer_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_recent_records</span><span class="p">(</span><span class="s2">&quot;customers&quot;</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_report</span><span class="p">(</span><span class="s2">&quot;Customer Report&quot;</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_recent_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2"> WHERE created &gt;= DATE_SUB(NOW(), INTERVAL 30 DAY)&quot;</span>
        <span class="k">return</span> <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">total</span><span class="p">):</span>
        <span class="c1"># Common formatting logic</span>
        <span class="k">pass</span>
<span class="sb">```</span>

<span class="gs">**Steps**</span>:
<span class="k">1.</span> Identify repeated patterns
<span class="k">2.</span> Extract to helper method
<span class="k">3.</span> Replace duplication with method calls
<span class="k">4.</span> Run tests
<span class="k">5.</span> Commit

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Single source of truth
<span class="k">-</span><span class="w"> </span>Easier to maintain
<span class="k">-</span><span class="w"> </span>Reduces bugs from inconsistency

---

<span class="gu">### 4. Extract Class</span>

<span class="gs">**Goal**</span>: Break large class into smaller, focused classes

<span class="gs">**Before**</span>:
<span class="sb">```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserManager</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="c1"># Authentication logic</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">authorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="c1"># Authorization logic</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_access</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="c1"># Logging logic</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">send_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="c1"># Notification logic</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email</span><span class="p">):</span>
        <span class="c1"># Validation logic</span>
        <span class="k">pass</span>
<span class="sb">```</span>

<span class="gs">**After**</span>:
<span class="sb">```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Authenticator</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="c1"># Authentication logic</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Authorizer</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">authorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="c1"># Authorization logic</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AccessLogger</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">log_access</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>
        <span class="c1"># Logging logic</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NotificationService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">send_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="c1"># Notification logic</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">EmailValidator</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email</span><span class="p">):</span>
        <span class="c1"># Validation logic</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">UserManager</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">authenticator</span><span class="p">,</span> <span class="n">authorizer</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span>
                 <span class="n">notifications</span><span class="p">,</span> <span class="n">validator</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authenticator</span> <span class="o">=</span> <span class="n">authenticator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorizer</span> <span class="o">=</span> <span class="n">authorizer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notifications</span> <span class="o">=</span> <span class="n">notifications</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validator</span> <span class="o">=</span> <span class="n">validator</span>
<span class="sb">```</span>

<span class="gs">**Steps**</span>:
<span class="k">1.</span> Identify distinct responsibilities
<span class="k">2.</span> Create new class for responsibility
<span class="k">3.</span> Move methods to new class
<span class="k">4.</span> Add dependency to original class
<span class="k">5.</span> Update clients gradually
<span class="k">6.</span> Run tests after each step
<span class="k">7.</span> Remove original methods

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Single Responsibility Principle
<span class="k">-</span><span class="w"> </span>Easier to test
<span class="k">-</span><span class="w"> </span>Easier to reuse components
<span class="k">-</span><span class="w"> </span>Clearer code organization

---

<span class="gu">### 5. Replace Conditional with Polymorphism</span>

<span class="gs">**Goal**</span>: Replace type-based conditionals with polymorphic dispatch

<span class="gs">**Before**</span>:
<span class="sb">```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PaymentProcessor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process_payment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payment</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">payment</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;credit_card&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_credit_card</span><span class="p">(</span><span class="n">payment</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">payment</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;paypal&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_paypal</span><span class="p">(</span><span class="n">payment</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">payment</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;bank_transfer&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_bank_transfer</span><span class="p">(</span><span class="n">payment</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown payment type: </span><span class="si">{</span><span class="n">payment</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_process_credit_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payment</span><span class="p">):</span>
        <span class="c1"># Implementation</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_process_paypal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payment</span><span class="p">):</span>
        <span class="c1"># Implementation</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_process_bank_transfer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payment</span><span class="p">):</span>
        <span class="c1"># Implementation</span>
        <span class="k">pass</span>
<span class="sb">```</span>

<span class="gs">**After**</span>:
<span class="sb">```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PaymentHandler</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payment</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CreditCardHandler</span><span class="p">(</span><span class="n">PaymentHandler</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payment</span><span class="p">):</span>
        <span class="c1"># Implementation</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PayPalHandler</span><span class="p">(</span><span class="n">PaymentHandler</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payment</span><span class="p">):</span>
        <span class="c1"># Implementation</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">BankTransferHandler</span><span class="p">(</span><span class="n">PaymentHandler</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payment</span><span class="p">):</span>
        <span class="c1"># Implementation</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">PaymentProcessor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;credit_card&quot;</span><span class="p">:</span> <span class="n">CreditCardHandler</span><span class="p">(),</span>
            <span class="s2">&quot;paypal&quot;</span><span class="p">:</span> <span class="n">PayPalHandler</span><span class="p">(),</span>
            <span class="s2">&quot;bank_transfer&quot;</span><span class="p">:</span> <span class="n">BankTransferHandler</span><span class="p">(),</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_payment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payment</span><span class="p">):</span>
        <span class="n">handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">payment</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">handler</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown payment type: </span><span class="si">{</span><span class="n">payment</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">handler</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">payment</span><span class="p">)</span>
<span class="sb">```</span>

<span class="gs">**Steps**</span>:
<span class="k">1.</span> Create abstract base class for handlers
<span class="k">2.</span> Create concrete handler for each type
<span class="k">3.</span> Create factory or registry
<span class="k">4.</span> Update conditional to use registry
<span class="k">5.</span> Run tests
<span class="k">6.</span> Remove old methods

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Open/Closed Principle
<span class="k">-</span><span class="w"> </span>Easy to add new types
<span class="k">-</span><span class="w"> </span>Easier to test
<span class="k">-</span><span class="w"> </span>Cleaner code

---

<span class="gu">### 6. Introduce Parameter Object</span>

<span class="gs">**Goal**</span>: Group related parameters into object

<span class="gs">**Before**</span>:
<span class="sb">```python</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">phone</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">zip_code</span><span class="p">):</span>
    <span class="c1"># Many parameters, some grouped logically</span>
    <span class="k">pass</span>

<span class="n">user</span> <span class="o">=</span> <span class="n">create_user</span><span class="p">(</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="s2">&quot;alice@example.com&quot;</span><span class="p">,</span> <span class="s2">&quot;555-1234&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;123 Main St&quot;</span><span class="p">,</span> <span class="s2">&quot;Springfield&quot;</span><span class="p">,</span> <span class="s2">&quot;IL&quot;</span><span class="p">,</span> <span class="s2">&quot;62701&quot;</span><span class="p">)</span>
<span class="sb">```</span>

<span class="gs">**After**</span>:
<span class="sb">```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UserInfo</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">phone</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="n">email</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phone</span> <span class="o">=</span> <span class="n">phone</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Address</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">street</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">zip_code</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">street</span> <span class="o">=</span> <span class="n">street</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">city</span> <span class="o">=</span> <span class="n">city</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zip_code</span> <span class="o">=</span> <span class="n">zip_code</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">(</span><span class="n">user_info</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>
    <span class="c1"># Clearer parameters</span>
    <span class="k">pass</span>

<span class="n">user_info</span> <span class="o">=</span> <span class="n">UserInfo</span><span class="p">(</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="s2">&quot;alice@example.com&quot;</span><span class="p">,</span> <span class="s2">&quot;555-1234&quot;</span><span class="p">)</span>
<span class="n">address</span> <span class="o">=</span> <span class="n">Address</span><span class="p">(</span><span class="s2">&quot;123 Main St&quot;</span><span class="p">,</span> <span class="s2">&quot;Springfield&quot;</span><span class="p">,</span> <span class="s2">&quot;IL&quot;</span><span class="p">,</span> <span class="s2">&quot;62701&quot;</span><span class="p">)</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">create_user</span><span class="p">(</span><span class="n">user_info</span><span class="p">,</span> <span class="n">address</span><span class="p">)</span>
<span class="sb">```</span>

<span class="gs">**Steps**</span>:
<span class="k">1.</span> Create class for grouped parameters
<span class="k">2.</span> Add parameters to class constructor
<span class="k">3.</span> Update method signature
<span class="k">4.</span> Update callers
<span class="k">5.</span> Run tests
<span class="k">6.</span> Commit

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Fewer parameters
<span class="k">-</span><span class="w"> </span>More cohesive data
<span class="k">-</span><span class="w"> </span>Easier to extend
<span class="k">-</span><span class="w"> </span>Better testability

---

<span class="gu">### 7. Replace Magic Numbers with Named Constants</span>

<span class="gs">**Goal**</span>: Make numeric values self-documenting

<span class="gs">**Before**</span>:
<span class="sb">```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DiscountCalculator</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantity</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">quantity</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.20</span>
        <span class="k">elif</span> <span class="n">quantity</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.15</span>
        <span class="k">elif</span> <span class="n">quantity</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.10</span>
        <span class="k">return</span> <span class="mi">0</span>
<span class="sb">```</span>

<span class="gs">**After**</span>:
<span class="sb">```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DiscountCalculator</span><span class="p">:</span>
    <span class="n">LARGE_ORDER_THRESHOLD</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">LARGE_ORDER_DISCOUNT</span> <span class="o">=</span> <span class="mf">0.20</span>

    <span class="n">MEDIUM_ORDER_THRESHOLD</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">MEDIUM_ORDER_DISCOUNT</span> <span class="o">=</span> <span class="mf">0.15</span>

    <span class="n">SMALL_ORDER_THRESHOLD</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">SMALL_ORDER_DISCOUNT</span> <span class="o">=</span> <span class="mf">0.10</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantity</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">quantity</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">LARGE_ORDER_THRESHOLD</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">LARGE_ORDER_DISCOUNT</span>
        <span class="k">elif</span> <span class="n">quantity</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">MEDIUM_ORDER_THRESHOLD</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">MEDIUM_ORDER_DISCOUNT</span>
        <span class="k">elif</span> <span class="n">quantity</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SMALL_ORDER_THRESHOLD</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SMALL_ORDER_DISCOUNT</span>
        <span class="k">return</span> <span class="mi">0</span>
<span class="sb">```</span>

<span class="gs">**Steps**</span>:
<span class="k">1.</span> Identify magic numbers
<span class="k">2.</span> Create named constants
<span class="k">3.</span> Replace occurrences
<span class="k">4.</span> Run tests

<span class="gs">**Benefits**</span>:
<span class="k">-</span><span class="w"> </span>Self-documenting code
<span class="k">-</span><span class="w"> </span>Single location for configuration
<span class="k">-</span><span class="w"> </span>Easier to understand intent

---

<span class="gu">## Refactoring Patterns by Problem Type</span>

<span class="gu">### Code Smell: Long Method</span>

<span class="gs">**Strategies**</span>:
<span class="k">1.</span> Extract Method
<span class="k">2.</span> Replace Temp with Query
<span class="k">3.</span> Introduce Parameter Object
<span class="k">4.</span> Replace Conditional with Polymorphism

<span class="gu">### Code Smell: Large Class</span>

<span class="gs">**Strategies**</span>:
<span class="k">1.</span> Extract Class
<span class="k">2.</span> Extract Interface
<span class="k">3.</span> Rename for clarity
<span class="k">4.</span> Remove Duplication

<span class="gu">### Code Smell: Duplicate Code</span>

<span class="gs">**Strategies**</span>:
<span class="k">1.</span> Extract Method
<span class="k">2.</span> Extract Class
<span class="k">3.</span> Pull Up Method (to parent class)
<span class="k">4.</span> Template Method Pattern

<span class="gu">### Code Smell: Complex Conditionals</span>

<span class="gs">**Strategies**</span>:
<span class="k">1.</span> Replace Conditional with Polymorphism
<span class="k">2.</span> Extract Method
<span class="k">3.</span> Use Strategy Pattern
<span class="k">4.</span> Replace Magic Numbers with Constants

<span class="gu">### Code Smell: Primitive Obsession</span>

<span class="gs">**Strategies**</span>:
<span class="k">1.</span> Introduce Parameter Object
<span class="k">2.</span> Create Domain Object
<span class="k">3.</span> Replace Type Code with Class

<span class="gu">### Code Smell: Feature Envy</span>

<span class="gs">**Strategies**</span>:
<span class="k">1.</span> Move Method
<span class="k">2.</span> Extract Method
<span class="k">3.</span> Change Visibility

---

<span class="gu">## When NOT to Refactor</span>

<span class="k">-</span><span class="w"> </span>Code is working and nobody maintains it
<span class="k">-</span><span class="w"> </span>Tests don&#39;t adequately cover the code
<span class="k">-</span><span class="w"> </span>Timeline is critical
<span class="k">-</span><span class="w"> </span>Team is unfamiliar with the codebase
<span class="k">-</span><span class="w"> </span>Refactoring direction is unclear
<span class="k">-</span><span class="w"> </span>No clear benefit expected

---

<span class="gu">## Refactoring Mistakes to Avoid</span>

<span class="k">-</span><span class="w"> </span>Mixing refactoring with feature development
<span class="k">-</span><span class="w"> </span>Large refactoring without tests
<span class="k">-</span><span class="w"> </span>Changing behavior while refactoring
<span class="k">-</span><span class="w"> </span>Over-engineering during refactoring
<span class="k">-</span><span class="w"> </span>Not committing frequently enough
<span class="k">-</span><span class="w"> </span>Not getting code review on refactoring
<span class="k">-</span><span class="w"> </span>Refactoring without clear goal
<span class="k">-</span><span class="w"> </span>Skipping tests during refactoring

---

<span class="gu">## Measuring Refactoring Success</span>

<span class="gs">**Code Quality Metrics**</span>:
<span class="k">-</span><span class="w"> </span>Reduced cyclomatic complexity
<span class="k">-</span><span class="w"> </span>Fewer duplications (DRY score)
<span class="k">-</span><span class="w"> </span>Reduced coupling
<span class="k">-</span><span class="w"> </span>Improved cohesion
<span class="k">-</span><span class="w"> </span>Reduced method/class length

<span class="gs">**Team Metrics**</span>:
<span class="k">-</span><span class="w"> </span>Time to understand code decreased
<span class="k">-</span><span class="w"> </span>Time to implement features decreased
<span class="k">-</span><span class="w"> </span>Bugs found during development decreased
<span class="k">-</span><span class="w"> </span>Team confidence in code increased

<span class="gs">**Business Metrics**</span>:
<span class="k">-</span><span class="w"> </span>Faster feature development
<span class="k">-</span><span class="w"> </span>Fewer production bugs
<span class="k">-</span><span class="w"> </span>Better code review efficiency
<span class="k">-</span><span class="w"> </span>Improved team morale
</code></pre></div></td></tr></table></div>
</div>
        </details>
        </div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01WUjxkX2it5pojinWm8tS8h"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:46:59.316Z' data-duration='took 91 ms'>2025-11-07 10:46:59</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>File created successfully at: /root/Claude/claude-factory/skills/clean-code-design-patterns/references/refactoring_strategies.md ...</pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:02.935Z'>2025-11-07 10:47:02</span>
                </div>
                
                <span class='token-usage'>Input: 0 | Output: 1 | Cache Creation: 3982 | Cache Read: 46268</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Great! Now let me create the code analysis script and update the todo:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_015iXxaU6i6NhBR2KB3fJQky">üìù Todo List</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:03.906Z'>2025-11-07 10:47:03</span>
                </div>
                
            </div>
        </div>
        <div class='content'>
    <div class="todo-list">
        
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Initialize skill directory structure</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Create SKILL.md with comprehensive design pattern guidance</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Create references for design patterns and best practices</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item in_progress medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">üîÑ</span>
                    <span class="todo-content">Create scripts for code analysis and refactoring</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item pending medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">‚è≥</span>
                    <span class="todo-content">Package the skill into distributable zip</span>
                    <span class="todo-id">#</span>
                </div>
            
    </div>
    </div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_015iXxaU6i6NhBR2KB3fJQky"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:04.016Z' data-duration='took 110 ms'>2025-11-07 10:47:04</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>Todos have been modified successfully. Ensure that you continue to use the todo list to track your progress. Please proceed with the current tasks if applicable</pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:07.476Z'>2025-11-07 10:47:07</span>
                </div>
                
                <span class='token-usage'>Input: 0 | Output: 1 | Cache Creation: 259 | Cache Read: 50250</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Now let me create a comprehensive code analysis script:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01RxdpTm5ZDmkkUwqSBe8Mbb">üìù Write <span class='tool-summary'>/root/Claude/claude-factory/skills/clean-code-design-patterns/scripts/code_analyzer.py</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:34.623Z'>2025-11-07 10:47:34</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='write-tool-content'>
        <details class='collapsible-code'>
            <summary>
                <span class='line-count'>435 lines</span>
                <div class='preview-content'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Code Quality Analyzer - Senior-level code analysis tool.</span>

<span class="s2">Analyzes code for clean code violations, design pattern violations,</span>
</code></pre></div></td></tr></table></div>
</div>
            </summary>
            <div class='code-full'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Code Quality Analyzer - Senior-level code analysis tool.</span>

<span class="sd">Analyzes code for clean code violations, design pattern violations,</span>
<span class="sd">and SOLID principle adherence.</span>

<span class="sd">Usage:</span>
<span class="sd">    python code_analyzer.py &lt;file_or_directory&gt; [--verbose] [--format json|text]</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ast</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">asdict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Issue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a code quality issue.&quot;&quot;&quot;</span>
    <span class="n">file</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">line</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">column</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">severity</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># critical, error, warning, info</span>
    <span class="n">category</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">suggestion</span><span class="p">:</span> <span class="nb">str</span>


<span class="k">class</span><span class="w"> </span><span class="nc">CodeAnalyzer</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">NodeVisitor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyzes Python code for quality issues.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Issue</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_class</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Issue</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze the file and return issues.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_cross_cutting_issues</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">SyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Issue</span><span class="p">(</span>
                <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">lineno</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">column</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">offset</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="s2">&quot;syntax&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Syntax Error&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Syntax error: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Fix the syntax error&quot;</span>
            <span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">issues</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">visit_FunctionDef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check function definitions.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_function_length</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_function_complexity</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_parameter_count</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_function_naming</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_class</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">functions</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_class</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;node&#39;</span><span class="p">:</span> <span class="n">node</span><span class="p">,</span>
                <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">),</span>
                <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">args</span><span class="p">),</span>
                <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="n">node</span><span class="o">.</span><span class="n">lineno</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">functions</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;node&#39;</span><span class="p">:</span> <span class="n">node</span><span class="p">,</span>
                <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">),</span>
                <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">args</span><span class="p">),</span>
                <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="n">node</span><span class="o">.</span><span class="n">lineno</span>
            <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">visit_AsyncFunctionDef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">AsyncFunctionDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check async function definitions.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visit_FunctionDef</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">visit_ClassDef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check class definitions.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_class_size</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_class_naming</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_class_cohesion</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;node&#39;</span><span class="p">:</span> <span class="n">node</span><span class="p">,</span>
            <span class="s1">&#39;methods&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">body</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">AsyncFunctionDef</span><span class="p">))]),</span>
            <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="n">node</span><span class="o">.</span><span class="n">lineno</span>
        <span class="p">}</span>

        <span class="n">prev_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_class</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_class</span> <span class="o">=</span> <span class="n">prev_class</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_function_length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if function is too long.&quot;&quot;&quot;</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lines</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Issue</span><span class="p">(</span>
                <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="s2">&quot;complexity&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Long Method&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Function &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is </span><span class="si">{</span><span class="n">lines</span><span class="si">}</span><span class="s2"> lines long (exceeds recommended 20)&quot;</span><span class="p">,</span>
                <span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Extract smaller methods to reduce function length&quot;</span>
            <span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_function_complexity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check cyclomatic complexity.&quot;&quot;&quot;</span>
        <span class="n">complexity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_complexity</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">complexity</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Issue</span><span class="p">(</span>
                <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="s2">&quot;complexity&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;High Cyclomatic Complexity&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Function &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has complexity of </span><span class="si">{</span><span class="n">complexity</span><span class="si">}</span><span class="s2"> (exceeds recommended 10)&quot;</span><span class="p">,</span>
                <span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Reduce conditional branches using polymorphism or extract methods&quot;</span>
            <span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_parameter_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if function has too many parameters.&quot;&quot;&quot;</span>
        <span class="n">param_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">param_count</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Issue</span><span class="p">(</span>
                <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="s2">&quot;design&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Too Many Parameters&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Function &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has </span><span class="si">{</span><span class="n">param_count</span><span class="si">}</span><span class="s2"> parameters (exceeds recommended 3)&quot;</span><span class="p">,</span>
                <span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Use parameter object pattern or dependency injection&quot;</span>
            <span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_function_naming</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check function naming conventions.&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span>

        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>  <span class="c1"># Module-level private functions are OK</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Issue</span><span class="p">(</span>
                <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="s2">&quot;naming&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Unclear Function Name&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Function name &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is too short and not descriptive&quot;</span><span class="p">,</span>
                <span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Use a longer, more descriptive name that reveals intent&quot;</span>
            <span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_class_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if class is too large.&quot;&quot;&quot;</span>
        <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">body</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">AsyncFunctionDef</span><span class="p">))]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Issue</span><span class="p">(</span>
                <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="s2">&quot;design&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Large Class&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Class &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span><span class="si">}</span><span class="s2"> methods (exceeds recommended 15)&quot;</span><span class="p">,</span>
                <span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Extract responsibilities into separate classes (Single Responsibility Principle)&quot;</span>
            <span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_class_naming</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check class naming conventions.&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">islower</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Issue</span><span class="p">(</span>
                <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="s2">&quot;naming&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Incorrect Class Naming&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Class name &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; should start with uppercase letter&quot;</span><span class="p">,</span>
                <span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Rename class to follow PascalCase convention&quot;</span>
            <span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_class_cohesion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if class has low cohesion (many unrelated methods).&quot;&quot;&quot;</span>
        <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">body</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">AsyncFunctionDef</span><span class="p">))]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Simple heuristic: check if self is used in methods</span>
            <span class="n">methods_using_self</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uses_self</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
                    <span class="n">methods_using_self</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">usage_ratio</span> <span class="o">=</span> <span class="n">methods_using_self</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">usage_ratio</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Issue</span><span class="p">(</span>
                    <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                    <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
                    <span class="n">category</span><span class="o">=</span><span class="s2">&quot;design&quot;</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Low Cohesion&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Class &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has low cohesion (only </span><span class="si">{</span><span class="n">methods_using_self</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span><span class="si">}</span><span class="s2"> methods use self)&quot;</span><span class="p">,</span>
                    <span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Consider extracting unrelated methods into separate classes&quot;</span>
                <span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_cross_cutting_issues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check issues that span multiple functions/classes.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_duplicate_code_patterns</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_deep_nesting_patterns</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_duplicate_code_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check for potential duplicated code patterns.&quot;&quot;&quot;</span>
        <span class="n">function_bodies</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">func_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">body_hash</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">func_info</span><span class="p">[</span><span class="s1">&#39;node&#39;</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">body_hash</span> <span class="ow">in</span> <span class="n">function_bodies</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Issue</span><span class="p">(</span>
                    <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="n">func_info</span><span class="p">[</span><span class="s1">&#39;node&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                    <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
                    <span class="n">category</span><span class="o">=</span><span class="s2">&quot;duplication&quot;</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Potential Code Duplication&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Function &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; may be duplicating logic&quot;</span><span class="p">,</span>
                    <span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Consider extracting common logic into a shared method&quot;</span>
                <span class="p">))</span>
            <span class="n">function_bodies</span><span class="p">[</span><span class="n">body_hash</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_deep_nesting_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check for deeply nested code.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">func_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">functions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">max_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_nesting_depth</span><span class="p">(</span><span class="n">func_info</span><span class="p">[</span><span class="s1">&#39;node&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">max_depth</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Issue</span><span class="p">(</span>
                    <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="n">func_info</span><span class="p">[</span><span class="s1">&#39;node&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                    <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">severity</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
                    <span class="n">category</span><span class="o">=</span><span class="s2">&quot;complexity&quot;</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Deep Nesting&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Function &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has nesting depth of </span><span class="si">{</span><span class="n">max_depth</span><span class="si">}</span><span class="s2"> (exceeds recommended 3)&quot;</span><span class="p">,</span>
                    <span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Extract nested blocks into separate methods or use early returns&quot;</span>
                <span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_complexity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">,</span> <span class="n">complexity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate cyclomatic complexity.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">ast</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">If</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">While</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">For</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">ExceptHandler</span><span class="p">)):</span>
                <span class="n">complexity</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">BoolOp</span><span class="p">):</span>
                <span class="n">complexity</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">complexity</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_nesting_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">AST</span><span class="p">,</span> <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate maximum nesting depth.&quot;&quot;&quot;</span>
        <span class="n">max_depth</span> <span class="o">=</span> <span class="n">depth</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">ast</span><span class="o">.</span><span class="n">iter_child_nodes</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="p">(</span><span class="n">ast</span><span class="o">.</span><span class="n">If</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">For</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">While</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">With</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Try</span><span class="p">)):</span>
                <span class="n">child_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_nesting_depth</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">max_depth</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_depth</span><span class="p">,</span> <span class="n">child_depth</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">child_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_nesting_depth</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">depth</span><span class="p">)</span>
                <span class="n">max_depth</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_depth</span><span class="p">,</span> <span class="n">child_depth</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">max_depth</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_uses_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if function uses &#39;self&#39; parameter.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">ast</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">ast</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">child</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="s1">&#39;self&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="k">class</span><span class="w"> </span><span class="nc">AnalysisReporter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reports analysis results.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">issues</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Issue</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">issues</span> <span class="o">=</span> <span class="n">issues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_categorize_issues</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_categorize_issues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Organize issues by category.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_severity</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Issue</span><span class="p">]]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_category</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Issue</span><span class="p">]]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">by_severity</span><span class="p">[</span><span class="n">issue</span><span class="o">.</span><span class="n">severity</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">issue</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">by_category</span><span class="p">[</span><span class="n">issue</span><span class="o">.</span><span class="n">category</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">issue</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">report_text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate text report.&quot;&quot;&quot;</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CODE QUALITY ANALYSIS REPORT&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;‚úì No issues found!&quot;</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Issues: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="c1"># Summary by severity</span>
        <span class="n">severity_order</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">severity</span> <span class="ow">in</span> <span class="n">severity_order</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">severity</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_severity</span><span class="p">:</span>
                <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">by_severity</span><span class="p">[</span><span class="n">severity</span><span class="p">])</span>
                <span class="n">emoji</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;critical&quot;</span><span class="p">:</span> <span class="s2">&quot;üî¥&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;‚ùå&quot;</span><span class="p">,</span> <span class="s2">&quot;warning&quot;</span><span class="p">:</span> <span class="s2">&quot;‚ö†Ô∏è&quot;</span><span class="p">,</span> <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="s2">&quot;‚ÑπÔ∏è&quot;</span><span class="p">}</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">emoji</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">severity</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">severity</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="c1"># Issues by category</span>
        <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">by_category</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;## </span><span class="si">{</span><span class="n">category</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_category</span><span class="p">[</span><span class="n">category</span><span class="p">]:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  [</span><span class="si">{</span><span class="n">issue</span><span class="o">.</span><span class="n">severity</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">issue</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  File: </span><span class="si">{</span><span class="n">issue</span><span class="o">.</span><span class="n">file</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">issue</span><span class="o">.</span><span class="n">line</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">issue</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ‚Üí </span><span class="si">{</span><span class="n">issue</span><span class="o">.</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">report_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate JSON report.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">([</span><span class="n">asdict</span><span class="p">(</span><span class="n">issue</span><span class="p">)</span> <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">analyze_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Issue</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze a single Python file.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">filepath</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="n">analyzer</span> <span class="o">=</span> <span class="n">CodeAnalyzer</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">analyze_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Issue</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze all Python files in a directory.&quot;&quot;&quot;</span>
    <span class="n">all_issues</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="c1"># Skip common non-source directories</span>
        <span class="n">dirs</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span> <span class="k">if</span> <span class="n">d</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;.git&#39;</span><span class="p">,</span> <span class="s1">&#39;__pycache__&#39;</span><span class="p">,</span> <span class="s1">&#39;.venv&#39;</span><span class="p">,</span> <span class="s1">&#39;venv&#39;</span><span class="p">,</span> <span class="s1">&#39;node_modules&#39;</span><span class="p">}]</span>

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">):</span>
                <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
                <span class="n">issues</span> <span class="o">=</span> <span class="n">analyze_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
                <span class="n">all_issues</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">issues</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">all_issues</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main entry point.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Usage: code_analyzer.py &lt;file_or_directory&gt; [--verbose] [--format json|text]&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="n">target</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="s1">&#39;--verbose&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span>
    <span class="n">format_type</span> <span class="o">=</span> <span class="s1">&#39;text&#39;</span>

    <span class="k">if</span> <span class="s1">&#39;--format&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;--format&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">):</span>
            <span class="n">format_type</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Check if target exists</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="c1"># Analyze</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="n">analyze_file</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="n">analyze_directory</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

    <span class="c1"># Report</span>
    <span class="n">reporter</span> <span class="o">=</span> <span class="n">AnalysisReporter</span><span class="p">(</span><span class="n">issues</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">format_type</span> <span class="o">==</span> <span class="s1">&#39;json&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">reporter</span><span class="o">.</span><span class="n">report_json</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">reporter</span><span class="o">.</span><span class="n">report_text</span><span class="p">())</span>

    <span class="c1"># Return non-zero if critical issues found</span>
    <span class="n">critical_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reporter</span><span class="o">.</span><span class="n">by_severity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span> <span class="p">[]))</span>
    <span class="n">error_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">reporter</span><span class="o">.</span><span class="n">by_severity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="p">[]))</span>

    <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">critical_count</span> <span class="o">+</span> <span class="n">error_count</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
</div>
        </details>
        </div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01RxdpTm5ZDmkkUwqSBe8Mbb"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:34.760Z' data-duration='took 137 ms'>2025-11-07 10:47:34</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>File created successfully at: /root/Claude/claude-factory/skills/clean-code-design-patterns/scripts/code_analyzer.py ...</pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:39.270Z'>2025-11-07 10:47:39</span>
                </div>
                
                <span class='token-usage'>Input: 0 | Output: 1 | Cache Creation: 4379 | Cache Read: 50509</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Perfect! Now let me make the script executable and update the todo list:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_014jAPd4DqrMZZ4U9b49nwoN">üõ†Ô∏è Bash <span class='tool-summary'>Make code_analyzer.py executable</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:39.592Z'>2025-11-07 10:47:39</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='bash-tool-content'><pre class='bash-tool-command'>chmod +x /root/Claude/claude-factory/skills/clean-code-design-patterns/scripts/code_analyzer.py</pre></div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_014jAPd4DqrMZZ4U9b49nwoN"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:41.197Z' data-duration='took 1.6s'>2025-11-07 10:47:41</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre></pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:45.266Z'>2025-11-07 10:47:45</span>
                </div>
                
                <span class='token-usage'>Input: 1 | Output: 1 | Cache Creation: 144 | Cache Read: 54888</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Now let me package the skill into a distributable zip file:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01W61ydfKeSmD9dfjRShnEZS">üìù Todo List</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:46.633Z'>2025-11-07 10:47:46</span>
                </div>
                
            </div>
        </div>
        <div class='content'>
    <div class="todo-list">
        
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Initialize skill directory structure</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Create SKILL.md with comprehensive design pattern guidance</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Create references for design patterns and best practices</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Create scripts for code analysis and refactoring</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item in_progress medium">
                    <input type="checkbox"   readonly>
                    <span class="todo-status">üîÑ</span>
                    <span class="todo-content">Package the skill into distributable zip</span>
                    <span class="todo-id">#</span>
                </div>
            
    </div>
    </div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01W61ydfKeSmD9dfjRShnEZS"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:46.702Z' data-duration='took 69 ms'>2025-11-07 10:47:46</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>Todos have been modified successfully. Ensure that you continue to use the todo list to track your progress. Please proceed with the current tasks if applicable</pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:50.765Z'>2025-11-07 10:47:50</span>
                </div>
                
                <span class='token-usage'>Input: 0 | Output: 1 | Cache Creation: 258 | Cache Read: 55032</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Now let me package the skill:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01VLp52ezcoSeD7GD7zGQNcj">üõ†Ô∏è Bash <span class='tool-summary'>Package clean-code-design-patterns skill</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:51.449Z'>2025-11-07 10:47:51</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='bash-tool-content'><pre class='bash-tool-command'>python .claude/skills/skill-creator/scripts/package_skill.py skills/clean-code-design-patterns/ skills/</pre></div></div>
    </div>
    
    
    
    
    <div class='message tool_result error paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01VLp52ezcoSeD7GD7zGQNcj">üö® Error</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:53.384Z' data-duration='took 1.9s'>2025-11-07 10:47:53</span>
                </div>
                
            </div>
        </div>
        <div class='content'>
    <details class="collapsible-details">
        <summary>
            <div class="preview-content"><pre>Exit code 1
üì¶ Packaging skill: skills/clean-code-design-patterns/
   Output directory: skills/

üîç Validating skill...
‚ùå Validation failed: Name &#x27;Clean Code with Design Patterns&#x27; should be hy...</pre></div>
        </summary>
        <div class="details-content">
            <pre>Exit code 1
üì¶ Packaging skill: skills/clean-code-design-patterns/
   Output directory: skills/

üîç Validating skill...
‚ùå Validation failed: Name &#x27;Clean Code with Design Patterns&#x27; should be hyphen-case (lowercase letters, digits, and hyphens only)
   Please fix the validation errors before packaging.</pre>
        </div>
    </details>
    </div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:57.222Z'>2025-11-07 10:47:57</span>
                </div>
                
                <span class='token-usage'>Input: 1 | Output: 1 | Cache Creation: 216 | Cache Read: 55290</span>
                
            </div>
        </div>
        <div class='content markdown'><p>I need to fix the skill name format. Let me update the SKILL.md:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01LpWk2vASJsQN7uzWMAC9gZ">üìù Edit <span class='tool-summary'>/root/Claude/claude-factory/skills/clean-code-design-patterns/SKILL.md</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:58.811Z'>2025-11-07 10:47:58</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='edit-tool-content'><div class='edit-diff'><div class='diff-line diff-context'><span class='diff-marker'> </span>---</div><div class='diff-line diff-removed'><span class='diff-marker'>-</span>name: <mark class='diff-char-removed'>C</mark>lean<mark class='diff-char-removed'> C</mark>ode<mark class='diff-char-removed'> with D</mark>esign<mark class='diff-char-removed'> P</mark>atterns</div><div class='diff-line diff-added'><span class='diff-marker'>+</span>name: <mark class='diff-char-added'>c</mark>lean<mark class='diff-char-added'>-c</mark>ode<mark class='diff-char-added'>-d</mark>esign<mark class='diff-char-added'>-p</mark>atterns</div><div class='diff-line diff-context'><span class='diff-marker'> </span>description: This skill should be used when implementing new features or refactoring existing code to apply senior-level design patterns, SOLID principles, and clean code practices. It guides analysis, design, and implementation of code that is maintainable, scalable, and follows industry best practices across multiple programming languages.</div><div class='diff-line diff-context'><span class='diff-marker'> </span>---</div></div></div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01LpWk2vASJsQN7uzWMAC9gZ"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:47:58.920Z' data-duration='took 109 ms'>2025-11-07 10:47:58</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='edit-tool-result'><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>---
name: clean-code-design-patterns
<span class="gu">description: This skill should be used when implementing new features or refactoring existing code to apply senior-level design patterns, SOLID principles, and clean code practices. It guides analysis, design, and implementation of code that is maintainable, scalable, and follows industry best practices across multiple programming languages.</span>
<span class="gu">---</span>

<span class="gh"># Clean Code with Design Patterns</span>

<span class="gu">## Overview</span>
</code></pre></div></td></tr></table></div>
</div></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:48:03.378Z'>2025-11-07 10:48:03</span>
                </div>
                
                <span class='token-usage'>Input: 0 | Output: 1 | Cache Creation: 459 | Cache Read: 55506</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Now try packaging again:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01JcMe3uPobRS6UtER7uKxhR">üõ†Ô∏è Bash <span class='tool-summary'>Package clean-code-design-patterns skill</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:48:03.610Z'>2025-11-07 10:48:03</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='bash-tool-content'><pre class='bash-tool-command'>python .claude/skills/skill-creator/scripts/package_skill.py skills/clean-code-design-patterns/ skills/</pre></div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01JcMe3uPobRS6UtER7uKxhR"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:48:03.849Z' data-duration='took 239 ms'>2025-11-07 10:48:03</span>
                </div>
                
            </div>
        </div>
        <div class='content'>
    <details class="collapsible-details">
        <summary>
            <div class="preview-content"><pre>üì¶ Packaging skill: skills/clean-code-design-patterns/
   Output directory: skills/

üîç Validating skill...
‚úÖ Skill is valid!

  Added: clean-code-design-patterns/SKILL.md
  Added: clean-code-design-pat...</pre></div>
        </summary>
        <div class="details-content">
            <pre>üì¶ Packaging skill: skills/clean-code-design-patterns/
   Output directory: skills/

üîç Validating skill...
‚úÖ Skill is valid!

  Added: clean-code-design-patterns/SKILL.md
  Added: clean-code-design-patterns/scripts/code_analyzer.py
  Added: clean-code-design-patterns/references/refactoring_strategies.md
  Added: clean-code-design-patterns/references/solid_principles.md
  Added: clean-code-design-patterns/references/design_patterns_guide.md
  Added: clean-code-design-patterns/references/clean_code_checklist.md

‚úÖ Successfully packaged skill to: /root/Claude/claude-factory/skills/clean-code-design-patterns.zip</pre>
        </div>
    </details>
    </div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:48:08.051Z'>2025-11-07 10:48:08</span>
                </div>
                
                <span class='token-usage'>Input: 0 | Output: 4 | Cache Creation: 500 | Cache Read: 55965</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Excellent! Let me mark the final todo as complete:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01YBjLQC6XXyrgE3YoZq1qYY">üìù Todo List</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:48:08.946Z'>2025-11-07 10:48:08</span>
                </div>
                
            </div>
        </div>
        <div class='content'>
    <div class="todo-list">
        
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Initialize skill directory structure</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Create SKILL.md with comprehensive design pattern guidance</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Create references for design patterns and best practices</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Create scripts for code analysis and refactoring</span>
                    <span class="todo-id">#</span>
                </div>
            
                <div class="todo-item completed medium">
                    <input type="checkbox" checked disabled readonly>
                    <span class="todo-status">‚úÖ</span>
                    <span class="todo-content">Package the skill into distributable zip</span>
                    <span class="todo-id">#</span>
                </div>
            
    </div>
    </div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01YBjLQC6XXyrgE3YoZq1qYY"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:48:09.069Z' data-duration='took 123 ms'>2025-11-07 10:48:09</span>
                </div>
                
            </div>
        </div>
        <div class='content'><pre>Todos have been modified successfully. Ensure that you continue to use the todo list to track your progress. Please proceed with the current tasks if applicable</pre></div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:48:12.541Z'>2025-11-07 10:48:12</span>
                </div>
                
                <span class='token-usage'>Input: 0 | Output: 3 | Cache Creation: 255 | Cache Read: 56465</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Perfect! Let me verify the skill package and provide a summary:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_01JBnvSbrebxh5SBRs28nCXt">üõ†Ô∏è Bash <span class='tool-summary'>Verify skill package contents</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:48:12.960Z'>2025-11-07 10:48:12</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='bash-tool-content'><pre class='bash-tool-command'>ls -lh /root/Claude/claude-factory/skills/clean-code-design-patterns.zip &amp;&amp; unzip -l /root/Claude/claude-factory/skills/clean-code-design-patterns.zip</pre></div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_01JBnvSbrebxh5SBRs28nCXt"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:48:14.789Z' data-duration='took 1.8s'>2025-11-07 10:48:14</span>
                </div>
                
            </div>
        </div>
        <div class='content'>
    <details class="collapsible-details">
        <summary>
            <div class="preview-content"><pre>-rw-r--r-- 1 root root 26K Nov  7 11:48 /root/Claude/claude-factory/skills/clean-code-design-patterns.zip
Archive:  /root/Claude/claude-factory/skills/clean-code-design-patterns.zip
  Length      Date...</pre></div>
        </summary>
        <div class="details-content">
            <pre>-rw-r--r-- 1 root root 26K Nov  7 11:48 /root/Claude/claude-factory/skills/clean-code-design-patterns.zip
Archive:  /root/Claude/claude-factory/skills/clean-code-design-patterns.zip
  Length      Date    Time    Name
---------  ---------- -----   ----
     9244  2025-11-07 11:47   clean-code-design-patterns/SKILL.md
    15910  2025-11-07 11:47   clean-code-design-patterns/scripts/code_analyzer.py
    13318  2025-11-07 11:46   clean-code-design-patterns/references/refactoring_strategies.md
    15314  2025-11-07 11:45   clean-code-design-patterns/references/solid_principles.md
    21064  2025-11-07 11:45   clean-code-design-patterns/references/design_patterns_guide.md
     8664  2025-11-07 11:46   clean-code-design-patterns/references/clean_code_checklist.md
---------                     -------
    83514                     6 files</pre>
        </div>
    </details>
    </div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:48:18.845Z'>2025-11-07 10:48:18</span>
                </div>
                
                <span class='token-usage'>Input: 0 | Output: 1 | Cache Creation: 441 | Cache Read: 56720</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Perfect! Now let me create a summary document:</p>
</div>
    </div>
    
    
    
    
    <div class='message tool_use paired-message pair_first'>
        <div class='header'>
            <span title="ID: toolu_0155u1qT2GCCQGdZyaZDDgM4">üõ†Ô∏è Bash <span class='tool-summary'>Display skill creation summary</span></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:48:31.539Z'>2025-11-07 10:48:31</span>
                </div>
                
            </div>
        </div>
        <div class='content'><div class='bash-tool-content'><pre class='bash-tool-command'>cat &gt; /tmp/skill-summary.txt &lt;&lt; &#x27;EOF&#x27;
================================================================================
CLEAN CODE WITH DESIGN PATTERNS - SENIOR-LEVEL SKILL
================================================================================

PROJECT COMPLETION SUMMARY
================================================================================

Skill Created: clean-code-design-patterns
Package Size: 26 KB (83.5 KB uncompressed)
Location: /root/Claude/claude-factory/skills/clean-code-design-patterns.zip

================================================================================
SKILL CONTENTS
================================================================================

1. SKILL.md (9.2 KB)
   - Complete skill documentation and workflow
   - 4-phase implementation approach (Analysis ‚Üí Design ‚Üí Implementation ‚Üí Review)
   - Core clean code principles
   - Design pattern categories (Structural, Behavioral, Creational, Architectural)
   - Language-specific considerations
   - Common pitfalls and best practices
   - Practical implementation guidance

2. REFERENCES (58.4 KB total)

   a) design_patterns_guide.md (21 KB)
      - Comprehensive pattern catalog
      - Factory, Builder, Dependency Injection patterns
      - Adapter, Decorator, Facade patterns
      - Strategy, Observer, Template Method patterns
      - Repository Pattern for data access
      - Pattern selection framework
      - Anti-patterns to avoid
      - Implementation examples in Python

   b) solid_principles.md (15.3 KB)
      - Deep dive into each SOLID principle:
        * Single Responsibility Principle (SRP)
        * Open/Closed Principle (OCP)
        * Liskov Substitution Principle (LSP)
        * Interface Segregation Principle (ISP)
        * Dependency Inversion Principle (DIP)
      - Problem/solution examples for each
      - Real-world application patterns
      - Common mistakes and when NOT to apply

   c) clean_code_checklist.md (8.6 KB)
      - 100+ checklist items organized by category:
        * Naming conventions
        * Function/Method quality
        * Class/Module quality
        * Comments and documentation
        * Error handling
        * Code organization
        * Testing standards
        * SOLID principles verification
        * Performance and security
        * Language-specific checks
      - Code quality metrics
      - Quick self-review questions

   d) refactoring_strategies.md (13.3 KB)
      - Safe refactoring workflow
      - 7 core refactoring techniques:
        * Extract Method
        * Rename for Clarity
        * Remove Duplication
        * Extract Class
        * Replace Conditional with Polymorphism
        * Introduce Parameter Object
        * Replace Magic Numbers with Constants
      - Problem-driven refactoring strategies
      - When NOT to refactor
      - Measuring refactoring success

3. SCRIPTS (15.9 KB)

   code_analyzer.py
   - Automated Python code quality analysis tool
   - Detects:
     * Function complexity (cyclomatic complexity)
     * Function length violations
     * Parameter count issues
     * Class size and cohesion problems
     * Naming convention violations
     * Deep nesting patterns
     * Potential code duplication
   - Output formats: Text (human-readable) or JSON
   - Severity levels: Critical, Error, Warning, Info
   - Categories: Complexity, Design, Naming, Duplication, Syntax

================================================================================
KEY FEATURES
================================================================================

‚úì Senior-Level Guidance
  - Covers Gang of Four patterns
  - SOLID principles explained in depth
  - Real-world trade-offs discussed
  - Anti-patterns identified

‚úì Multi-Language Support
  - Language-agnostic principles
  - Language-specific idioms (Python, Java, JavaScript, Go, C#)
  - Practical examples across languages

‚úì Comprehensive Workflow
  - Analysis and Assessment phase
  - Design and Planning phase
  - Implementation phase with SOLID checks
  - Review and Refinement phase

‚úì Practical Resources
  - 100+ item quality checklist
  - 7 refactoring techniques with examples
  - Pattern selection framework
  - Code analyzer script for automation

‚úì Real-World Focus
  - Avoids over-engineering guidance
  - Context-aware pattern selection
  - Practical implementation strategies
  - When NOT to apply patterns

================================================================================
USE CASES
================================================================================

1. Implementing New Features
   ‚Üí Apply design patterns from the start
   ‚Üí Follow SOLID principles
   ‚Üí Design for testability

2. Refactoring Existing Code
   ‚Üí Identify violations systematically
   ‚Üí Apply safe refactoring techniques
   ‚Üí Improve maintainability incrementally

3. Code Review
   ‚Üí Evaluate against clean code standards
   ‚Üí Check SOLID principle adherence
   ‚Üí Identify design pattern opportunities

4. Architecture Decisions
   ‚Üí Select appropriate patterns
   ‚Üí Design abstraction layers
   ‚Üí Plan dependency management

5. Team Training
   ‚Üí Share design pattern knowledge
   ‚Üí Establish code quality standards
   ‚Üí Guide junior developers

================================================================================
FILES CREATED
================================================================================

Directory Structure:
  skills/clean-code-design-patterns/
  ‚îú‚îÄ‚îÄ SKILL.md
  ‚îú‚îÄ‚îÄ scripts/
  ‚îÇ   ‚îî‚îÄ‚îÄ code_analyzer.py
  ‚îî‚îÄ‚îÄ references/
      ‚îú‚îÄ‚îÄ design_patterns_guide.md
      ‚îú‚îÄ‚îÄ solid_principles.md
      ‚îú‚îÄ‚îÄ clean_code_checklist.md
      ‚îî‚îÄ‚îÄ refactoring_strategies.md

Distributable Package:
  skills/clean-code-design-patterns.zip (26 KB)

================================================================================
EOF
cat /tmp/skill-summary.txt
</pre></div></div>
    </div>
    
    
    
    
    <div class='message tool_result paired-message pair_last'>
        <div class='header'>
            <span title="ID: toolu_0155u1qT2GCCQGdZyaZDDgM4"></span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:48:31.778Z' data-duration='took 239 ms'>2025-11-07 10:48:31</span>
                </div>
                
            </div>
        </div>
        <div class='content'>
    <details class="collapsible-details">
        <summary>
            <div class="preview-content"><pre>================================================================================
CLEAN CODE WITH DESIGN PATTERNS - SENIOR-LEVEL SKILL
==================================================================...</pre></div>
        </summary>
        <div class="details-content">
            <pre>================================================================================
CLEAN CODE WITH DESIGN PATTERNS - SENIOR-LEVEL SKILL
================================================================================

PROJECT COMPLETION SUMMARY
================================================================================

Skill Created: clean-code-design-patterns
Package Size: 26 KB (83.5 KB uncompressed)
Location: /root/Claude/claude-factory/skills/clean-code-design-patterns.zip

================================================================================
SKILL CONTENTS
================================================================================

1. SKILL.md (9.2 KB)
   - Complete skill documentation and workflow
   - 4-phase implementation approach (Analysis ‚Üí Design ‚Üí Implementation ‚Üí Review)
   - Core clean code principles
   - Design pattern categories (Structural, Behavioral, Creational, Architectural)
   - Language-specific considerations
   - Common pitfalls and best practices
   - Practical implementation guidance

2. REFERENCES (58.4 KB total)

   a) design_patterns_guide.md (21 KB)
      - Comprehensive pattern catalog
      - Factory, Builder, Dependency Injection patterns
      - Adapter, Decorator, Facade patterns
      - Strategy, Observer, Template Method patterns
      - Repository Pattern for data access
      - Pattern selection framework
      - Anti-patterns to avoid
      - Implementation examples in Python

   b) solid_principles.md (15.3 KB)
      - Deep dive into each SOLID principle:
        * Single Responsibility Principle (SRP)
        * Open/Closed Principle (OCP)
        * Liskov Substitution Principle (LSP)
        * Interface Segregation Principle (ISP)
        * Dependency Inversion Principle (DIP)
      - Problem/solution examples for each
      - Real-world application patterns
      - Common mistakes and when NOT to apply

   c) clean_code_checklist.md (8.6 KB)
      - 100+ checklist items organized by category:
        * Naming conventions
        * Function/Method quality
        * Class/Module quality
        * Comments and documentation
        * Error handling
        * Code organization
        * Testing standards
        * SOLID principles verification
        * Performance and security
        * Language-specific checks
      - Code quality metrics
      - Quick self-review questions

   d) refactoring_strategies.md (13.3 KB)
      - Safe refactoring workflow
      - 7 core refactoring techniques:
        * Extract Method
        * Rename for Clarity
        * Remove Duplication
        * Extract Class
        * Replace Conditional with Polymorphism
        * Introduce Parameter Object
        * Replace Magic Numbers with Constants
      - Problem-driven refactoring strategies
      - When NOT to refactor
      - Measuring refactoring success

3. SCRIPTS (15.9 KB)

   code_analyzer.py
   - Automated Python code quality analysis tool
   - Detects:
     * Function complexity (cyclomatic complexity)
     * Function length violations
     * Parameter count issues
     * Class size and cohesion problems
     * Naming convention violations
     * Deep nesting patterns
     * Potential code duplication
   - Output formats: Text (human-readable) or JSON
   - Severity levels: Critical, Error, Warning, Info
   - Categories: Complexity, Design, Naming, Duplication, Syntax

================================================================================
KEY FEATURES
================================================================================

‚úì Senior-Level Guidance
  - Covers Gang of Four patterns
  - SOLID principles explained in depth
  - Real-world trade-offs discussed
  - Anti-patterns identified

‚úì Multi-Language Support
  - Language-agnostic principles
  - Language-specific idioms (Python, Java, JavaScript, Go, C#)
  - Practical examples across languages

‚úì Comprehensive Workflow
  - Analysis and Assessment phase
  - Design and Planning phase
  - Implementation phase with SOLID checks
  - Review and Refinement phase

‚úì Practical Resources
  - 100+ item quality checklist
  - 7 refactoring techniques with examples
  - Pattern selection framework
  - Code analyzer script for automation

‚úì Real-World Focus
  - Avoids over-engineering guidance
  - Context-aware pattern selection
  - Practical implementation strategies
  - When NOT to apply patterns

================================================================================
USE CASES
================================================================================

1. Implementing New Features
   ‚Üí Apply design patterns from the start
   ‚Üí Follow SOLID principles
   ‚Üí Design for testability

2. Refactoring Existing Code
   ‚Üí Identify violations systematically
   ‚Üí Apply safe refactoring techniques
   ‚Üí Improve maintainability incrementally

3. Code Review
   ‚Üí Evaluate against clean code standards
   ‚Üí Check SOLID principle adherence
   ‚Üí Identify design pattern opportunities

4. Architecture Decisions
   ‚Üí Select appropriate patterns
   ‚Üí Design abstraction layers
   ‚Üí Plan dependency management

5. Team Training
   ‚Üí Share design pattern knowledge
   ‚Üí Establish code quality standards
   ‚Üí Guide junior developers

================================================================================
FILES CREATED
================================================================================

Directory Structure:
  skills/clean-code-design-patterns/
  ‚îú‚îÄ‚îÄ SKILL.md
  ‚îú‚îÄ‚îÄ scripts/
  ‚îÇ   ‚îî‚îÄ‚îÄ code_analyzer.py
  ‚îî‚îÄ‚îÄ references/
      ‚îú‚îÄ‚îÄ design_patterns_guide.md
      ‚îú‚îÄ‚îÄ solid_principles.md
      ‚îú‚îÄ‚îÄ clean_code_checklist.md
      ‚îî‚îÄ‚îÄ refactoring_strategies.md

Distributable Package:
  skills/clean-code-design-patterns.zip (26 KB)

================================================================================</pre>
        </div>
    </details>
    </div>
    </div>
    
    
    
    
    <div class='message assistant'>
        <div class='header'>
            <span>ü§ñ Assistant</span>
            <div class='header-info'>
                <div class='timestamp-row'>
                    <span class='timestamp' data-timestamp='2025-11-07T10:48:40.264Z'>2025-11-07 10:48:40</span>
                </div>
                
                <span class='token-usage'>Input: 0 | Output: 3 | Cache Creation: 2685 | Cache Read: 57161</span>
                
            </div>
        </div>
        <div class='content markdown'><p>Perfect! Let me create a final report:</p>
<h2>Summary</h2>
<p>I've successfully created a <strong>senior-level skill for Clean Code with Design Patterns</strong>. Here's what was delivered:</p>
<h3>üì¶ <strong>Deliverable</strong></h3>
<ul>
<li><strong>Package</strong>: <code>clean-code-design-patterns.zip</code> (26 KB)</li>
<li><strong>Location</strong>: <code>/root/Claude/claude-factory/skills/clean-code-design-patterns.zip</code></li>
</ul>
<h3>üìö <strong>Skill Contents</strong></h3>
<p><strong>1. SKILL.md</strong> - Comprehensive skill documentation featuring:</p>
<ul>
<li>4-phase workflow (Analysis ‚Üí Design ‚Üí Implementation ‚Üí Review)</li>
<li>Core clean code principles (naming, functions, DRY, error handling, comments)</li>
<li>Design patterns by category (Structural, Behavioral, Creational, Architectural)</li>
<li>SOLID principles overview</li>
<li>Language-specific considerations</li>
<li>Common pitfalls and anti-patterns</li>
</ul>
<p><strong>2. Reference Guides</strong> (4 comprehensive documents):</p>
<table>
<thead>
<tr>
  <th>Reference</th>
  <th>Focus</th>
  <th>Content</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>design_patterns_guide.md</strong></td>
  <td>Pattern Catalog</td>
  <td>Factory, Builder, DI, Adapter, Decorator, Facade, Strategy, Observer, Repository patterns with full implementation examples</td>
</tr>
<tr>
  <td><strong>solid_principles.md</strong></td>
  <td>SOLID Deep Dive</td>
  <td>Each principle with problem/solution pairs, real-world examples, and when NOT to apply</td>
</tr>
<tr>
  <td><strong>clean_code_checklist.md</strong></td>
  <td>Quality Assurance</td>
  <td>100+ checklist items covering naming, functions, classes, testing, SOLID, security, and language-specific checks</td>
</tr>
<tr>
  <td><strong>refactoring_strategies.md</strong></td>
  <td>Improvement Techniques</td>
  <td>7 core refactoring techniques with before/after examples, safe workflows, and success metrics</td>
</tr>
</tbody>
</table>
<p><strong>3. Code Analyzer Script</strong> - Automated Python analysis tool:</p>
<ul>
<li>Detects: Function complexity, class cohesion, naming violations, deep nesting, duplication</li>
<li>Outputs: Human-readable text or JSON format</li>
<li>Severity levels: Critical, Error, Warning, Info</li>
</ul>
<h3>‚úÖ <strong>Senior-Level Features</strong></h3>
<ul>
<li>Gang of Four patterns with trade-off analysis</li>
<li>SOLID principles with real-world application guidance</li>
<li>Avoids over-engineering; focuses on context-aware decisions</li>
<li>Multi-language support with language-specific idioms</li>
<li>Practical examples and anti-patterns</li>
<li>100+ quality checklist items</li>
<li>Safe refactoring workflows</li>
</ul>
<p>This skill is ready to use for implementing new features, refactoring code, code reviews, architecture decisions, and team training.</p>
</div>
    </div>
    
    

    <button class="timeline-toggle floating-btn" id="toggleTimeline" title="Show timeline">üìÜ</button>
    <button class="filter-messages floating-btn" id="filterMessages" title="Search & Filter">üîç</button>
    <button class="toggle-details floating-btn" id="toggleDetails" title="Toggle all details">üìã</button>
    <a class="scroll-top floating-btn" title="Scroll to top" href="#title">üîù</a>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const toggleButton = document.getElementById('toggleDetails');
            const timelineButton = document.getElementById('toggleTimeline');
            const filterButton = document.getElementById('filterMessages');
            const filterToolbar = document.querySelector('.filter-toolbar');
            const selectAllButton = document.getElementById('selectAll');
            const selectNoneButton = document.getElementById('selectNone');
            const closeToolbarButton = document.getElementById('closeToolbar');
            const filterToggles = document.querySelectorAll('.filter-toggle');

            // Timezone conversion (included as component)
            // Convert timestamps to user's timezone
// This function can be called directly or will auto-run on DOMContentLoaded if included standalone
(function() {
    function convertTimestampsToLocalTimezone() {
        const timestampElements = Array.from(document.querySelectorAll('.timestamp[data-timestamp]'));

        if (timestampElements.length === 0) return;

        const userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;

        const localFormatter = new Intl.DateTimeFormat(undefined, {
            year: 'numeric',
            month: '2-digit',
            day: '2-digit',
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit',
            hour12: false,
            timeZone: userTimezone
        });

        const utcFormatter = new Intl.DateTimeFormat(undefined, {
            year: 'numeric',
            month: '2-digit',
            day: '2-digit',
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit',
            hour12: false,
            timeZone: 'UTC'
        });

        const tzNameFormatter = new Intl.DateTimeFormat('en', {
            timeZoneName: 'short',
            timeZone: userTimezone
        });

        // Process timestamps in batches to keep page responsive
        const batchSize = 25;
        const scheduleWork = window.requestIdleCallback || function(cb) { setTimeout(cb, 16); };

        function processBatch(startIndex) {
            const endIndex = Math.min(startIndex + batchSize, timestampElements.length);

            for (let i = startIndex; i < endIndex; i++) {
                const element = timestampElements[i];
                const rawTimestamp = element.getAttribute('data-timestamp');
                const rawTimestampEnd = element.getAttribute('data-timestamp-end');
                const duration = element.getAttribute('data-duration');

                if (!rawTimestamp) continue;

                try {
                    // Parse the ISO timestamp
                    const date = new Date(rawTimestamp);
                    if (isNaN(date.getTime())) continue; // Invalid date

                    const localTime = localFormatter.format(date).replace(/, /g, ' ');
                    const utcTime = utcFormatter.format(date).replace(/, /g, ' ');

                    // Get timezone abbreviation (reuse formatter)
                    const timezoneName = tzNameFormatter.formatToParts(date).find(part => part.type === 'timeZoneName')?.value || userTimezone;

                    // Handle time ranges (earliest to latest)
                    if (rawTimestampEnd) {
                        const dateEnd = new Date(rawTimestampEnd);
                        if (!isNaN(dateEnd.getTime())) {
                            const localTimeEnd = localFormatter.format(dateEnd).replace(/, /g, ' ');
                            const utcTimeEnd = utcFormatter.format(dateEnd).replace(/, /g, ' ');

                            // Update the element with range
                            if (localTime !== utcTime || localTimeEnd !== utcTimeEnd) {
                                element.innerHTML = localTime + ' to ' + localTimeEnd + ' <span style="color: #888; font-size: 0.9em;">(' + timezoneName + ')</span>';
                                element.title = 'UTC: ' + utcTime + ' to ' + utcTimeEnd;
                            } else {
                                // If they're the same (user is in UTC), just show UTC
                                element.innerHTML = utcTime + ' to ' + utcTimeEnd + ' <span style="color: #888; font-size: 0.9em;">(UTC)</span>';
                                element.title = 'UTC: ' + utcTime + ' to ' + utcTimeEnd;
                            }
                        }
                    } else {
                        // Single timestamp
                        if (localTime !== utcTime) {
                            element.innerHTML = localTime + ' <span style="color: #888; font-size: 0.9em;">(' + timezoneName + ')</span>';
                            element.title = duration ? duration : 'UTC: ' + utcTime;
                        } else {
                            // If they're the same (user is in UTC), just show UTC
                            element.innerHTML = utcTime + ' <span style="color: #888; font-size: 0.9em;">(UTC)</span>';
                            element.title = duration ? duration : 'UTC: ' + utcTime;
                        }
                    }

                } catch (error) {
                    // If conversion fails, leave the original timestamp
                    console.warn('Failed to convert timestamp:', rawTimestamp, error);
                }
            }

            // Schedule next batch if there are more timestamps
            if (endIndex < timestampElements.length) {
                scheduleWork(function() {
                    processBatch(endIndex);
                });
            }
        }

        // Start processing the first batch
        scheduleWork(function() {
            processBatch(0);
        });
    }

    // Execute immediately - assumes this is included within a DOMContentLoaded handler
    convertTimestampsToLocalTimezone();
})();

            // Parse URL parameters
            function getUrlParams() {
                const params = new URLSearchParams(window.location.search);
                return {
                    filter: params.get('filter')  // e.g., "user,assistant"
                };
            }

            // Apply filters from URL parameters
            function applyUrlFilters() {
                const urlParams = getUrlParams();

                // Apply message type filter
                if (urlParams.filter) {
                    const types = urlParams.filter.split(',').map(t => t.trim().toLowerCase());

                    // Deactivate all toggles first
                    filterToggles.forEach(toggle => {
                        toggle.classList.remove('active');
                    });

                    // Activate only the specified types
                    types.forEach(type => {
                        const toggle = document.querySelector(`[data-type="${type}"]`);
                        if (toggle) {
                            toggle.classList.add('active');
                        }
                    });

                    // Show filter toolbar if filters are applied
                    filterToolbar.classList.add('visible');
                    filterButton.classList.add('active');
                }
            }

            // Timeline toggle functionality
            if (timelineButton) {
                timelineButton.addEventListener('click', function () {
                    if (window.toggleTimeline) {
                        window.toggleTimeline();
                    }
                });
            }

            // Toggle details functionality
            function updateToggleButton() {
                const allDetails = document.querySelectorAll('details.collapsible-details');
                const openCount = document.querySelectorAll('details[open].collapsible-details').length;
                const totalCount = allDetails.length;

                if (totalCount === 0) {
                    toggleButton.style.display = 'none';
                    return;
                }

                // If more than half are open, show "close all" state, otherwise show "open all"
                const mostlyOpen = openCount > totalCount / 2;
                toggleButton.textContent = mostlyOpen ? 'üì¶' : 'üóÉÔ∏è';
                toggleButton.title = mostlyOpen ? 'Close all details' : 'Open all details';
            }

            function toggleAllDetails() {
                const allDetails = document.querySelectorAll('details.collapsible-details');
                const openCount = document.querySelectorAll('details[open].collapsible-details').length;
                const shouldOpen = openCount <= allDetails.length / 2;

                allDetails.forEach(details => {
                    if (shouldOpen) {
                        details.setAttribute('open', '');
                    } else {
                        details.removeAttribute('open');
                    }
                });

                updateToggleButton();
            }

            toggleButton.addEventListener('click', toggleAllDetails);

            // Filter toolbar toggle functionality
            function toggleFilterToolbar() {
                const isVisible = filterToolbar.classList.contains('visible');
                if (isVisible) {
                    filterToolbar.classList.remove('visible');
                    filterButton.classList.remove('active');
                    filterButton.title = 'Search & Filter';
                } else {
                    filterToolbar.classList.add('visible');
                    filterButton.classList.add('active');
                    filterButton.title = 'Close';
                    // Focus search input when opening
                    const searchInput = document.getElementById('searchInput');
                    if (searchInput) {
                        setTimeout(() => searchInput.focus(), 100);
                    }
                }
            }

            filterButton.addEventListener('click', toggleFilterToolbar);
            if (closeToolbarButton) {
                closeToolbarButton.addEventListener('click', toggleFilterToolbar);
            }

            // Count messages by type and update button labels
            function updateMessageCounts() {
                const messageTypes = ['user', 'assistant', 'sidechain', 'system', 'thinking', 'image'];

                messageTypes.forEach(type => {
                    const messages = document.querySelectorAll(`.message.${type}:not(.session-header)`);
                    const count = messages.length;
                    const toggle = document.querySelector(`[data-type="${type}"]`);
                    const countSpan = toggle ? toggle.querySelector('.count') : null;

                    if (countSpan) {
                        countSpan.textContent = `(${count})`;

                        // Hide toggles for message types with 0 count
                        if (count === 0) {
                            toggle.style.display = 'none';
                        } else {
                            toggle.style.display = 'flex';
                        }
                    }
                });

                // Handle combined "tool" filter (tool_use + tool_result)
                const toolMessages = document.querySelectorAll(`.message.tool_use:not(.session-header), .message.tool_result:not(.session-header)`);
                const toolCount = toolMessages.length;
                const toolToggle = document.querySelector(`[data-type="tool"]`);
                const toolCountSpan = toolToggle ? toolToggle.querySelector('.count') : null;

                if (toolCountSpan) {
                    toolCountSpan.textContent = `(${toolCount})`;
                    if (toolCount === 0) {
                        toolToggle.style.display = 'none';
                    } else {
                        toolToggle.style.display = 'flex';
                    }
                }
            }

            // Filter functionality
            function applyFilter() {
                const activeTypes = Array.from(filterToggles)
                    .filter(toggle => toggle.classList.contains('active'))
                    .map(toggle => toggle.dataset.type);

                // Expand "tool" to include both tool_use and tool_result
                const expandedTypes = [];
                activeTypes.forEach(type => {
                    if (type === 'tool') {
                        expandedTypes.push('tool_use', 'tool_result');
                    } else {
                        expandedTypes.push(type);
                    }
                });

                // Show/hide messages based on active toggle buttons
                const allMessages = document.querySelectorAll('.message:not(.session-header)');
                allMessages.forEach(message => {
                    let shouldShow = false;

                    // Special handling for sidechain messages
                    if (message.classList.contains('sidechain')) {
                        // For sidechain messages, show if both sidechain filter is active AND their message type filter is active
                        const sidechainActive = expandedTypes.includes('sidechain');
                        const messageTypeActive = expandedTypes.some(type =>
                            type !== 'sidechain' && message.classList.contains(type)
                        );
                        shouldShow = sidechainActive && messageTypeActive;
                    } else {
                        // For non-sidechain messages, show if any of their types are active
                        shouldShow = expandedTypes.some(type => message.classList.contains(type));
                    }

                    if (shouldShow) {
                        message.classList.remove('filtered-hidden');
                    } else {
                        message.classList.add('filtered-hidden');
                    }
                });

                // Update visible counts in real-time
                updateVisibleCounts();

                // Update filter button appearance based on whether all types are selected
                const allTypesSelected = activeTypes.length === filterToggles.length;
                if (!allTypesSelected && filterToolbar.classList.contains('visible')) {
                    filterButton.classList.add('active');
                } else if (allTypesSelected && filterToolbar.classList.contains('visible')) {
                    filterButton.classList.add('active');
                }
            }

            function updateVisibleCounts() {
                const messageTypes = ['user', 'assistant', 'sidechain', 'system', 'thinking', 'image'];

                messageTypes.forEach(type => {
                    const visibleMessages = document.querySelectorAll(`.message.${type}:not(.session-header):not(.filtered-hidden)`);
                    const totalMessages = document.querySelectorAll(`.message.${type}:not(.session-header)`);
                    const visibleCount = visibleMessages.length;
                    const totalCount = totalMessages.length;

                    const toggle = document.querySelector(`[data-type="${type}"]`);
                    const countSpan = toggle ? toggle.querySelector('.count') : null;

                    if (countSpan && totalCount > 0) {
                        // Show "visible/total" format when filtering is active
                        const activeTypes = Array.from(filterToggles)
                            .filter(toggle => toggle.classList.contains('active'))
                            .map(toggle => toggle.dataset.type);

                        const isFiltering = activeTypes.length < filterToggles.length;

                        if (isFiltering && visibleCount !== totalCount) {
                            countSpan.textContent = `(${visibleCount}/${totalCount})`;
                        } else {
                            countSpan.textContent = `(${totalCount})`;
                        }
                    }
                });

                // Handle combined "tool" filter separately
                const visibleToolMessages = document.querySelectorAll(`.message.tool_use:not(.session-header):not(.filtered-hidden), .message.tool_result:not(.session-header):not(.filtered-hidden)`);
                const totalToolMessages = document.querySelectorAll(`.message.tool_use:not(.session-header), .message.tool_result:not(.session-header)`);
                const visibleToolCount = visibleToolMessages.length;
                const totalToolCount = totalToolMessages.length;

                const toolToggle = document.querySelector(`[data-type="tool"]`);
                const toolCountSpan = toolToggle ? toolToggle.querySelector('.count') : null;

                if (toolCountSpan && totalToolCount > 0) {
                    const activeTypes = Array.from(filterToggles)
                        .filter(toggle => toggle.classList.contains('active'))
                        .map(toggle => toggle.dataset.type);

                    const isFiltering = activeTypes.length < filterToggles.length;

                    if (isFiltering && visibleToolCount !== totalToolCount) {
                        toolCountSpan.textContent = `(${visibleToolCount}/${totalToolCount})`;
                    } else {
                        toolCountSpan.textContent = `(${totalToolCount})`;
                    }
                }
            }

            function toggleFilter(button) {
                button.classList.toggle('active');
                applyFilter();
            }

            function selectAllTypes() {
                filterToggles.forEach(toggle => {
                    toggle.classList.add('active');
                });
                applyFilter();
            }

            function selectNoTypes() {
                filterToggles.forEach(toggle => {
                    toggle.classList.remove('active');
                });
                applyFilter();
            }

            // Event listeners for filter toggles
            filterToggles.forEach(toggle => {
                toggle.addEventListener('click', () => toggleFilter(toggle));
            });

            selectAllButton.addEventListener('click', selectAllTypes);
            selectNoneButton.addEventListener('click', selectNoTypes);

            // Initialize button state and message counts
            updateToggleButton();
            updateMessageCounts();

            // Apply URL filters first (if any)
            applyUrlFilters();

            // Apply all filters on page load
            applyFilter();
        });
    </script>
    <!-- Search functionality script -->
    
    <!-- Search Component -->


<script>
(function() {
    // Search state
    let searchState = {
        query: '',
        useRegex: false,
        searchInFiltered: true,
        currentMatchIndex: 0,
        matches: [],
        searchIndex: null,
        isIndexPage: window.location.pathname.includes('index.html') ||
                      window.location.pathname.endsWith('projects/') ||
                      (!window.location.pathname.includes('.html') && window.location.pathname.endsWith('/'))
    };

    // DOM elements
    const searchContainer = document.getElementById('searchContainer');
    const searchInput = document.getElementById('searchInput');
    const searchClear = document.getElementById('searchClear');
    const searchHint = document.querySelector('.search-hint');
    const searchResultsInfo = document.getElementById('searchResultsInfo');
    const searchResultCount = document.getElementById('searchResultCount');
    const searchPrev = document.getElementById('searchPrev');
    const searchNext = document.getElementById('searchNext');
    const searchRegex = document.getElementById('searchRegex');
    const searchInFiltered = document.getElementById('searchInFiltered');
    const searchResultsPanel = document.getElementById('searchResultsPanel');
    const searchResultsContent = document.getElementById('searchResultsContent');
    const searchResultsClose = document.getElementById('searchResultsClose');

    // Initialize search
    function initSearch() {
        // Build search index from page content
        buildSearchIndex();

        // Restore previous search state from localStorage
        restoreSearchState();

        // Set up event listeners
        setupEventListeners();

        // Initialize UI state
        updateSearchInputState();
    }

    // Build search index from current page
    function buildSearchIndex() {
        searchState.searchIndex = [];
        
        if (searchState.isIndexPage) {
            // Index page: index projects with individual sessions
            document.querySelectorAll('.project-card').forEach(card => {
                const projectName = card.querySelector('.project-name a')?.textContent || '';
                const projectStats = card.querySelector('.project-stats')?.textContent || '';
                const projectLink = card.querySelector('.project-name a')?.getAttribute('href') || '';
                
                // Index the project itself
                searchState.searchIndex.push({
                    type: 'project',
                    name: projectName,
                    stats: projectStats,
                    element: card,
                    link: projectLink,
                    searchText: `${projectName} ${projectStats}`,
                    originalText: `${projectName} ${projectStats}`
                });
                
                // Index individual sessions within the project
                card.querySelectorAll('.session-link').forEach(link => {
                    const sessionText = link.textContent || '';
                    const sessionHref = link.getAttribute('href') || '';
                    const sessionPreview = link.querySelector('.session-preview')?.textContent?.trim() || '';
                    const sessionMeta = link.querySelector('.session-link-meta')?.textContent || '';
                    
                    searchState.searchIndex.push({
                        type: 'session',
                        projectName: projectName,
                        sessionText: sessionText,
                        sessionPreview: sessionPreview,
                        sessionMeta: sessionMeta,
                        element: card,
                        link: sessionHref,
                        searchText: `${projectName} ${sessionText} ${sessionPreview} ${sessionMeta}`,
                        originalText: `${sessionText} ${sessionPreview}`
                    });
                });
            });
        } else {
            // Transcript page: index messages
            document.querySelectorAll('.message:not(.session-header)').forEach(message => {
                const header = message.querySelector('.header span')?.textContent || '';
                const content = message.querySelector('.content')?.textContent || '';
                const timestamp = message.querySelector('.timestamp')?.textContent || '';
                const sessionId = findSessionForMessage(message);
                
                searchState.searchIndex.push({
                    type: 'message',
                    header: header,
                    content: content,
                    timestamp: timestamp,
                    sessionId: sessionId,
                    element: message,
                    searchText: `${header} ${content}`.toLowerCase(),
                    originalText: `${header} ${content}`
                });
            });
        }
    }

    // Find session ID for a message
    function findSessionForMessage(messageElement) {
        let prev = messageElement.previousElementSibling;
        while (prev) {
            if (prev.classList.contains('session-header')) {
                return prev.id.replace('session-', '');
            }
            prev = prev.previousElementSibling;
        }
        return null;
    }

    // Create excerpt with context around matches
    function createExcerpt(text, query, contextLength = 50) {
        if (!text || !query) return '';
        
        // Create search pattern (always case-insensitive)
        let pattern;
        try {
            if (searchState.useRegex) {
                pattern = new RegExp(query, 'gi');
            } else {
                const escapedQuery = query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                pattern = new RegExp(escapedQuery, 'gi');
            }
        } catch (e) {
            return text.substring(0, 100) + (text.length > 100 ? '...' : '');
        }

        const matches = [...text.matchAll(pattern)];
        if (matches.length === 0) {
            return text.substring(0, 100) + (text.length > 100 ? '...' : '');
        }

        // Collect all excerpts with context
        const excerpts = [];
        const processedRanges = [];

        matches.forEach(match => {
            const start = Math.max(0, match.index - contextLength);
            const end = Math.min(text.length, match.index + match[0].length + contextLength);
            
            // Check for overlap with existing ranges
            const overlaps = processedRanges.find(range => 
                (start >= range.start && start <= range.end) ||
                (end >= range.start && end <= range.end) ||
                (start <= range.start && end >= range.end)
            );

            if (overlaps) {
                // Extend the existing range
                overlaps.start = Math.min(overlaps.start, start);
                overlaps.end = Math.max(overlaps.end, end);
            } else {
                processedRanges.push({ start, end });
            }
        });

        // Sort by start position and create excerpts
        processedRanges.sort((a, b) => a.start - b.start);
        
        processedRanges.forEach(range => {
            let excerpt = text.substring(range.start, range.end);
            
            // Add ellipsis if needed
            if (range.start > 0) excerpt = '...' + excerpt;
            if (range.end < text.length) excerpt = excerpt + '...';
            
            excerpts.push(excerpt);
        });

        return excerpts.join(' ');
    }

    // Count actual matches in text (always case-insensitive)
    function countMatches(text, query) {
        if (!text || !query) return 0;

        try {
            let pattern;
            if (searchState.useRegex) {
                pattern = new RegExp(query, 'gi');
            } else {
                const escapedQuery = query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                pattern = new RegExp(escapedQuery, 'gi');
            }

            const matches = text.match(pattern);
            return matches ? matches.length : 0;
        } catch (e) {
            return 0;
        }
    }

    // Toggle search hint and clear button visibility based on input content
    function updateSearchInputState() {
        const hasContent = searchInput && searchInput.value.length > 0;

        // Toggle hint visibility
        if (searchHint) {
            if (hasContent) {
                searchHint.classList.add('hidden');
            } else {
                searchHint.classList.remove('hidden');
            }
        }

        // Toggle clear button visibility
        if (searchClear) {
            if (hasContent) {
                searchClear.classList.add('visible');
            } else {
                searchClear.classList.remove('visible');
            }
        }
    }

    // Setup event listeners
    function setupEventListeners() {
        // Search input
        let searchTimeout;
        searchInput.addEventListener('input', (e) => {
            updateSearchInputState();
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => performSearch(e.target.value), 300);
        });

        // Clear button
        searchClear.addEventListener('click', clearSearch);

        // Search options
        searchRegex.addEventListener('change', () => {
            searchState.useRegex = searchRegex.checked;
            if (searchState.query) performSearch(searchState.query);
        });

        searchInFiltered.addEventListener('change', () => {
            searchState.searchInFiltered = searchInFiltered.checked;
            if (searchState.query) performSearch(searchState.query);
        });

        // Navigation buttons
        searchPrev.addEventListener('click', () => navigateMatch(-1));
        searchNext.addEventListener('click', () => navigateMatch(1));

        // Close results panel
        if (searchResultsClose) {
            searchResultsClose.addEventListener('click', () => {
                searchResultsPanel.classList.remove('visible');
            });
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', handleKeyboardShortcuts);
    }

    // Perform search
    let isSearching = false;
    function performSearch(query) {
        // Prevent concurrent searches
        if (isSearching) return;
        isSearching = true;

        searchState.query = query;
        searchClear.classList.toggle('visible', query.length > 0);
        
        // Clear previous highlights
        clearHighlights();
        
        if (!query) {
            searchState.matches = [];
            updateSearchUI();
            if (searchState.isIndexPage && searchResultsPanel) {
                searchResultsPanel.classList.remove('visible');
            }
            isSearching = false;
            return;
        }

        // Save search state
        saveSearchState();
        
        // Create search pattern (always case-insensitive)
        let searchPattern;
        try {
            if (searchState.useRegex) {
                searchPattern = new RegExp(query, 'gi');
            } else {
                const escapedQuery = query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                searchPattern = new RegExp(escapedQuery, 'gi');
            }
        } catch (e) {
            // Invalid regex
            searchState.matches = [];
            updateSearchUI();
            isSearching = false;
            return;
        }

        // Search through index
        searchState.matches = [];
        let totalMatchCount = 0;
        
        searchState.searchIndex.forEach(item => {
            // Check if element is visible (for transcript pages with filters)
            if (!searchState.isIndexPage && searchState.searchInFiltered) {
                if (item.element.classList.contains('filtered-hidden')) {
                    return;
                }
            }

            // Always use case-insensitive search
            const searchText = item.searchText.toLowerCase();
            const searchQuery = query.toLowerCase();

            // Check if item matches the search
            let matchesItem = false;
            if (searchState.useRegex) {
                searchPattern.lastIndex = 0;  // Reset lastIndex before each test to avoid skipping matches
                matchesItem = searchPattern.test(searchText);
            } else {
                matchesItem = searchText.includes(searchQuery);
            }

            if (matchesItem) {
                // Count actual matches in this item
                const matchCount = countMatches(item.originalText || item.searchText, query);
                totalMatchCount += matchCount;
                
                // Add match count and excerpt to the item
                const matchItem = {
                    ...item,
                    matchCount: matchCount,
                    excerpt: createExcerpt(item.originalText || item.searchText, query)
                };
                
                searchState.matches.push(matchItem);
                
                // Highlight matches in the element
                if (!searchState.isIndexPage) {
                    highlightInElement(item.element, searchPattern);
                }
            }
        });
        
        searchState.totalMatchCount = totalMatchCount;

        searchState.currentMatchIndex = searchState.matches.length > 0 ? 0 : -1;
        updateSearchUI();
        
        // Show results panel for index page
        if (searchState.isIndexPage && searchResultsPanel) {
            displayIndexSearchResults();
        }
        
        // Navigate to first match
        if (searchState.matches.length > 0 && !searchState.isIndexPage) {
            navigateToMatch(0);
        }

        // Reset searching flag
        isSearching = false;
    }

    // Highlight text in element
    function highlightInElement(element, pattern) {
        const walker = document.createTreeWalker(
            element,
            NodeFilter.SHOW_TEXT,
            null,
            false
        );

        const textNodes = [];
        let node;
        while (node = walker.nextNode()) {
            if (node.nodeValue.trim()) {
                textNodes.push(node);
            }
        }

        textNodes.forEach(textNode => {
            const text = textNode.nodeValue;
            const matches = [...text.matchAll(pattern)];
            
            if (matches.length > 0) {
                const fragment = document.createDocumentFragment();
                let lastIndex = 0;
                
                matches.forEach(match => {
                    // Add text before match
                    if (match.index > lastIndex) {
                        fragment.appendChild(
                            document.createTextNode(text.substring(lastIndex, match.index))
                        );
                    }
                    
                    // Add highlighted match
                    const span = document.createElement('span');
                    span.className = 'search-highlight';
                    span.textContent = match[0];
                    fragment.appendChild(span);
                    
                    lastIndex = match.index + match[0].length;
                });
                
                // Add remaining text
                if (lastIndex < text.length) {
                    fragment.appendChild(
                        document.createTextNode(text.substring(lastIndex))
                    );
                }
                
                textNode.parentNode.replaceChild(fragment, textNode);
            }
        });
    }

    // Clear all highlights
    function clearHighlights() {
        document.querySelectorAll('.search-highlight').forEach(highlight => {
            const parent = highlight.parentNode;
            parent.replaceChild(document.createTextNode(highlight.textContent), highlight);
            parent.normalize();
        });
    }

    // Navigate between matches
    function navigateMatch(direction) {
        if (searchState.matches.length === 0) return;
        
        searchState.currentMatchIndex += direction;
        
        if (searchState.currentMatchIndex < 0) {
            searchState.currentMatchIndex = searchState.matches.length - 1;
        } else if (searchState.currentMatchIndex >= searchState.matches.length) {
            searchState.currentMatchIndex = 0;
        }
        
        navigateToMatch(searchState.currentMatchIndex);
    }

    // Navigate to specific match
    function navigateToMatch(index) {
        if (index < 0 || index >= searchState.matches.length) return;
        
        // Update current highlight
        document.querySelectorAll('.search-highlight.current').forEach(el => {
            el.classList.remove('current');
        });
        
        const match = searchState.matches[index];
        const highlights = match.element.querySelectorAll('.search-highlight');
        if (highlights.length > 0) {
            highlights[0].classList.add('current');
            highlights[0].scrollIntoView({ behavior: 'smooth', block: 'center' });
        } else {
            match.element.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        updateSearchUI();
    }

    // Display search results for index page
    function displayIndexSearchResults() {
        if (!searchResultsPanel || !searchResultsContent) return;
        
        searchResultsPanel.classList.add('visible');
        
        if (searchState.matches.length === 0) {
            searchResultsContent.innerHTML = '<div class="search-no-results">No results found</div>';
            return;
        }
        
        // Group results by project and type
        const groupedResults = {};
        searchState.matches.forEach(match => {
            const key = match.projectName || match.name || 'Unknown';
            if (!groupedResults[key]) {
                groupedResults[key] = { projects: [], sessions: [] };
            }
            
            if (match.type === 'project') {
                groupedResults[key].projects.push(match);
            } else if (match.type === 'session') {
                groupedResults[key].sessions.push(match);
            }
        });
        
        let html = '';
        Object.entries(groupedResults).forEach(([projectName, groups]) => {
            const totalMatches = [...groups.projects, ...groups.sessions];
            const totalMatchCount = totalMatches.reduce((sum, match) => sum + match.matchCount, 0);
            
            html += `
                <div class="search-result-group">
                    <div class="search-result-group-title">
                        ${projectName}
                        <span class="search-result-count">${totalMatchCount} matches in ${totalMatches.length} items</span>
                    </div>
            `;
            
            // Show project matches first
            groups.projects.forEach(match => {
                html += `
                    <div class="search-result-item">
                        <a href="${match.link}">
                            <div class="search-result-session">üìÅ Project Overview</div>
                            <div class="search-result-excerpt">
                                ${highlightText(match.excerpt, searchState.query)}
                            </div>
                            <div class="search-result-meta">
                                <span>${match.matchCount} matches</span>
                                <span>${match.stats}</span>
                            </div>
                        </a>
                    </div>
                `;
            });
            
            // Show session matches
            groups.sessions.forEach(match => {
                const sessionId = match.link.split('/').pop().replace('session-', '').replace('.html', '').substring(0, 8);
                html += `
                    <div class="search-result-item">
                        <a href="${match.link}">
                            <div class="search-result-session">üí¨ Session ${sessionId}</div>
                            <div class="search-result-excerpt">
                                ${highlightText(match.excerpt, searchState.query)}
                            </div>
                            <div class="search-result-meta">
                                <span>${match.matchCount} matches</span>
                                <span>${match.sessionMeta}</span>
                            </div>
                        </a>
                    </div>
                `;
            });
            
            html += '</div>';
        });
        
        searchResultsContent.innerHTML = html;
    }

    // Highlight text in search results (always case-insensitive)
    function highlightText(text, query) {
        if (!query) return text;

        const pattern = searchState.useRegex ?
            new RegExp(query, 'gi') :
            new RegExp(query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');

        return text.replace(pattern, match => `<span class="search-highlight">${match}</span>`);
    }

    // Update search UI
    function updateSearchUI() {
        const hasMatches = searchState.matches.length > 0;
        
        searchResultsInfo.classList.toggle('visible', hasMatches);
        searchPrev.disabled = !hasMatches;
        searchNext.disabled = !hasMatches;
        
        if (hasMatches) {
            if (searchState.isIndexPage) {
                const totalMatches = searchState.totalMatchCount || searchState.matches.length;
                const conversationCount = searchState.matches.length;
                if (totalMatches > conversationCount) {
                    searchResultCount.textContent = `${totalMatches} matches in ${conversationCount} conversations`;
                } else {
                    searchResultCount.textContent = `${conversationCount} matches`;
                }
            } else {
                searchResultCount.textContent = `${searchState.currentMatchIndex + 1} of ${searchState.matches.length} matches`;
            }
        } else if (searchState.query) {
            searchResultCount.textContent = 'No matches';
        } else {
            searchResultCount.textContent = 'No results';
        }
    }

    // Clear search
    function clearSearch() {
        searchInput.value = '';
        searchState.query = '';
        searchState.matches = [];
        searchState.currentMatchIndex = 0;
        updateSearchInputState();
        clearHighlights();
        updateSearchUI();

        if (searchState.isIndexPage && searchResultsPanel) {
            searchResultsPanel.classList.remove('visible');
        }

        saveSearchState();
    }


    // Handle keyboard shortcuts
    function handleKeyboardShortcuts(e) {
        // Ctrl+F or Cmd+F
        if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
            e.preventDefault();

            // On transcript pages, open filter toolbar if not visible
            const filterToolbar = document.querySelector('.filter-toolbar');
            if (filterToolbar && !filterToolbar.classList.contains('visible')) {
                // Trigger filter button click to show toolbar
                const filterButton = document.getElementById('filterMessages');
                if (filterButton) filterButton.click();
            }

            // Focus and select search input
            if (searchInput) {
                searchInput.focus();
                searchInput.select();
            }
        }

        // F3 - Next match
        if (e.key === 'F3') {
            e.preventDefault();
            if (e.shiftKey) {
                navigateMatch(-1);
            } else {
                navigateMatch(1);
            }
        }

        // Escape - Close search results panel on index page
        if (e.key === 'Escape') {
            if (searchState.isIndexPage && searchResultsPanel && searchResultsPanel.classList.contains('visible')) {
                searchResultsPanel.classList.remove('visible');
            }
        }
        
        // Enter - Next match when search input is focused
        if (e.key === 'Enter' && document.activeElement === searchInput) {
            e.preventDefault();
            if (e.shiftKey) {
                navigateMatch(-1);
            } else {
                navigateMatch(1);
            }
        }
    }

    // Save search state to localStorage
    function saveSearchState() {
        const state = {
            query: searchState.query,
            useRegex: searchState.useRegex,
            searchInFiltered: searchState.searchInFiltered
        };
        localStorage.setItem('claudeLogSearchState', JSON.stringify(state));
    }

    // Restore search state from localStorage
    function restoreSearchState() {
        const saved = localStorage.getItem('claudeLogSearchState');
        if (saved) {
            try {
                const state = JSON.parse(saved);
                searchState.useRegex = state.useRegex || false;
                searchState.searchInFiltered = state.searchInFiltered !== false;

                // Update UI
                searchRegex.checked = searchState.useRegex;
                searchInFiltered.checked = searchState.searchInFiltered;
            } catch (e) {
                console.error('Failed to restore search state:', e);
            }
        }
    }

    // Re-index when filters change (for transcript pages)
    if (!searchState.isIndexPage) {
        // Listen for filter changes
        let isUpdatingFilters = false;
        const observer = new MutationObserver((mutations) => {
            // Only react to filtered-hidden class changes, not search highlights
            const hasFilterChange = mutations.some(mutation => {
                if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                    const target = mutation.target;
                    // Check if this is a message element getting filtered
                    return target.classList && target.classList.contains('message');
                }
                return false;
            });

            if (hasFilterChange && !isUpdatingFilters && searchState.query && searchState.searchInFiltered) {
                isUpdatingFilters = true;
                setTimeout(() => {
                    buildSearchIndex();
                    performSearch(searchState.query);
                    isUpdatingFilters = false;
                }, 100);
            }
        });

        // Observe changes to filtered-hidden class
        observer.observe(document.body, {
            attributes: true,
            attributeFilter: ['class'],
            subtree: true
        });
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initSearch);
    } else {
        initSearch();
    }
})();
</script>
</body>

</html>